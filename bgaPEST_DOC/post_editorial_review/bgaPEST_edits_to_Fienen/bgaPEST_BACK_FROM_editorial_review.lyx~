#LyX 2.0 created this file. For more info see http://www.lyx.org/
\lyxformat 413
\begin_document
\begin_header
\textclass article
\begin_preamble
\setcitestyle{semicolon}
\renewcommand{\[}{\begin{equation}}
\renewcommand{\]}{\end{equation}}



\usepackage{babel}
\end_preamble
\use_default_options false
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding latin9
\fontencoding T1
\font_roman default
\font_sans default
\font_typewriter default
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100

\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 12
\spacing onehalf
\use_hyperref false
\papersize default
\use_geometry true
\use_amsmath 1
\use_esint 1
\use_mhchem 0
\use_mathdots 0
\cite_engine natbib_authoryear
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\use_refstyle 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 3cm
\topmargin 3cm
\rightmargin 3cm
\bottommargin 3cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation skip
\defskip medskip
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes true
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\author -1837876828 "cmeberle" 
\author -74556787 "Michael Fienen" 
\end_header

\begin_body

\begin_layout Title

\emph on
Approaches in Highly Parameterized Inversion
\change_deleted -1837876828 1342547637
--
\change_inserted -1837876828 1342547637
:
\change_unchanged
bgaPEST
\change_deleted -1837876828 1342547642
:
\change_inserted -1837876828 1342547642
,
\change_unchanged
 
\change_deleted -1837876828 1342547645
A
\change_inserted -1837876828 1342547645
a
\change_unchanged
 Bayesian Geostatistical Approach Implementation 
\change_deleted -1837876828 1342547652
w
\change_inserted -1837876828 1342547652
W
\change_unchanged
ith PEST--Documentation and Instructions
\end_layout

\begin_layout Author
Michael N.
 Fienen
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
U
\change_inserted -1837876828 1342030150
.
\change_unchanged
S
\change_inserted -1837876828 1342030153
.

\change_unchanged
 Geological Survey, Wisconsin Water Science Center, Middleton, Wisconsin
\change_inserted -1837876828 1342030158
,
\change_unchanged
 USA
\end_layout

\end_inset

, Marco D'Oria
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Department of Civil and Environmental Engineering and Architecture, University
 of Parma, Parma, Italy
\end_layout

\end_inset

, John E.
 Doherty
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Watermark Numerical Computing, Brisbane, Australia
\end_layout

\end_inset

, and Randall J.
 Hunt
\begin_inset script superscript

\begin_layout Plain Layout
*
\end_layout

\end_inset


\change_inserted -1837876828 1342029982

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342029987
Note 1
\change_unchanged

\end_layout

\end_inset


\change_unchanged

\end_layout

\begin_layout Section
Abstract
\end_layout

\begin_layout Standard

\change_deleted -74556787 1342714480
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
raggedcolumns
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
raggedright
\end_layout

\end_inset


\change_unchanged

\end_layout

\begin_layout Standard

\change_inserted -1837876828 1342030701
The application 
\change_unchanged
bgaPEST is a highly parameterized inversion software package implementing
 the Bayesian Geostatistical Approach in a framework compatible with 
\change_inserted -1837876828 1342030856
the parameter-estimation software suite 
\change_unchanged
PEST.
 Highly parameterized inversion refers to cases in which parameters are
 distributed in space or time and are correlated with one another.
 The Bayesian aspect of bgaPEST 
\change_deleted -1837876828 1342030964
is manifest in a basis on
\change_inserted -1837876828 1342030965
relates to
\change_unchanged
 Bayesian probability theory
\change_inserted -1837876828 1342030969
,
\change_unchanged
 in which prior information about parameters is formally revised 
\change_deleted -1837876828 1342030975
based
\change_unchanged
 on the 
\change_inserted -1837876828 1342030981
basis of the 
\change_unchanged
calibration dataset used for the inversion.
 Conceptually, this 
\change_inserted -1837876828 1342031052
approach 
\change_unchanged
formalizes the conditionality of estimated parameters on the specific data
 and model available.
 The 
\change_deleted -1837876828 1342031040
G
\change_inserted -1837876828 1342031040
g
\change_unchanged
eostatistical component of the method refers to the way in which prior informati
on about the parameters is used.
 A geostatistical autocorrelation function is used to enforce structure
 on the parameters to avoid overfitting and unrealistic results.
 
\change_inserted -1837876828 1342031115
The 
\change_unchanged
B
\change_inserted -1837876828 1342031121
ayseian 
\change_unchanged
G
\change_inserted -1837876828 1342031127
eostatistical 
\change_unchanged
A
\change_inserted -1837876828 1342031130
pproach
\change_unchanged
 
\change_inserted -1837876828 1342031142

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342031145
Note 2
\change_unchanged

\end_layout

\end_inset


\change_unchanged
is designed to provide the smoothest solution that is consistent with the
 data.
 Optionally, users can specify a level of fit or estimate a balance between
 fit and model complexity informed by the data.
 
\change_deleted -1837876828 1342031337
Examples are provided in
\change_unchanged
 
\change_deleted -1837876828 1342031330
g
\change_inserted -1837876828 1342031330
G
\change_unchanged
roundwater and surface
\change_inserted -1837876828 1342031333
-
\change_deleted -1837876828 1342031333
 
\change_unchanged
water applications 
\change_inserted -1837876828 1342031351
are used as examples in this text, 
\change_unchanged
but the possible uses 
\change_inserted -1837876828 1342031359
of bgaPEST 
\change_deleted -1837876828 1342547675
expand
\change_inserted -1837876828 1342547676
extend
\change_unchanged
 to any distributed parameter application
\change_deleted -1837876828 1342031386
s
\change_unchanged
.
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
This report documents the theory and computer code of a Bayesian Geostatistical
 Approach (BGA
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
[
\end_layout

\end_inset

3]
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\change_deleted -1837876828 1342031426
While
\change_inserted -1837876828 1342031601
Whereas
\change_unchanged
 the Bayesian Geostatistical Approach is reference
\change_deleted -1837876828 1342031431
s
\change_inserted -1837876828 1342031431
d
\change_unchanged
 with the all capital 
\change_deleted -1837876828 1342031436
acronym
\change_inserted -1837876828 1342031438
abbreviation
\change_unchanged
 
\begin_inset Quotes eld
\end_inset

BGA,
\begin_inset Quotes erd
\end_inset

 
\change_deleted -1837876828 1342031461
in the software title,
\change_unchanged
 lo
\change_deleted -1837876828 1342031467
v
\change_inserted -1837876828 1342031467
w
\change_unchanged
er
\change_deleted -1837876828 1342547682
 
\change_unchanged
case is used 
\change_inserted -1837876828 1342031475
in the software name 
\change_unchanged
(
\begin_inset Quotes eld
\end_inset

bgaPEST
\begin_inset Quotes erd
\end_inset

) to 
\change_inserted -1837876828 1342031521
visually 
\change_unchanged
differentiate 
\change_deleted -1837876828 1342031658
the two titles rather than running them all together
\change_inserted -1837876828 1342031537

\begin_inset Quotes eld
\end_inset

BGA
\begin_inset Quotes erd
\end_inset

 and 
\begin_inset Quotes eld
\end_inset

PEST
\change_unchanged
.
\change_inserted -1837876828 1342031540

\begin_inset Quotes erd
\end_inset


\change_unchanged

\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

).
 
\begin_inset Quotes eld
\end_inset

Bayesian
\begin_inset Quotes erd
\end_inset

 refers to 
\change_inserted -1837876828 1342031547
the 
\change_unchanged
theory used to solve the inverse problem; 
\begin_inset Quotes eld
\end_inset

Geostatistical
\begin_inset Quotes erd
\end_inset

 refers to the use of an autocorrelated spatial or temporal function to
 provide prior information about the parameters.
 This BGA approach has been coded 
\change_inserted -1837876828 1342031567
by 
\change_unchanged
using the protocol and approach of PEST 
\begin_inset CommandInset citation
LatexCommand citep
key "PEST,PESTAdd"

\end_inset

, the most widely used computer code of its type.
 Though 
\change_deleted -1837876828 1342462854
the
\change_unchanged
 BGA and PEST have been 
\change_deleted -1837876828 1342031614
primarily
\change_unchanged
 applied 
\change_inserted -1837876828 1342031618
primarily 
\change_unchanged
to the environmental modeling field, 
\change_deleted -1837876828 1342031702
a
\change_inserted -1837876828 1342031703
the
\change_unchanged
 general view of the inverse problem 
\change_deleted -1837876828 1342031708
is
\change_unchanged
 discussed here
\change_deleted -1837876828 1342031721
, one that
\change_inserted -1837876828 1342031716
in
\change_unchanged
 covers most classes of problems where measurements of a system are used
 to infer system properties that create the measured value.
 Thus, this bgaPEST formulation is meant to be applicable to any class of
 inverse problem that adheres to the concepts described herein.
 In this 
\change_inserted -1837876828 1342031774
indtroductory 
\change_unchanged
section, we outline the conceptual framework of the method; theory, implementati
on, and instructions for use of the bgaPEST computer code version 1.0 follow
 this conceptual discussion.
\end_layout

\begin_layout Standard
Environmental modeling can facilitate informed management of natural resources.
 In most cases, models represent physical processes such as groundwater
 flow, contaminant transport, surface
\change_inserted -1837876828 1342031976
-
\change_deleted -1837876828 1342031976
 
\change_unchanged
water flood routing, 
\change_deleted -1837876828 1342032011
etc
\change_inserted -1837876828 1342032013
and so forth
\change_unchanged
.
 Simulating the overarching physics and chemistry with governing equations
 and concepts such as conservation of mass and momentum is only part of
 what is required.
 Once a model adequately represents the processes of the problem, it is
 still only an abstract tool until estimates of the physical characteristics
 are tuned to observations from the specific area to be managed.
\end_layout

\begin_layout Standard
Input values that are used by processes 
\change_inserted -1837876828 1342032085
are what 
\change_unchanged
control the behavior of a model at a given site; 
\change_inserted -1837876828 1342032099
we refer to 
\change_unchanged
these input values 
\change_deleted -1837876828 1342032104
are here called
\change_inserted -1837876828 1342032104
as
\change_unchanged
 
\begin_inset Quotes eld
\end_inset

parameters
\change_inserted -1837876828 1342032108
.
\change_unchanged

\begin_inset Quotes erd
\end_inset


\change_deleted -1837876828 1342032109
.

\change_unchanged
 They represent specific characteristics (for example, hydraulic conductivity,
 recharge rate, chemical decay rate) of the natural system 
\change_deleted -1837876828 1342032135
encountered
\change_unchanged
 at an area of interest.
 Representative values appropriate for parameters in natural systems are
 often difficult to measure directly, however.
 Observations of system state (for example, water levels, streamflow magnitudes,
 chemical concentrations) are often easier to measure, and the model is
 chosen so that the observations of the system correspond to output values
 from the model.
 The outputs of observation data are dependent to varying degrees on the
 values of parameters.
 Therefore, changes in the simulated system state that align with observations
 allow inference of parameter values not available by direct measurement.
 
\begin_inset Quotes eld
\end_inset

Parameter estimation
\begin_inset Quotes erd
\end_inset

 and 
\begin_inset Quotes eld
\end_inset

calibration
\begin_inset Quotes erd
\end_inset

 are both terms describing the process of incorporating site-specific observatio
ns to inform parameters and salient processes of a model in order to improve
 
\change_deleted -1837876828 1342032224
its
\change_inserted -1837876828 1342032225
the
\change_unchanged
 representativeness and predictive ability
\change_inserted -1837876828 1342032230
 of the model
\change_unchanged
.
\end_layout

\begin_layout Standard
A model, therefore, can 
\change_deleted -1837876828 1342547716
often
\change_unchanged
 be thought of as a data-processing tool that quantitatively tests conceptualiza
tions of a system as 
\change_deleted -1837876828 1342547726
much
\change_inserted -1837876828 1342547727
well
\change_unchanged
 as a simulator of physical processes
\change_deleted -1837876828 1342032327
,
\change_inserted -1837876828 1342032327
;
\change_unchanged
 
\change_deleted -1837876828 1342032341
the
\change_inserted -1837876828 1342032344
metaphorically,
\change_unchanged
 data processing 
\change_deleted -1837876828 1342032347
being
\change_inserted -1837876828 1342032347
is
\change_unchanged
 a pipeline from field observation to model parameters and ultimately to
 more representative predictions for supporting management decisions.
\end_layout

\begin_layout Standard
Put in terms of a Bayesian description, this process is one in which the
 model is a vehicle for updating soft
\change_deleted -1837876828 1342032380
-
\change_inserted -1837876828 1342032384
 knowledge
\change_unchanged
 or expert
\change_deleted -1837876828 1342032387
-
\change_inserted -1837876828 1342032387
 
\change_unchanged
knowledge 
\change_inserted -1837876828 1342032411
of the system 
\change_unchanged
(called 
\emph on
a priori
\emph default
 understanding in the Bayesian context)
\change_deleted -1837876828 1342547737
 of the system
\change_unchanged
.
 This initial vehicle is filtered by a measure of its ability to simulate
 the natural world 
\change_inserted -1837876828 1342547756
as 
\change_unchanged
informed, or updated, by site-specific observations (called 
\emph on
a posteriori
\emph default
 
\change_inserted -1837876828 1342547763

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342547792
USGS style is to not use italic for Latin phrases.
\change_unchanged

\end_layout

\end_inset


\change_unchanged
understanding).
 In the Bayesian approach, the ability to simulate features of the natural
 world 
\begin_inset Quotes eld
\end_inset

conditions
\begin_inset Quotes erd
\end_inset

 or narrows the wide range of possible outcomes that result from general
 expert 
\change_inserted -1837876828 1342547812
knowledge 
\change_unchanged
and soft
\change_deleted -1837876828 1342032513
-
\change_inserted -1837876828 1342032513
 
\change_unchanged
knowledge alone.
 A key benefit of the Bayesian approach is that it provides a theoretically
 rigorous way to continually incorporate new information and, in turn, update
 
\emph on
a posteriori
\emph default
 
\change_inserted -1837876828 1342547798

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342547801
No ital.
\change_unchanged

\end_layout

\end_inset


\change_unchanged
understanding.
\end_layout

\begin_layout Section
Obtaining the Software
\end_layout

\begin_layout Standard
The software for bgaPEST Version 1.0 is available for download at 
\begin_inset Formula $<$
\end_inset

USGS LINK HERE
\begin_inset Formula $>$
\end_inset

.
 This location includes a copy of this document and both executables and
 source code.
 As development of the code continues, a repository at 
\begin_inset Formula $<$
\end_inset

GITHUB LINK HERE
\begin_inset Formula $>$
\end_inset

 provides a link to 
\change_deleted -1837876828 1342112130
the bleeding edge development branches
\change_inserted -1837876828 1342112146
revisions in progress
\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342112151
Note 3
\change_unchanged

\end_layout

\end_inset


\change_unchanged
 and provides a collaborative open-source space where users may submit revisions
 for consideration by the authors.
 As further development takes place, new code releases will be posted at
 
\begin_inset Formula $<$
\end_inset

USGS LINK
\begin_inset Formula $>$
\end_inset

.
\end_layout

\begin_layout Section
Purpose and Scope
\change_inserted -1837876828 1342547892

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342547914
I think this section would go better before 
\begin_inset Quotes eld
\end_inset

Obtaining the Software.
\begin_inset Quotes erd
\end_inset

 
\change_unchanged

\end_layout

\end_inset


\change_unchanged

\end_layout

\begin_layout Standard
This 
\change_deleted -1837876828 1342032705
R
\change_inserted -1837876828 1342032705
r
\change_unchanged
eport is intended to serve two purposes.
 First, a Bayesian approach to parameter estimation--
\change_inserted -1837876828 1342034100

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342112160
Note 4
\change_unchanged

\end_layout

\end_inset


\change_unchanged
expressed in the context of the Bayesian Geostatistical Approach (BGA)--is
 described to provide an accessible and general tool for moving a model
 from a general simulator of a physical process to a more optimal tool,
 
\change_inserted -1837876828 1342547948
one that is 
\change_unchanged
tuned to a set of calibration information
\change_deleted -1837876828 1342034219
,
\change_unchanged
 which, in turn, can be used for improved prediction and decision
\change_deleted -1837876828 1342547983
-
\change_unchanged
making.
 Second, a computer code--bgaPEST version 1.0--is introduced and documented
 in which BGA is deployed 
\change_deleted -1837876828 1342547996
using
\change_inserted -1837876828 1342547998
by means of
\change_unchanged
 the protocols and input/output concepts developed in the free and open-source
 PEST suite of software 
\begin_inset CommandInset citation
LatexCommand citet
key "PEST"

\end_inset

.
 This report 
\change_deleted -1837876828 1342034256
provides
\change_inserted -1837876828 1342034261
gives
\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342112166
Note 5
\change_unchanged

\end_layout

\end_inset


\change_unchanged
 details on the mathematical theory behind BGA, followed by detailed instruction
s for using the computer program.
 Conventions and assumptions for using the program 
\change_deleted -1837876828 1342548007
are
\change_unchanged
 also 
\change_inserted -1837876828 1342548010
are 
\change_unchanged
included in the discussion.
 To our knowledge, this 
\change_inserted -1837876828 1342548021
application 
\change_unchanged
marks the first implementation of a general BGA code available for 
\change_deleted -1837876828 1342034391
general
\change_inserted -1837876828 1342034393
widespread
\change_unchanged
 use.
\end_layout

\begin_layout Standard
The bgaPEST input framework is consistent with the input block and keyword
 concepts described by the JUPITER project 
\begin_inset CommandInset citation
LatexCommand citet
key "BantaEtAl2006"

\end_inset

.
 Although the relation of design concepts is beyond the scope of this report,
 the input block and keywords needed to run bgaPEST are described fully
 in 
\change_deleted -1837876828 1342548035
A
\change_inserted -1837876828 1342548035
a
\change_unchanged
ppendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Input-Instructions"

\end_inset

.
 A full description of the format of the general approach of template and
 instruction files are 
\change_deleted -1837876828 1342548043
also
\change_unchanged
 
\change_deleted -1837876828 1342034441
not included
\change_inserted -1837876828 1342034442
omitted
\change_unchanged
 here
\change_deleted -1837876828 1342034447
:
\change_inserted -1837876828 1342034447
;
\change_unchanged
 
\change_inserted -1837876828 1342034450
however, 
\change_unchanged
detailed descriptions are provided in the PEST documentation 
\begin_inset CommandInset citation
LatexCommand citep
after "chapter 3"
key "PEST"

\end_inset

.
 All options implemented in template and instruction files in PEST are available
 in bgaPEST.
 A distributed parameterization scheme 
\change_deleted -1837876828 1342034472
is
\change_unchanged
 discussed in this report 
\change_deleted -1837876828 1342034478
that is 
\change_unchanged
facilitates the introduction of flexibility to the model.
 This parameterization scheme
\change_deleted -1837876828 1342034490
s
\change_unchanged
 
\change_deleted -1837876828 1342034545
described here
\change_inserted -1837876828 1342034545
also
\change_unchanged
 can be applied to any region of interest and with sufficient data in the
 model, and at the extreme can allow a modeler to estimate a unique parameter
 values for each model node or cell
\change_inserted -1837876828 1342034609

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342112169
Note 6
\change_unchanged

\end_layout

\end_inset


\change_unchanged
.
 This 
\change_inserted -1837876828 1342034663
level of detail 
\change_unchanged
leads to a large number of parameters
\change_inserted -1837876828 1342034679
,
\change_unchanged
 
\change_deleted -1837876828 1342034685
which
\change_inserted -1837876828 1342034688
a condition that
\change_unchanged
 
\change_deleted -1837876828 1342034694
is accompanied by
\change_inserted -1837876828 1342034695
poses
\change_unchanged
 computational challenges; alleviating these computational challenges is
 an active area of ongoing research and thus 
\change_deleted -1837876828 1342034705
are
\change_inserted -1837876828 1342034705
is
\change_unchanged
 not covered in detail here.
\end_layout

\begin_layout Standard
This report includes an overview of theory and use of the bgaPEST code in
 the main text.
 Detailed input instructions for bgaPEST version 1.0 are 
\change_deleted -1837876828 1342548089
included
\change_unchanged
 in 
\change_deleted -1837876828 1342548094
A
\change_inserted -1837876828 1342548094
a
\change_unchanged
ppendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Input-Instructions"

\end_inset

, 
\change_inserted -1837876828 1342034734
and 
\change_unchanged
quick-start instructions are in 
\change_deleted -1837876828 1342548097
A
\change_inserted -1837876828 1342548097
a
\change_unchanged
ppendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:quickstart"

\end_inset

.
 A detailed mathematical derivation of the BGA methods is 
\change_deleted -1837876828 1342548123
included
\change_unchanged
 in 
\change_deleted -1837876828 1342548100
A
\change_inserted -1837876828 1342548100
a
\change_unchanged
ppendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:methodologyDetails"

\end_inset

, and example problems are 
\change_deleted -1837876828 1342548111
included
\change_unchanged
 in 
\change_deleted -1837876828 1342548103
A
\change_inserted -1837876828 1342548103
a
\change_unchanged
ppendixes 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:example1"

\end_inset

 through 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:example3"

\end_inset

.
\end_layout

\begin_layout Section
Acknowledg
\change_deleted -1837876828 1342034772
e
\change_unchanged
ments
\change_inserted -1837876828 1342111153

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342112172
Note 7 
\change_unchanged

\end_layout

\end_inset


\change_unchanged
 
\end_layout

\begin_layout Standard
This work was supported by 
\change_deleted -1837876828 1342110998
several important sources including:
\change_inserted -1837876828 1342111005
a variety of projects and programs.

\change_unchanged
 
\change_deleted -1837876828 1342111012
T
\change_inserted -1837876828 1342111021
General support was provided by t
\change_unchanged
he National Research Council Postdoctoral Research Associateship, 
\change_deleted -1837876828 1342548132
T
\change_inserted -1837876828 1342548132
t
\change_unchanged
he U
\change_inserted -1837876828 1342111025
.
\change_unchanged
S
\change_inserted -1837876828 1342111026
.

\change_unchanged
 Geological Survey 
\change_inserted -1837876828 1342111031
(USGS) 
\change_unchanged
Groundwater Resources Program, 
\change_inserted -1837876828 1342111038
and 
\change_unchanged
the USGS Water Energy and Biogeochemical Budgets (WEBB) Program.
 
\change_deleted -1837876828 1342111049
T
\change_inserted -1837876828 1342111053
In addition, t
\change_unchanged
he USGS Exchange Visitor Program and the USGS Wisconsin Water Science Center
 supported a 
\change_deleted -1837876828 1342111062
six
\change_inserted -1837876828 1342111062
6
\change_unchanged
-month exchange in which Dr.
 Marco D'Oria was hosted in Wisconsin.
 Dr.
 D'Oria also received support from the University of Parma, Italy, Department
 of Civil and Environmental Engineering and Architecture (Universit√† degli
 Studi di Parma).
 
\change_inserted -1837876828 1342110924

\end_layout

\begin_layout Standard

\change_deleted -1837876828 1342111109
Valuable colleague reviews were provided by
\change_inserted -1837876828 1342111117
The authors thank
\change_unchanged
 Dr.
 Michael Cardiff, Boise State University, and Stephen Westenbroek, USGS
 Wisconsin Water Science Center
\change_deleted -1837876828 1342111123
.
\change_inserted -1837876828 1342111149
, for valuable technical reviews of this document.

\change_unchanged
 
\end_layout

\begin_layout Section
Background for a Bayesian Geostatistical Approach
\end_layout

\begin_layout Standard
The presentation of 
\change_deleted -1837876828 1342462892
the
\change_unchanged
 BGA is 
\change_inserted -1837876828 1342112482
in two parts, 
\change_unchanged
first 
\change_deleted -1837876828 1342112489
presented using
\change_unchanged
 primarily 
\change_deleted -1837876828 1342112495
description by words,
\change_inserted -1837876828 1342112497
as narrative
\change_unchanged
 then 
\change_deleted -1837876828 1342112501
described
\change_unchanged
 later 
\change_deleted -1837876828 1342112519
using
\change_inserted -1837876828 1342112693
as
\change_unchanged
 a 
\change_inserted -1837876828 1342112527
detailed 
\change_unchanged
mathematical approach, 
\change_deleted -1837876828 1342112536
which is provided in detail
\change_unchanged
 in Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:methodologyDetails"

\end_inset

.
 Those most interested in simply applying bgaPEST to their specific problem
\change_inserted -1837876828 1342112559
s
\change_unchanged
 will likely spend most time with the 
\change_deleted -1837876828 1342548195
former presentation
\change_inserted -1837876828 1342548196
narrative
\change_unchanged
.
 In 
\change_deleted -1837876828 1342112715
either
\change_inserted -1837876828 1342112715
both
\change_unchanged
 presentation
\change_inserted -1837876828 1342112717
s
\change_unchanged
, the concept of conditionality is fundamental.
 This concepts is expressed here as
\change_deleted -1837876828 1342112725
.
\change_inserted -1837876828 1342548161

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342548169
Get rid of paragraph break here.
\change_unchanged

\end_layout

\end_inset


\change_unchanged

\end_layout

\begin_layout Standard
Bayes' theorem,
\change_inserted -1837876828 1342548176
 
\change_unchanged
which forms the foundation of the techniques described in the rest of this
 report: 
\begin_inset Formula 
\begin{equation}
p\left(\mathbf{s}|\mathbf{y}\right)\propto L\left(\mathbf{y}|\mathbf{s}\right)p\left(\mathbf{s}\right)\label{eq:bayes1}
\end{equation}

\end_inset

where
\change_deleted -1837876828 1342112816
:
\change_unchanged
 
\begin_inset Formula $\mathbf{s}$
\end_inset

 is an 
\begin_inset Formula $m\times1$
\end_inset

 vector of 
\begin_inset Formula $m$
\end_inset

 parameter values, 
\begin_inset Formula $\mathbf{y}$
\end_inset

 is 
\begin_inset Formula $n\times1$
\end_inset

 vector of 
\begin_inset Formula $n$
\end_inset

 observations, 
\begin_inset Formula $p\left(\cdot\right)$
\end_inset

 indicates a probability density function (pdf), 
\begin_inset Formula $L\left(\cdot\right)$
\end_inset

 indicates a likelihood function, and 
\begin_inset Formula $|$
\end_inset

 indicates conditionality.
 
\change_deleted -1837876828 1342548204
In
\change_inserted -1837876828 1342548205
Put into
\change_unchanged
 words, Bayes' theorem states that the posterior probability of parameters
 conditional on the observations 
\begin_inset Formula $p\left(\mathbf{s}|\mathbf{y}\right)$
\end_inset

 (often referred to simply as 
\begin_inset Quotes eld
\end_inset

the posterior probability of 
\series bold
s
\series default
 given 
\series bold
y
\series default

\begin_inset Quotes erd
\end_inset

)
\change_deleted -1837876828 1342112939
,
\change_unchanged
 is proportional to the prior probability of the parameters 
\begin_inset Formula $p\left(\mathbf{s}\right)$
\end_inset

 updated with the likelihood function 
\begin_inset Formula $L\left(\mathbf{y}|\mathbf{s}\right)$
\end_inset

 that expresses how well 
\begin_inset Formula $\mathbf{y}$
\end_inset

 is estimated 
\change_inserted -1837876828 1342112949
by 
\change_unchanged
using the model and a candidate parameter set 
\begin_inset Formula $\mathbf{s}$
\end_inset

.
 The pdfs in all cases are assumed to follow or at least be well
\change_deleted -1837876828 1342112956
-
\change_inserted -1837876828 1342112956
 
\change_unchanged
approximated by Gaussian distributions.
 This assumption is important and somewhat restrictive
\change_deleted -1837876828 1342112990
,
\change_unchanged
 but is made for computational simplicity.
 Active research is ongoing on alternatives to this approach, but the traditiona
l Gaussian assumption is adopted in this report and is still considered
 a practical and useful assumption for many cases.
\end_layout

\begin_layout Standard
In the Bayesian context, expressing the parameters and the likelihood function
 as probability distributions formally incorporates an estimate of their
 uncertainty rather than treating the parameters as perfectly known values.
 All 
\emph on
a posteriori 
\change_inserted -1837876828 1342548231

\emph default

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342548235
No ital.
\change_unchanged

\end_layout

\end_inset


\change_unchanged
(also called posterior) distributions are conditional upon the specific
 data used in the calibration process.
 Perhaps less obviously, posterior distributions are also conditional on
 all other modeling and data assumptions and decisions that go into formulating
 the problem: which model and what model options are chosen, numerical considera
tions such as discretization and solver convergence criteria, boundary condition
s that may or may not be considered static and known, variance values and
 weights given to individual observations and parameters, and others.
 As a result, if any of these underlying assumptions and decisions change,
 it is expected
\change_deleted -1837876828 1342548249
,
\change_unchanged
 in the Bayesian context
\change_deleted -1837876828 1342548251
,
\change_unchanged
 that the parameters estimated and the associated posterior uncertainty
 
\change_inserted -1837876828 1342113091
also 
\change_unchanged
will 
\change_deleted -1837876828 1342113077
also
\change_unchanged
 change.
\end_layout

\begin_layout Standard
The conditionality includes 
\emph on
all 
\emph default
decisions made in the process of constructing a model and incorporating
 data
\change_deleted -1837876828 1342113127
,
\change_inserted -1837876828 1342113127
;
\change_unchanged
 however, not all of this information is explicitly addressed by the modeler.
 In fact, the only 
\emph on
explicit 
\emph default
conditionality is on the observation data.
 The information contained in the prior pdf (
\begin_inset Formula $p\left(\mathbf{s}\right)$
\end_inset

) in eq
\change_deleted -1837876828 1342113177
.
\change_inserted -1837876828 1342113183
uation
\change_unchanged
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:bayes1"

\end_inset

 is critical because it represents the state of knowledge about the parameters
 in the system prior to updating through the calibration process.
 In this report, assumptions made prior to calibration are intentionally
 limited and are restricted to the assignment of a mean value (unknown)
 of each distinct parameter type and region within the model domain (beta
 association
\change_deleted -1837876828 1342548268
--
\change_inserted -1837876828 1342548268
, 
\change_unchanged
described below)
\change_deleted -1837876828 1342548280
,
\change_unchanged
 and a characteristic about continuity or smoothness of the parameter field
 (implemented as a variogram
\change_deleted -1837876828 1342548271
--
\change_inserted -1837876828 1342548271
, 
\change_unchanged
also described below).
 The degree to which this continuity characteristic is enforced is dictated
 by the observations included and the subsequent performance of the model.
 This construction is similar 
\change_inserted -1837876828 1342113353
to 
\change_unchanged
(and in some cases, mathematically equivalent
\change_inserted -1837876828 1342113361
 to
\change_unchanged
) 
\change_deleted -1837876828 1342113358
to
\change_unchanged
 Tikhonov regularization 
\begin_inset CommandInset citation
LatexCommand citep
key "Tikhonov1963a,Tikhonov1963b,AsterEtal2005"

\end_inset

.
 Limitation of the information assumed 
\emph on
a priori 
\change_inserted -1837876828 1342548317

\emph default

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342548320
No ital.
\change_unchanged

\end_layout

\end_inset


\change_unchanged
is similar to assuming a low or diffuse level of 
\emph on
a priori 
\change_inserted -1837876828 1342548330

\emph default

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342548332
No ital.
\change_unchanged

\end_layout

\end_inset


\change_unchanged
soft
\change_deleted -1837876828 1342113376
-
\change_inserted -1837876828 1342113376
 
\change_unchanged
knowledge (called an ignorance prior in 
\begin_inset CommandInset citation
LatexCommand citealt
after "chapter 12"
key "jaynesBook"

\end_inset

).
 In this case, the resulting model is driven more by information obtained
 from site-specific observations than from prior assumptions based on soft
\change_deleted -1837876828 1342113461
-
\change_inserted -1837876828 1342113461
 
\change_unchanged
knowledge
\change_inserted -1837876828 1342113502

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342113506
Note 8
\change_unchanged

\end_layout

\end_inset


\change_unchanged
.
 A goal of this approach is to limit the subjective information 
\change_deleted -1837876828 1342548355
used in
\change_inserted -1837876828 1342548356
and to
\change_unchanged
 favor 
\change_deleted -1837876828 1342548360
of
\change_inserted -1837876828 1342548361
instead
\change_unchanged
 an objective and repeatable result based on observation data.
 Additionally, so-called structural parameters that enforce the characteristic
 smoothness are estimated.
 An algorithm that encompasses all of these aspects is considered an Empirical
 Bayes approach.
\end_layout

\begin_layout Standard
The concept of a beta association is
\change_deleted -1837876828 1342113634
 an
\change_unchanged
 important 
\change_deleted -1837876828 1342113639
one
\change_inserted -1837876828 1342113641
and is a concept
\change_unchanged
 that is revisited throughout this report.
 
\begin_inset CommandInset citation
LatexCommand citet
key "fienenIsthmusWRR"

\end_inset

 describe the need to to represent the generalized mean value for a specific
 parameter type (for example, hydraulic conductivity in a groundwater model)
 in a specific region of a model 
\change_inserted -1837876828 1342113707
referred to as (?) 
\change_unchanged
a 
\begin_inset Quotes eld
\end_inset

facies association.
\begin_inset Quotes erd
\end_inset

 To be more general, this concept is incorporated here by the use of the
 term 
\begin_inset Quotes eld
\end_inset

beta
\change_inserted -1837876828 1342113722
,
\change_unchanged

\begin_inset Quotes erd
\end_inset


\change_deleted -1837876828 1342113724
,
\change_unchanged
 derived from the mathematical symbol used.

\change_deleted -1837876828 1342113731
 .

\change_unchanged
 In the methodology described in this report, parameter values are estimated
 by estimating a mean value (termed 
\begin_inset Formula $\beta$
\end_inset

 in the mathematics) and 
\change_inserted -1837876828 1342113746
the 
\change_unchanged
fluctuations about that mean.
 Each parameter, therefore, must be associated with a mean value.
\end_layout

\begin_layout Standard

\change_deleted -74556787 1342714491
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
fcolorbox{black}{ltgrey}{
\end_layout

\begin_layout Plain Layout


\backslash
begin{minipage}[t]{0.9
\backslash
columnwidth}
\end_layout

\begin_layout Plain Layout


\backslash
textbf{A Note on Parameters}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

The term ``parameters'' refers to discrete values of system state.
\end_layout

\begin_layout Plain Layout

When we describe ``parameter type'' we mean a group of parameters
\end_layout

\begin_layout Plain Layout

that belong to the same class of system state (for example, hydraulic
\end_layout

\begin_layout Plain Layout

conductivity or recharge).
 In applications appropriate for bgaPEST,
\end_layout

\begin_layout Plain Layout

there must be multiple parameter values of a given type that are spatially
\end_layout

\begin_layout Plain Layout

or temporally distributed.
 When a ``parameter'' is listed, the meaning
\end_layout

\begin_layout Plain Layout

is restricted to a single value of system model input that is to be
\end_layout

\begin_layout Plain Layout

estimated.
\end_layout

\begin_layout Plain Layout


\backslash
end{minipage}
\end_layout

\begin_layout Plain Layout

}
\end_layout

\end_inset


\change_unchanged
 It would be tempting to use another term such as 
\begin_inset Quotes eld
\end_inset

zone
\begin_inset Quotes erd
\end_inset

 or 
\begin_inset Quotes eld
\end_inset

facies
\begin_inset Quotes erd
\end_inset

 to describe this concept, but the term 
\begin_inset Quotes eld
\end_inset

beta association
\begin_inset Quotes erd
\end_inset

 was selected specifically to highlight the flexibility of the concept.
 The important idea is that the method described in bgaPEST depends on being
 able to associate each parameter with a mean value.
 In the case of distributed parameters (for example, hydraulic conductivity
 or recharge being distributed throughout a region in a model in which each
 model cell or node is assigned a unique value), the subdivision of the
 entire model domain into beta associations accounts for hydrogeologic contacts
 or facies to be delineated.
 This delineation assumes that there is little or no correlation across
 these natural divisions.
 Similarly, parameters of one type are typically not correlated with parameters
 of a different type.
 Beta associations allow the inclusion of multiple parameter types and the
 delineation of important geologic features in distributed parameter sets.
 In the BGA algorithm, parameters in different beta associations are assigned
 zero correlation.
\change_deleted -74556787 1342714474

\end_layout

\begin_layout Standard
The likelihood function in eq
\change_deleted -1837876828 1342114109
.
\change_inserted -1837876828 1342114112
uation
\change_unchanged
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:bayes1"

\end_inset

, 
\begin_inset Formula $L\text{\ensuremath{\left(\mathbf{y}|\mathbf{s}\right)}}$
\end_inset

, expresses the correspondence of model outcomes with field observations
 co
\change_deleted -1837876828 1342548414
l
\change_unchanged
located in space and time.
 This correspondence is expressed as the sum of the squared differences
 between outcomes and observations, weighted by a covariance matrix, which
 expresses the relative certainty of each observation.
 This is equivalent to the weighted measurement objective function in PEST
 
\begin_inset CommandInset citation
LatexCommand citep
key "PEST"

\end_inset

.
 The advantages to the Bayesian approach stem from the conceptual framework,
 the ability to use a a probability density function to represent parameterizati
on rather than single values
\change_deleted -1837876828 1342114172
 
\change_unchanged
, and the empirical nature of the balance between prior information and
 likelihood.
 These elements of Bayes' equation form the fundamental basis for the bgaPEST
 software described here.
\end_layout

\begin_layout Standard
The 
\change_deleted -1837876828 1342548505

\emph on
G
\change_inserted -1837876828 1342548506
g
\change_unchanged
eostatistical 
\emph default
aspects of the method are expressed in the prior pdf 
\begin_inset Formula $\left(p\left(\mathbf{s}\right)\right)$
\end_inset

 of the parameter values.
 Geostatistics is a form a interpolation that uses a spatial function called
 a variogram to fill in information between data points.
 The most common technique of geostatistics is called Kriging
\change_inserted -1837876828 1342114621

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342114632
Note 9
\change_unchanged

\end_layout

\end_inset


\change_unchanged
.
 In this section, we discuss geostatistics in a conceptual way
\change_inserted -1837876828 1342548550
,
\change_unchanged
 using a photographic image as an example.
 The mathematics relevant to BGA are discussed in later sections.
 More details about the history and use of geostatistics in general, including
 software for using the technique
\change_inserted -1837876828 1342114762
,
\change_unchanged
 are found in 
\begin_inset CommandInset citation
LatexCommand citet
key "Isaaks1989,DeutschJourneal1992,Kitanidis1997,sgems"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/Kriging_image.pdf
	scale 60

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:mikephoto"

\end_inset

Photographic images illustrating the geostatistical interpolation process.
 The image on the left is a JPG format image with 
\begin_inset Formula $320\times240$
\end_inset

 pixels.
 The image on the right is also a JPG image, but it was created by first
 sampling a subset of the pixels in the original image (30 in the vertical
 direction and 20 in the horizontal) and then using the geostatistical technique
 of Kriging to interpolate values for the other pixels.
 The interpolation was 
\change_deleted -1837876828 1342114790
performed
\change_inserted -1837876828 1342114792
done by
\change_unchanged
 using the sGeMS software package 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
protect
\end_layout

\end_inset


\begin_inset CommandInset citation
LatexCommand citep
key "sgems"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The photograph in the left panel of 
\change_deleted -1837876828 1342114841
F
\change_inserted -1837876828 1342114841
f
\change_unchanged
igure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:mikephoto"

\end_inset

 is a JPG
\change_inserted -1837876828 1342548557
 image
\change_unchanged
 taken on a digital camera.
 As a grayscale image, the information of the image can be stored in a matrix
 with the number of rows and columns, 320 rows and 240 columns in this case,
 indicating the number of pixels in the vertical and horizontal dimensions,
 respectively.
 The values at each pixel are a brightness value, in this case normalized
 to a maximum value of 64.0.
 In the original image, there are 
\begin_inset Formula $320\times240=76,800$
\end_inset

 pixels, each of which may be considered a discrete packet of information.
 To illustrate the Kriging process, the photograph was first subsampled
 on an evenly spaced grid of 30 rows and 20 columns with the brightness
 value retained at each location.
 This 
\change_inserted -1837876828 1342548573
subsampling 
\change_unchanged
results in a greatly reduced set of information containing 
\begin_inset Formula $30\times20=600$
\end_inset

 pixels.
 In the photograph in the right panel of 
\change_deleted -1837876828 1342548583
F
\change_inserted -1837876828 1342548583
f
\change_unchanged
igure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:mikephoto"

\end_inset

, the faint impression of the subsampling grid is visible in some areas
 as the subsampled values are depicted at those locations.
 Using the geostatistical technique of Kriging with an appropriate variogram,
 it is possible to 
\begin_inset Quotes eld
\end_inset

fill in
\begin_inset Quotes erd
\end_inset

 the missing data between subsampled data points to present a full image
 of the matrix but with substantially less detail than the original.
\end_layout

\begin_layout Standard
The main role of the variogram in geostatistics and, indeed, in BGA, is
 to act as a constraint, controlling the shape of the interpolated values
 filling in between the known data values.
 In BGA, this connection is not quite as direct as in the photograph interpolati
on example, but it is useful to think of the variogram (as a quantification
 of the prior pdf) as a control on the shape of the estimated parameters.
\end_layout

\begin_layout Standard
Various other interpolation techniques could be used to fill in the missing
 data
\change_inserted -1837876828 1342114925
,
\change_unchanged
 and each would have its own degree of information loss or smoothing relative
 to the original.
 Kriging has a long history of use in earth science applications and, 
\change_deleted -1837876828 1342114957
while
\change_inserted -1837876828 1342114958
although
\change_unchanged
 the interpolated 
\change_inserted -1837876828 1342114964
photographic 
\change_unchanged
image 
\change_inserted -1837876828 1342114973
in the example 
\change_unchanged
is much smoother than the original image, there is more shape and information
 than if, for example, linear interpolation 
\change_deleted -1837876828 1342114988
was
\change_inserted -1837876828 1342114989
had been
\change_unchanged
 used to fill the values between each data point.
\end_layout

\begin_layout Standard
The variogram used in Kriging is an empirical function that characterizes
 the difference between a property as a function of separation distance.
 To determine a variogram appropriate for a problem, the first step is to
 plot a variogram function (a function of difference in property value)
 against separation distance (depicted as red 
\change_deleted -1837876828 1342115006
'
\change_inserted -1837876828 1342115006

\begin_inset Quotes erd
\end_inset


\change_unchanged
x
\change_deleted -1837876828 1342115010
'
\change_inserted -1837876828 1342115010

\begin_inset Quotes erd
\end_inset


\change_unchanged
 marks in 
\change_deleted -1837876828 1342115016
F
\change_inserted -1837876828 1342115016
f
\change_unchanged
ig
\change_deleted -1837876828 1342548591
ure
\change_inserted -1837876828 1342548591
.

\change_unchanged
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:varill"

\end_inset

).
\change_inserted -1837876828 1342117945

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342120067
Note 10
\change_unchanged

\end_layout

\end_inset


\change_unchanged
 Next, a function type is selected from a family of valid variogram model
 types.
 In the photograph example
\change_inserted -1837876828 1342115028
,
\change_unchanged
 an exponential variogram is used.
 Later in this report, more mathematical details about variograms and variogram
 choice are presented.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/exponential_variogram.pdf
	scale 60

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:varill"

\end_inset

Exponential variogram fit to empirical variogram for the image
\change_inserted -1837876828 1342548630
-
\change_deleted -1837876828 1342548630
 
\change_unchanged
processing example.
 The empirical variogram binned values are depicted by red 
\change_deleted -1837876828 1342115043
'
\change_inserted -1837876828 1342115043

\begin_inset Quotes erd
\end_inset


\change_unchanged
x
\change_deleted -1837876828 1342115047
'
\change_inserted -1837876828 1342115047

\begin_inset Quotes erd
\end_inset


\change_unchanged
 marks
\change_inserted -1837876828 1342115057
,
\change_unchanged
 
\change_deleted -1837876828 1342115058
while
\change_inserted -1837876828 1342115065
whereas
\change_unchanged
 the continuous black line shows the analytical variogram fit to the empirical
 values.
 The fit was 
\change_deleted -1837876828 1342115084
performed
\change_inserted -1837876828 1342115085
done
\change_unchanged
 manually 
\change_inserted -1837876828 1342115089
by 
\change_unchanged
using the sGeMS software package (
\begin_inset CommandInset citation
LatexCommand citet
key "sgems"

\end_inset

)
\change_deleted -1837876828 1342698852
.
\change_unchanged

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Returning to the geostatistical aspect of BGA, a variogram model is used
 as the prior information in the Bayesian construction.
 As discussed above, a goal of BGA is to specify little information in the
 prior and to allow the information contained in the calibration data
\change_deleted -1837876828 1342115122
 
\change_unchanged
set to inform the results as much as possible.
 This is accomplished by specifying only the family of variogram model used
 rather than specifying its specific shape.
 Using the example in 
\change_deleted -1837876828 1342115351
F
\change_inserted -1837876828 1342115351
f
\change_unchanged
igure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:varill"

\end_inset

, the family of variogram (in this case exponential) indicates only that
 
\change_inserted -1837876828 1342115382
the 
\change_unchanged
function will assume a curvilinear shape; the specific parameters or the
 variogram function dictate the rate of curvature.
 In terms of using a variogram for the prior distribution in BGA, specifying
 the variogram type 
\change_deleted -1837876828 1342548614
only
\change_unchanged
 informs 
\change_inserted -1837876828 1342548618
only 
\change_unchanged
the most general characteristic of the field (for example, the field must
 be continuous and 
\begin_inset Quotes eld
\end_inset

smooth
\begin_inset Quotes erd
\end_inset

).
 The degree to which this characteristic is enforced is controlled by the
 calibration data
\change_deleted -1837876828 1342115407
 
\change_unchanged
set.
\end_layout

\begin_layout Section

\change_deleted -1837876828 1342548646
Bayesian Geostatistical Approach 
\change_inserted -1837876828 1342548648
Conceptual 
\change_unchanged
Overview
\end_layout

\begin_layout Standard
The Bayesian geostatistical approach is described in detail 
\change_deleted -1837876828 1342117728
in
\change_inserted -1837876828 1342117728
by
\change_unchanged
 
\begin_inset CommandInset citation
LatexCommand citet
key "KitanidisVomvoris1983,HoeksemaKitanidis1984a,Kitanidis1995,NowakCirpka2004"

\end_inset

 among others.
 I
\change_deleted -1837876828 1342117743
n t
\change_inserted -1837876828 1342117743
T
\change_unchanged
his 
\change_deleted -1837876828 1342117733
S
\change_inserted -1837876828 1342117733
s
\change_unchanged
ection
\change_deleted -1837876828 1342117747
, we provide
\change_inserted -1837876828 1342117748
 is
\change_unchanged
 a conceptual overview of the method.
 A more detailed description, including 
\change_deleted -1837876828 1342117763
more
\change_unchanged
 mathematical details, is 
\change_deleted -1837876828 1342117766
included
\change_unchanged
 in 
\change_deleted -1837876828 1342548832
A
\change_inserted -1837876828 1342548832
a
\change_unchanged
ppendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:methodologyDetails"

\end_inset

.
\end_layout

\begin_layout Standard
The core of the Bayesian geostatistical inverse method is Bayes' theorem,
 which states 
\begin_inset Formula 
\begin{equation}
p(\mathbf{s|y})\propto L(\mathbf{y|s})p(\mathbf{s})\label{eq:bayes}
\end{equation}

\end_inset

where 
\series bold

\begin_inset Formula $\mathbf{y}$
\end_inset


\series default
 are the measured data, 
\begin_inset Formula $\mathbf{s}$
\end_inset

 are the unknown parameters, 
\begin_inset Formula $p(\mathbf{s|y})$
\end_inset

 is the posterior probability density function (pdf) of 
\begin_inset Formula $\mathbf{s}$
\end_inset

 given 
\begin_inset Formula $\mathbf{y}$
\end_inset

, 
\begin_inset Formula $L(\mathbf{y|s})$
\end_inset

 is the likelihood function, and 
\begin_inset Formula $p(\mathbf{s})$
\end_inset

 is the prior pdf of 
\begin_inset Formula $\mathbf{s}$
\end_inset

.
 Details of these pdfs are explained below.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/normals.pdf
	scale 55

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:normals"

\end_inset

Graphical illustration of Bayes' theorem
\change_deleted -1837876828 1342698865
.
\change_unchanged

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:normals"

\end_inset

 depicts one-dimensional distributions graphically illustrating 
\change_deleted -1837876828 1342186570
E
\change_inserted -1837876828 1342186570
e
\change_unchanged
quation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:bayes"

\end_inset

.
 In this example, the prior distribution 
\begin_inset Formula $p\left(\mathbf{s}\right)$
\end_inset

 is diffuse, meaning the variance is relatively high and, correspondingly,
 commitment to a particular value is low.
 The likelihood function 
\begin_inset Formula $L\left(\mathbf{y|s}\right)$
\end_inset

, on the other hand, has lower variance, suggesting a process that brings
 a higher level of certainty to the estimation of the parameters 
\begin_inset Formula $\left(\mathbf{s}\right)$
\end_inset

 than is indicated by the prior distribution only.
 The resulting posterior distribution 
\begin_inset Formula $p\left(\mathbf{s|y}\right)$
\end_inset

 is a convolution of the prior and likelihood functions.
 The peak is shifted significantly from the prior toward the likelihood
 and is narrower, representing less uncertainty.
\end_layout

\begin_layout Standard
In bgaPEST, an empirical Bayes
\change_inserted -1837876828 1342186618
 perspective
\change_unchanged
 
\begin_inset CommandInset citation
LatexCommand citep
key "Robbins1956,casella1985"

\end_inset

 
\change_deleted -1837876828 1342186614
perspective
\change_unchanged
 is adopted.
 Empirical Bayes means that the general characteristics of the prior and
 (optionally) epistemic covariances introduced above are provided in the
 model setup, but the values of 
\begin_inset Quotes eld
\end_inset

structural
\begin_inset Quotes erd
\end_inset

 parameters that control the structure of the system--the balance between
 smoothness and misfit--are estimated from the observation data.
 In other words, the level of roughness in the solution is dictated by the
 information content of the observation data rather than specified by the
 user ahead of time.
\end_layout

\begin_layout Standard
The prior distribution is the main mechanism by which soft
\change_deleted -1837876828 1342187788
-
\change_inserted -1837876828 1342187788
 
\change_unchanged
knowledge about the parameter field is imparted on the parameter estimation
 process.
 In the Empirical Bayes perspective, this soft
\change_deleted -1837876828 1342187794
-
\change_inserted -1837876828 1342187794
 
\change_unchanged
knowledge is intentionally limited such that significant flexibility is
 available to the algorithm and a specific practitioner's preconceived notions,
 which are more subjective, are replaced by the objective power of the site-spec
ific observations.
 This idea is 
\change_inserted -1837876828 1342187835
also 
\change_unchanged
inspired
\change_deleted -1837876828 1342187841
, also, 
\change_inserted -1837876828 1342187841
 
\change_unchanged
by 
\change_deleted -1837876828 1342187859
the
\change_inserted -1837876828 1342187865
Chamberlin's
\change_unchanged
 concept of multiple working hypotheses 
\begin_inset CommandInset citation
LatexCommand citep
key "Chamberlin1890"

\end_inset

.
 Chamberlin warned of scientists falling victim to a 
\begin_inset Quotes eld
\end_inset

paternalistic affection
\begin_inset Quotes erd
\end_inset

 for 
\change_deleted -1837876828 1342187899
his or her
\change_inserted -1837876828 1342187900
their
\change_unchanged
 initial explanation of a phenomenon such that they are blind to other explanati
ons that may be more appropriate.
 This is not to discount the value of soft
\change_deleted -1837876828 1342187912
-
\change_inserted -1837876828 1342187912
 
\change_unchanged
knowledge--indeed, the general characteristics imparted through specification
 of the prior information and the interpretation of the results of using
 BGA rely deeply on expertise--but it highlights a goal of leaving as much
 flexibility as possible in the process.
\end_layout

\begin_layout Standard
In bgaPEST, then, the practitioner specifies a type of variogram (nugget,
 linear, or exponential) that is used to control the variability--smoothness
 or roughness--of parameters within a beta association, but the 
\emph on
degree
\emph default
 to which this characteristic is enforced is determined by restricted maximum
 likelihood (RML).
 In RML, the value of structural parameters that control the variogram behavior
 is treated as a probability distribution
\change_inserted -1837876828 1342187974
,
\change_unchanged
 and the most likely values resulting in either the best possible fit (if
 the epistemic error term is estimated) or a user-specific level of fit
 (if the epistemic error term is fixed) are estimated.
 
\begin_inset Quotes eld
\end_inset

Fit,
\begin_inset Quotes erd
\end_inset

 in this context, refers to the correspondence between observation data
 and model outputs co
\change_deleted -1837876828 1342188001
l
\change_unchanged
located in space and time with the measured observations.
 Fit and epistemic error are discussed in more detail in the next section.
 A danger
\change_deleted -1837876828 1342188040
, when
\change_inserted -1837876828 1342188040
 of
\change_unchanged
 providing a model with substantial flexibility
\change_deleted -1837876828 1342188043
,
\change_unchanged
 is an 
\begin_inset Quotes eld
\end_inset

overly complex
\begin_inset Quotes erd
\end_inset

 model that is 
\begin_inset Quotes eld
\end_inset

overfit
\begin_inset Quotes erd
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
before "e.g. "
key "drapersmith66,Hill2006"

\end_inset

.
 To mitigate this issue, the RML approach is consistent with the principle
 of maximum entropy such that the smoothest solution is chosen, 
\change_inserted -1837876828 1342548866
an approach 
\change_unchanged
based on the structural parameters estimated from the data.
 For a discussion of subtle formal differences from minimum relative entropy,
 see 
\begin_inset CommandInset citation
LatexCommand citet
after "p. 333-342"
key "Rubin2003"

\end_inset

.
\end_layout

\begin_layout Standard
An extension 
\change_deleted -1837876828 1342188097
to
\change_inserted -1837876828 1342188097
of
\change_unchanged
 this approach is the inclusion of information about the prior mean 
\begin_inset CommandInset citation
LatexCommand citep
key "NowakCirpka2004"

\end_inset

.
 Although the mean is estimated in the solution, a prior value and covariance
 can be supplied to constrain the estimate.
 Typically, a relatively high covariance magnitude is used so 
\change_inserted -1837876828 1342188117
that 
\change_unchanged
the constraint on the estimated mean is weak or 
\begin_inset Quotes eld
\end_inset

diffuse.
\begin_inset Quotes erd
\end_inset

 Thus
\change_inserted -1837876828 1342188126
,
\change_unchanged
 the prior mean principally serves the role of providing numerical stability
 rather than compelling the solution to adhere closely to prior values.
 Similarly, prior information and covariance can be supplied on the structural
 parameters to constrain the estimated values to more closely follow an
 initial conception of the parameter field variability.
\end_layout

\begin_layout Standard
The forward model is constructed to 
\change_deleted -1837876828 1342188821
provide
\change_inserted -1837876828 1342188823
generate
\change_unchanged
 outputs of values col
\change_deleted -1837876828 1342188815
l
\change_unchanged
ocated in space and time with measured observations.
 The likelihood function quantifies the difference (misfit) between the
 model
\change_inserted -1837876828 1342548875
-
\change_deleted -1837876828 1342548875
 
\change_unchanged
simulated outputs and associated observations.
 In all modeling, perfect correspondence between forecasts and observations
 is neither attainable nor desirable.
 The observations themselves are corrupted by measurement errors
\change_inserted -1837876828 1342188858
,
\change_unchanged
 and 
\change_deleted -1837876828 1342548904
there is usually a lack of
\change_unchanged
 perfect correspondence between the exact nature of the measurements and
 the simulated counterparts
\change_inserted -1837876828 1342548920
 usually is lacking
\change_unchanged
.
 This corruption is due to uncertainty from sources including the paucity
 of observations, imperfections in the conceptual model, and approximations
 made to codify the physics of the phenomena into a numerical model framework.
 All of these sources of uncertainty are described by the overarching term
 
\begin_inset Quotes eld
\end_inset

epistemic uncertainty
\begin_inset Quotes erd
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
after "p. 4"
key "Rubin2003"

\end_inset

.
 This epistemic uncertainty characterizes the expected misfit between simulated
 and observed equivalents
\change_deleted -1837876828 1342188883
,
\change_unchanged
 and is expressed through a covariance function.
 As a result, the likelihood function can be characterized by a Gaussian
 distribution with zero mean and covariance defined by the epistemic uncertainty.
\end_layout

\begin_layout Standard
With both the prior pdf and likelihood function expressed as Gaussian distributi
ons, the resulting posterior pdf 
\change_inserted -1837876828 1342188912
also 
\change_unchanged
is 
\change_deleted -1837876828 1342188909
also
\change_unchanged
 Gaussian.
 The values of the parameters 
\begin_inset Formula $\mathbf{s}$
\end_inset

 that result in the maximum value of the posterior pdf are therefore the
 most likely solution on a point-by-point basis.
 The solution as a whole is always a somewhat smoothed version of reality,
 but the influence of small-scale variability can be approximated through
 conditional realizations.
 The balance between the strength of smoothing and the level of fit between
 simulated and observed equivalents is found through calculation of optimal
 values for the structural parameters.
 Optionally, this can include a value to quantify the epistemic uncertainty.
 The result will favor smoothness, but 
\change_inserted -1837876828 1342188953
it 
\change_unchanged
may achieve a level of fit corresponding to an unrealistically low level
 of epistemic uncertainty.
 
\change_deleted -1837876828 1342188972
As a result
\change_inserted -1837876828 1342188973
Hence
\change_unchanged
, it is generally most appropriate to fix the level of epistemic uncertainty
 but allow the other structural parameters to be estimated.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
fcolorbox{black}{ltgrey}{
\end_layout

\begin_layout Plain Layout


\backslash
begin{minipage}[t]{0.9
\backslash
columnwidth}
\end_layout

\begin_layout Plain Layout


\backslash
textbf{Structural Parameters}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

The term ``structural parameters'' used here has a specific meaning.
\end_layout

\begin_layout Plain Layout

Similar to the more general term ``parameters,'' structural parameters
\end_layout

\begin_layout Plain Layout

are variable values that are estimated in the bgaPEST algorithm.
 Unlike
\end_layout

\begin_layout Plain Layout

typical parameters, however, structural parameters do not 
\backslash
emph{directly
\end_layout

\begin_layout Plain Layout

}control physical aspects of the system in the way that, for example,
\end_layout

\begin_layout Plain Layout

hydraulic conductivity or stream roughness do in hydrologic models.
\end_layout

\begin_layout Plain Layout

Instead, structural parameters control the structure of the general
\end_layout

\begin_layout Plain Layout

parameters.
 For example, the variogram values (
\change_deleted -1837876828 1342457937
e.g.
\change_inserted -1837876828 1342457939
for example,
\change_unchanged
 variance, slope,
\end_layout

\begin_layout Plain Layout

and correlation length) that control to roughness of distributed parameter
\end_layout

\begin_layout Plain Layout

fields are structural parameters, as is the value of variance controlling
\end_layout

\begin_layout Plain Layout

epistemic uncertainty.
 Because these parameters must be estimated
\end_layout

\begin_layout Plain Layout

but are not directly connected to the physics of the problem, they
\end_layout

\begin_layout Plain Layout

are also 
\change_deleted -1837876828 1342457975
in other work 
\change_unchanged
referred to 
\change_inserted -1837876828 1342457981
by other authors 
\change_unchanged
as ``nuisance'' parameters or
\end_layout

\begin_layout Plain Layout

``hyperparameters.'' We adopt the term ``structural'' to highlight
\end_layout

\begin_layout Plain Layout

the fact that the impact these parameters has on the solution is control
\end_layout

\begin_layout Plain Layout

of the shape or structure of the distributed parameter fields.%
\end_layout

\begin_layout Plain Layout


\backslash
end{minipage}
\end_layout

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Correlation-Zones"

\end_inset

Beta Associations
\end_layout

\begin_layout Standard
In an idealized problem, a single covariance model (for example, a single
 variogram) is flexible enough to encompass the entire variability of the
 hydraulic parameters.
 
\change_deleted -1837876828 1342548951
H
\change_inserted -1837876828 1342548957
In many hydrogeologic applications, h
\change_unchanged
owever, 
\change_deleted -1837876828 1342548951
in many hydrogeologic applications, 
\change_unchanged
lithologic contacts and unconformities can create discontinuities in parameter
 values that a single covariance model cannot characterize.
 Partitioning the field 
\change_deleted -1837876828 1342548980
based on
\change_unchanged
 either 
\change_inserted -1837876828 1342189398
on the basis of 
\change_unchanged
the data 
\begin_inset CommandInset citation
LatexCommand citep
before "e.g. "
key "fienenEtal2004"

\end_inset

 or through interrogation of preliminary solutions 
\begin_inset CommandInset citation
LatexCommand citep
before "e.g. "
key "FienenWRR2008"

\end_inset

 can greatly improve the parameter estimation results.
 This partitioning is implemented by imposing discontinuities in the stochastic
 field that censor correlation among all cells that do not occur in the
 same partition.
 In this context, 
\begin_inset Quotes eld
\end_inset

stochastic
\begin_inset Quotes erd
\end_inset

 refers to the entity being partitioned (namely
\change_inserted -1837876828 1342189415
,
\change_unchanged
 the correlation structure of the parameter field)
\change_inserted -1837876828 1342189423
,
\change_unchanged
 but we emphasize here that the locations of the imposed discontinuities
 are themselves considered deterministic and certain.
 This concept of partitioning is consistent with zonal boundaries in models
 made up of homogeneous zones
\change_inserted -1837876828 1342549008
,
\change_unchanged
 but 
\change_inserted -1837876828 1342549011
it 
\change_unchanged
allows more flexibility by allowing properties within the zone to vary.
 Furthermore, multiple types of parameters (for example, 
\change_inserted -1837876828 1342189459
hydraulic conductivity and porosity 
\change_unchanged
in a flow and transport model
\change_deleted -1837876828 1342548951
, hydraulic conductivity and porosity
\change_unchanged
) are commonly estimated.
 
\change_deleted -1837876828 1342548951
While
\change_inserted -1837876828 1342189488
Although
\change_unchanged
 
\change_inserted -1837876828 1342549048
these parameters may be related 
\change_unchanged
at the physical level, 
\change_deleted -1837876828 1342549043
these parameters may be related,
\change_unchanged
 they must correspond to different mean values, so similar censoring of
 correlation among different types of parameters 
\change_inserted -1837876828 1342549075
also 
\change_unchanged
is 
\change_deleted -1837876828 1342549072
also
\change_unchanged
 necessary in most applications through partitioning.
\end_layout

\begin_layout Standard
For hydrogeologic applications, the term 
\begin_inset Quotes eld
\end_inset

facies association,
\begin_inset Quotes erd
\end_inset

 from the facies architecture field, is 
\change_deleted -1837876828 1342189541
a good
\change_inserted -1837876828 1342189542
an apt
\change_unchanged
 description for these partitions 
\begin_inset CommandInset citation
LatexCommand citep
key "fienenIsthmusWRR"

\end_inset

.
 The term 
\begin_inset Quotes eld
\end_inset

facies association
\begin_inset Quotes erd
\end_inset

 typically refers to descriptive properties of a subset of a medium in the
 field or at least for a specific project.
 
\begin_inset Quotes eld
\end_inset

Architectural elements
\begin_inset Quotes erd
\end_inset

 is used in the broader case where the characteristics are more formally
 defined
\change_deleted -1837876828 1342189623
,
\change_unchanged
 (see 
\begin_inset CommandInset citation
LatexCommand citet
key "Collinson1969,Walker1984,Walker1992,SwiftEtAl2003"

\end_inset

).
 It would be appropriate to use the less restrictive and less transferable
 term 
\begin_inset Quotes eld
\end_inset

facies association
\begin_inset Quotes erd
\end_inset

 in hydrogeologic applications because when we subdivide the correlation
 structure of the medium, we often base the stochastic discontinuities (bounding
 surfaces, or contacts) on perceived hydraulic properties.
 These properties will often coincide with differences in age, provenance,
 or depositional environment, but such coincidence is not required for or
 by their use.
 In all cases, partitioning into facies associations 
\change_deleted -1837876828 1342549087
are
\change_inserted -1837876828 1342549088
is
\change_unchanged
 most effective when based on readily observable hydrologic or lithologic
 attributes.
\end_layout

\begin_layout Standard
For bgaPEST to be a more general tool (not limited to hydrogeologic modeling),
 we have broadened this concept by adopting the term 
\begin_inset Quotes eld
\end_inset

beta association.
\begin_inset Quotes erd
\end_inset

 As shown in 
\change_deleted -1837876828 1342189683
E
\change_inserted -1837876828 1342189683
e
\change_unchanged
quation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:bestest"

\end_inset

, the Greek letter 
\begin_inset Formula $\beta$
\end_inset

 stands for the mean of a region of distributed parameters.
 Beta associations can, therefore, delineate regions of a distributed parameter
 field that have similar statistical properties and correspond to the same
 mean value
\change_deleted -1837876828 1342549097
.
\change_inserted -1837876828 1342549097
;
\change_unchanged
 
\change_deleted -1837876828 1342549100
H
\change_inserted -1837876828 1342549100
h
\change_unchanged
owever, importantly, beta associations 
\change_inserted -1837876828 1342549109
also 
\change_unchanged
can 
\change_deleted -1837876828 1342549106
also
\change_unchanged
 refer to completely different parameter types (for example, hydraulic conductiv
ity and recharge).
\end_layout

\begin_layout Standard
To clarify our terminology
\change_deleted -1837876828 1342549118
 in this work
\change_unchanged
, partitions delineated by stochastic discontinuity within a distributed
 parameter field are referred to as 
\begin_inset Quotes eld
\end_inset

beta associations,
\begin_inset Quotes erd
\end_inset

 whereas zones of piecewise continuity are referred to 
\change_inserted -1837876828 1342549127
herein 
\change_unchanged
as 
\begin_inset Quotes eld
\end_inset

homogeneous zones.
\begin_inset Quotes erd
\end_inset

 The beta associations delineate sub
\change_deleted -1837876828 1342189724
-
\change_unchanged
regions of the model domain that share correlation characteristics and are
 uncorrelated from neighboring beta associations; they are usually delineated
 by features that are easily identified in measured data or geologic conceptuali
zations of a given site area.
 In beta associations, variability of parameter values within each cell
 is allowed and constrained by the 
\emph on
a priori
\emph default
 
\change_inserted -1837876828 1342549134

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342549136
No ital.
\change_unchanged

\end_layout

\end_inset


\change_unchanged
covariance structure, whereas in homogeneous zones, a single parameter value
 represents the property for the entire zone.
 Beta associations also delineate regions in the model (whether defined
 by one or more parameter values) that correspond to different mean values
 
\begin_inset Formula $\left(\beta\right)$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
fcolorbox{black}{ltgrey}{
\end_layout

\begin_layout Plain Layout


\backslash
parbox{0.9
\backslash
columnwidth}{
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
textbf{Beta Associations and Zones:
\backslash
emph{ Why aren't ``beta associations''
\end_layout

\begin_layout Plain Layout

just called ``zones''}?}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Beta associations are a term specific to bgaPEST.
 As discussed in
\end_layout

\begin_layout Plain Layout

the main text, this term evolved from the term ``facies association,''
\end_layout

\begin_layout Plain Layout

which describes partitioning of parameter fields 
\change_deleted -1837876828 1342458020
based
\change_unchanged
 on 
\change_inserted -1837876828 1342458024
the basis of 
\change_unchanged
hydrogeologic
\end_layout

\begin_layout Plain Layout

characteristics.
 This term was used in place of ``zones'' because
\end_layout

\begin_layout Plain Layout

of a long history of zones referring to regions of piecewise constant
\end_layout

\begin_layout Plain Layout

homogeneity (one parameter value applied to every node within a region).
\end_layout

\begin_layout Plain Layout

Beta associations are 
\backslash
emph{not} homogeneous, so a distinct term was
\end_layout

\begin_layout Plain Layout

sought that describes the characteristic of regions partitioned 
\change_deleted -1837876828 1342458046
due
\change_inserted -1837876828 1342458048
according
\change_unchanged

\end_layout

\begin_layout Plain Layout

to their characteristics and 
\change_deleted -1837876828 1342458052
how
\change_inserted -1837876828 1342458054
the way
\change_unchanged
 these characteristics correlat
\change_inserted -1837876828 1342458073
e
\change_deleted -1837876828 1342458067
ion
\change_unchanged

\end_layout

\begin_layout Plain Layout

to regions around them.
 To generalize beyond hydrogeologic applications,
\end_layout

\begin_layout Plain Layout

and to account for the fact the distinct parameter types require distinct
\end_layout

\begin_layout Plain Layout

partitions, ``beta associations'' was the term chosen.
 Each of these
\end_layout

\begin_layout Plain Layout

parameter partitions has a distinct mean value $
\backslash
left(
\backslash
beta
\backslash
right)$
\end_layout

\begin_layout Plain Layout

to be estimated within the region, so the partitioning of the problem
\end_layout

\begin_layout Plain Layout

results in different $
\backslash
beta$ values; because the parameter type and/or
\end_layout

\begin_layout Plain Layout

region must be associated with a mean value $
\backslash
left(
\backslash
beta
\backslash
right)$,
\end_layout

\begin_layout Plain Layout

we use the term ``beta associations.''%
\end_layout

\begin_layout Plain Layout

}
\end_layout

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Section

\change_deleted -1837876828 1342549171
bgaPEST 
\change_unchanged
Overview
\change_inserted -1837876828 1342549174
 of bgaPEST
\change_unchanged

\end_layout

\begin_layout Standard
The use of BGA concepts described previously 
\change_deleted -1837876828 1342549323
have
\change_inserted -1837876828 1342549323
has
\change_unchanged
 been restricted to primarily academic and/or custom applications
\change_inserted -1837876828 1342190012
,
\change_unchanged
 
\change_deleted -1837876828 1342190016
due
\change_inserted -1837876828 1342190017
owing
\change_unchanged
 to 
\change_inserted -1837876828 1342190022
the 
\change_deleted -1837876828 1342549357
non-general
\change_inserted -1837876828 1342549363
case-by-case
\change_unchanged
 
\change_inserted -1837876828 1342549368
(?) 
\change_unchanged
nature of the BGA coding.
 The BGA formulation used in bgaPEST is meant to make the approach generally
 available to a wider class of modeling problems.
 This generality is 
\change_deleted -1837876828 1342549377
obtained
\change_inserted -1837876828 1342549378
achieved
\change_unchanged
 by 
\change_inserted -1837876828 1342549386
way of 
\change_unchanged
the following design considerations.
 The input/output design of bgaPEST follows that of the widely used PEST
 software 
\begin_inset CommandInset citation
LatexCommand citep
key "PEST,PESTAdd"

\end_inset

.
 This approach has two primary restrictions.
 First, input provided to the model, and output derived from a model, uses
 an ASCII text file format.
 This restriction can be relaxed, however, provided that a translation utility
 can be deployed 
\change_deleted -1837876828 1342190151
that
\change_inserted -1837876828 1342190152
for
\change_unchanged
 convert
\change_deleted -1837876828 1342190154
s
\change_inserted -1837876828 1342190155
ing
\change_unchanged
 data of another format--for example, binary--to or from ASCII, as appropriate.
 Second, the model must run in 
\begin_inset Quotes eld
\end_inset

batch
\begin_inset Quotes erd
\end_inset

 mode where
\change_inserted -1837876828 1342549397
by
\change_unchanged
 many model runs can be called by PEST without user intervention.
 Therefore, the only kind of model that PEST cannot easily accommodate is
 one in which any changes to model input or the reading of model output
 must take place in a graphical user interface.
 This generality of model compatibility is a powerful capability that bgaPEST
 is able to 
\change_deleted -1837876828 1342549416
take advantage of
\change_inserted -1837876828 1342549417
exploit
\change_unchanged
 by virtue of efficient open-source modules that make this external control
 of a model possible using the same protocols as PEST.
\end_layout

\begin_layout Standard
As discussed below, bgaPEST must control the model for two purposes: to
 evaluate the likelihood function (assessing the correspondence between
 model output and col
\change_deleted -1837876828 1342190216
l
\change_unchanged
ocated observation data, given a candidate set of parameter values) and
 to calculate the 
\begin_inset Quotes eld
\end_inset

Jacobian
\begin_inset Quotes erd
\end_inset

 or 
\begin_inset Quotes eld
\end_inset

sensitivity
\begin_inset Quotes erd
\end_inset

 matrix that is required for solving the calibration equations.
 To enable PEST (and bgaPEST) to write input for a model, template files
 are created that 
\change_deleted -1837876828 1342549465
provide a 
\change_unchanged
map
\change_deleted -1837876828 1342549469
ping of
\change_unchanged
 named parameters into their proper place in input files for the model.
 More than one template file can be used
\change_inserted -1837876828 1342190297
,
\change_unchanged
 corresponding to multiple model input files.
 To enable reading of output files, instruction files are created that contain
 a set of instructions (including locating specific line numbers or searching
 for specific text) that enable extraction of output values to be compared
 with site observation data.
 Leveraging the modules that implement the PEST input/output protocols takes
 advantage of the flexibility and generality of PEST.
 It also makes it possible to take advantage of 
\change_deleted -1837876828 1342549527
some of the
\change_inserted -1837876828 1342549528
certain
\change_unchanged
 utility programs already created to be compatible with the PEST suite of
 software.
 Programs created 
\change_inserted -1837876828 1342190331
by 
\change_unchanged
using the JUPITER program employ a very similar set of protocols by virtue
 of the PEST modules 
\change_deleted -1837876828 1342190366
being
\change_inserted -1837876828 1342190369
having been
\change_unchanged
 provided to the JUPITER project.
 As a result, template and instruction files created to work with a model
 are largely interchangeable among projects implemented in PEST, bgaPEST,
 and programs created 
\change_inserted -1837876828 1342190379
by 
\change_unchanged
using JUPITER.
 A full description of the format of template and instruction files is 
\change_deleted -1837876828 1342549577
not part of
\change_inserted -1837876828 1342549577
within
\change_unchanged
 the scope of this 
\change_deleted -1837876828 1342549580
work
\change_inserted -1837876828 1342549581
report
\change_unchanged
: detailed descriptions are provided in the PEST documentation 
\begin_inset CommandInset citation
LatexCommand citep
after "chapter 3"
key "PEST"

\end_inset

.
 All options implemented in template and instruction files in PEST are available
 in bgaPEST.
\end_layout

\begin_layout Standard
This initial implementation 
\change_inserted -1837876828 1342549603
of bgaPEST 
\change_unchanged
is written in F
\change_deleted -1837876828 1342190484
ORTRAN
\change_inserted -1837876828 1342190501
ortran 
\change_deleted -1837876828 1342190501
-
\change_unchanged
90.
\change_inserted -1837876828 1342190506

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342190510
Note 11
\change_unchanged

\end_layout

\end_inset


\change_unchanged
 The calculation of the Jacobian (sensitivity or derivatives) matrix can
 
\change_deleted -1837876828 1342190977
either
\change_unchanged
 be implemented 
\change_inserted -1837876828 1342190983
either 
\change_unchanged
using a script written by the user
\change_deleted -1837876828 1342190986
,
\change_unchanged
 or employing a Python script provided with bgaPEST.
 The Python script depends on several utilities that are standard with PEST
 and available for download at http://www.pesthomepage.org.
 The necessary executable files are also provided with bgaPEST.
 For users on the Windows operating system, installation of Python is optional
 
\change_deleted -1837876828 1342191014
as
\change_inserted -1837876828 1342191016
because
\change_unchanged
 the Python codes are compiled into executables using py2exe that can be
 called by the main program.
 For users on Macintosh or Linux systems, all the code must be compiled
 for the native platform
\change_inserted -1837876828 1342191033
,
\change_unchanged
 and Python should already be installed so the Python scripts may be called
 directly without need to compile them separately.
 The use of external derivatives (sensitivity) calculation with PEST and
 Python will be replaced by integration of a general parallel run management
 suite (GENIE, 
\begin_inset CommandInset citation
LatexCommand citet
key "GENIE"

\end_inset

) as part of future work.
 Parallelization is possible 
\change_inserted -1837876828 1342191064
by 
\change_unchanged
using beoPEST 
\begin_inset CommandInset citation
LatexCommand citep
key "beoPEST"

\end_inset

, but the entire process
\change_deleted -1837876828 1342191082
, 
\change_inserted -1837876828 1342191082
--
\change_unchanged
including starting and stopping all parallel computer (slave) programs
\change_deleted -1837876828 1342191089
 
\change_inserted -1837876828 1342191089
--
\change_unchanged
must be encapsulated in a script that is called by bgaPEST.
\end_layout

\begin_layout Section
Running bgaPEST
\end_layout

\begin_layout Standard
The bgaPEST program uses a single input control file
\change_deleted -1837876828 1342194077
,
\change_inserted -1837876828 1342194084
 in combination with (?)
\change_unchanged
 template and instruction files to control the underlying model, and 
\change_inserted -1837876828 1342194089
it 
\change_unchanged
generates several output files.
 These files are discussed in the context of progression of the bgaPEST
 program in the remainder of this section.
 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:flowchart"

\end_inset

 shows the general progression of a bgaPEST parameter estimation run.
 The entire process is controlled by variables in the input 
\family typewriter
.bgp
\family default
 file discussed below.
\end_layout

\begin_layout Standard
To obtain an optimal solution 
\change_deleted -1837876828 1342194134
to
\change_inserted -1837876828 1342194135
of
\change_unchanged
 the parameter estimation problem, 
\change_deleted -1837876828 1342194148
it is necessary to perform 
\change_unchanged
multiple iterations
\change_inserted -1837876828 1342194157
 are necessary
\change_unchanged
.
 An iteration is defined as a single run of the entire estimation process
 with a particular set of values.
 Multiple iterations are required 
\change_deleted -1837876828 1342194179
due to
\change_inserted -1837876828 1342194181
because of
\change_unchanged
 the nonlinearity of the problem and 
\change_deleted -1837876828 1342194186
due to 
\change_unchanged
the necessity of estimating structural parameters separately from model
 parameters.
 Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:methodologyDetails"

\end_inset

 
\change_deleted -1837876828 1342549668
provides
\change_inserted -1837876828 1342549670
gives
\change_unchanged
 more detail about the method
\change_deleted -1837876828 1342194206
ology
\change_inserted -1837876828 1342194206
s
\change_unchanged
 used to obtain a solution for a set of optimal parameters and structural
 parameters in bgaPEST.
\end_layout

\begin_layout Standard
Outer iterations (also called bga iterations) are wrapped around the traditional
 parameter estimation process with values of the structural parameters held
 constant.
 Inner parameter estimation iterations are performed to account for the
 (restricted maximum likelihood) estimation of structural parameters.
 If structural parameters are not chosen to be estimated, then a single
 outer iteration is performed 
\change_inserted -1837876828 1342194263
by 
\change_unchanged
using the initial values of structural parameters
\change_inserted -1837876828 1342194269
,
\change_unchanged
 and inner iterations are performed until convergence or until the number
 of iterations reaches 
\family typewriter
it_max_phi
\family default
.
 If a linesearch (discussed below) is requested, this is performed within
 the inner iterations.
 If structural parameter optimization is requested, it is performed after
 convergence has occurred or maximum inner iterations 
\change_deleted -1837876828 1342194299
are
\change_inserted -1837876828 1342194303
have been
\change_unchanged
 reached.
 Then, restricted maximum likelihood is performed to estimate a new set
 of structural parameters.
 The interdependence between structural parameters and model parameters
 requires reiteration of the inner iterations and structural parameter estimatio
n until 
\change_inserted -1837876828 1342549688
either 
\change_unchanged
both have converged or the maximum number of outer iterations has been reached.
 At the end of both inner and outer iteration convergence
\change_deleted -1837876828 1342194336
,
\change_unchanged
 or exceedance of maximum iterations, posterior covariance is calculated,
 if requested.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/flowchart_short2.pdf
	scale 75

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:flowchart"

\end_inset

Abbreviated flowchart showing the progression of the major bgaPEST procedures.
 Text in blue italics is interpretive, summarizing the more programmatic
 language represented in black plain type
\change_deleted -1837876828 1342698879
.
\change_unchanged

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection

\change_deleted -1837876828 1342549713
bgaPEST 
\change_unchanged
Control Variables
\end_layout

\begin_layout Standard
Two types of variables are used in bgaPEST: 
\change_deleted -1837876828 1342549717
data
\change_inserted -1837876828 1342549739
control
\change_unchanged
 variables and 
\change_deleted -1837876828 1342549721
control
\change_inserted -1837876828 1342549722
data
\change_unchanged
 variables.
\change_inserted -1837876828 1342549729

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342549735
Switched for emphasis.
\change_unchanged

\end_layout

\end_inset


\change_unchanged
 
\change_deleted -1837876828 1342549747
D
\change_inserted -1837876828 1342549749
Whereas d
\change_unchanged
ata variables are values such as model parameters, observations, file names,
 and other data that are needed by the bgaPEST program
\change_deleted -1837876828 1342549754
.
\change_inserted -1837876828 1342549754
,
\change_unchanged
 
\change_deleted -1837876828 1342549756
C
\change_inserted -1837876828 1342549756
c
\change_unchanged
ontrol variables
\change_deleted -1837876828 1342549761
, on the other hand,
\change_unchanged
 drive the actions that are performed on these data elements.
 As such, control variables 
\change_deleted -1837876828 1342194780
are abstracted on
\change_inserted -1837876828 1342549776
operate on a (?)
\change_unchanged
 level 
\change_inserted -1837876828 1342194792
different (?) 
\change_unchanged
from data variables and control either the reading/writing of data or the
 progression of the algorithm.
 Many control variables are straightforward (for example, 
\family typewriter
it_max_phi
\family default
\emph on
, 
\emph default
an integer, is the total number of iterations allowed in each quasi-linear
 inner estimation optimization
\change_deleted -1837876828 1342194809
.
\change_inserted -1837876828 1342194809
;
\change_unchanged
 
\emph on
default=10).

\emph default
 Such variables are defined in the context of the input instructions 
\change_inserted -1837876828 1342549787
listed 
\change_unchanged
in 
\change_deleted -1837876828 1342194816
A
\change_inserted -1837876828 1342194816
a
\change_unchanged
ppendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Input-Instructions"

\end_inset

.
 
\change_deleted -1837876828 1342194836
However, o
\change_inserted -1837876828 1342194836
O
\change_unchanged
ther control variables
\change_inserted -1837876828 1342194841
, however,
\change_unchanged
 are accompanied by important conventions regarding their impact on the
 performance of the algorithm.
 
\change_deleted -1837876828 1342194879
For these cases, in this section, m
\change_inserted -1837876828 1342194884
M
\change_unchanged
ore detail is 
\change_deleted -1837876828 1342194924
provided
\change_inserted -1837876828 1342194925
given
\change_unchanged
 about certain control variables
\change_inserted -1837876828 1342194907
 in this section for these cases
\change_unchanged
.
 
\end_layout

\begin_layout Description

\family typewriter
structural_conv
\family default
 
\emph on
float
\emph default
, 
\emph on
default=0.001
\emph default
Convergence criterion for structural parameter convergence.
 Positive or negative values can be used to trigger two different measures
 of convergence, as noted below.
 In either case, however, convergence is compared to the absolute value
 of 
\family typewriter
structural_conv
\family default
.
 
\begin_inset Newline newline
\end_inset

 If positive, convergence is based on the absolute difference in structural
 parameter objective function over consecutive iterations
\change_deleted -1837876828 1342195000
.
\change_inserted -1837876828 1342195000
:
\change_unchanged
 
\begin_inset Formula 
\[
\mathrm{conv}=\mathrm{abs}\left(\Phi_{S,i}-\Phi_{S,i-1}\right)
\]

\end_inset

where 
\begin_inset Formula $i\mbox{ }$
\end_inset

 is the current structural parameter optimization iteration, 
\begin_inset Formula $i-1$
\end_inset

 is the previous structural parameter optimization iteration, and 
\begin_inset Formula $\Phi_{S}$
\end_inset

 is the structural parameter objective function.
\begin_inset Newline newline
\end_inset

 If negative, convergence is based on the norm of the difference between
 consecutive structural parameter values
\change_deleted -1837876828 1342195003
.
\change_inserted -1837876828 1342195003
:
\change_unchanged
 
\begin_inset Formula 
\[
\mathrm{conv=}\sqrt{\left(\frac{\mathbf{\theta}_{i-1}-\theta_{i}}{\theta_{i-1}}\right)^{T}\left(\frac{\mathbf{\theta}_{i-1}-\theta_{i}}{\theta_{i-1}}\right)}
\]

\end_inset

where 
\begin_inset Formula $i$
\end_inset

 and 
\begin_inset Formula $i-1$
\end_inset

 are as defined above, and 
\begin_inset Formula $\mathbf{\theta}$
\end_inset

 is a vector containing all structural parameters currently being estimated
 (may include epistemic uncertainty, if requested).
 
\end_layout

\begin_layout Description

\family typewriter
phi_conv
\family default
 
\emph on
float, default=0.001 
\emph default
Convergence criterion for objective function convergence.
 The convergence at each inner iteration is evaluated as the absolute difference
 from one inner iteration to the next.
 This is evaluated as 
\begin_inset Formula 
\[
\mathrm{conv}=\mathrm{abs}\left(\Phi_{T,i_{in}}-\Phi_{T,i_{in}-1}\right)
\]

\end_inset

where
\emph on
 
\begin_inset Formula $i_{in}$
\end_inset

 
\emph default
is the current inner iteration
\change_deleted -1837876828 1342549844
,
\change_unchanged
 and 
\begin_inset Formula $\Phi_{T}$
\end_inset

 is the total objective function (
\change_deleted -1837876828 1342195030
E
\change_inserted -1837876828 1342195030
e
\change_unchanged
quation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:phiT"

\end_inset

).
 
\end_layout

\begin_layout Description

\family typewriter
bga_conv
\family default
 
\emph on
float, default=
\begin_inset Formula $10\times$
\end_inset


\family typewriter
\emph default
phi_conv
\family default
\emph on
 
\emph default
Convergence criterion for objective function outer iterations.
 The convergence at each outer iteration is evaluated as the absolute difference
 from one outer iteration to the next.
 This accounts for 
\change_deleted -1837876828 1342549855
both
\change_unchanged
 convergence of
\change_inserted -1837876828 1342549859
 both
\change_unchanged
 
\begin_inset Formula $\Phi_{T}$
\end_inset

 and 
\begin_inset Formula $\Phi_{S}$
\end_inset

.
 The convergence is evaluated as 
\begin_inset Formula 
\[
\mathrm{conv}=\mathrm{abs}\left(\Phi_{T,i_{out}}-\Phi_{T,i_{out}-1}\right)
\]

\end_inset

where 
\begin_inset Formula $i_{out}$
\end_inset

 is the outer iteration
\change_deleted -1837876828 1342549866
,
\change_unchanged
 and 
\begin_inset Formula $\Phi_{T}$
\end_inset

 is the total objective function (
\change_deleted -1837876828 1342195047
E
\change_inserted -1837876828 1342549857
e
\change_unchanged
q
\change_deleted -1837876828 1342549819
uation
\change_inserted -1837876828 1342549857
.

\change_unchanged
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:phiT"

\end_inset

).

\emph on
 
\emph default
 
\end_layout

\begin_layout Description

\family typewriter
Q_compression_flag
\family default
 
\emph on
integer, default=0
\emph default
 Flag to determine how to calculate 
\begin_inset Formula $Q_{0}$
\end_inset


\change_inserted -1837876828 1342549876
:
\change_unchanged
 [0] = no compression--calculate full 
\begin_inset Formula $Q_{0}$
\end_inset

 matrix, [1] = 
\change_deleted -1837876828 1342549885
C
\change_inserted -1837876828 1342549885
c
\change_unchanged
alculate separate 
\begin_inset Formula $Q_{0}$
\end_inset

 matrix for each beta association.
 In addition to controlling the behavior of prior covariance compression,
 this flag also determines whether a full posterior covariance matrix or
 only the diagonal 
\change_deleted -1837876828 1342195067
are
\change_inserted -1837876828 1342195067
is
\change_unchanged
 calculated.
\end_layout

\begin_layout Description

\family typewriter
posterior_cov_flag
\family default
 
\emph on
integer 
\emph default
Flag to determine whether posterior covariance matrix should be calculated
\change_deleted -1837876828 1342549910
.
\change_inserted -1837876828 1342549910
:
\change_unchanged
 [0] = do not calculate posterior covariance matrix, [1] = calculate posterior
 covariance.
 If 
\family typewriter
Q_compression_flag=1
\family default
, only the diagonal of the posterior covariance matrix is calculated.
 If 
\family typewriter
posterior_cov_flag=0
\family default
 then 95
\change_deleted -1837876828 1342457777
%
\change_inserted -1837876828 1342457780
-percent
\change_unchanged
 confidence intervals are not calculated
\change_inserted -1837876828 1342195091
,
\change_unchanged
 and the output file 
\family typewriter
<casename>.bpp.fin
\family default
 discussed below does not include confidence intervals.
 
\end_layout

\begin_layout Subsection
Input Files
\end_layout

\begin_layout Standard
The bgaPEST program is run from the command line by typing 
\family typewriter
bgaPEST.exe 
\begin_inset Formula $<$
\end_inset

casename
\begin_inset Formula $>$
\end_inset

.bgp
\change_deleted -1837876828 1342195740

\family default
 
\change_inserted -1837876828 1342195737
, 
\change_unchanged
where 
\family typewriter

\begin_inset Formula $<$
\end_inset

casename
\begin_inset Formula $>$
\end_inset


\family default
 is a filename containing input instructions.
 Detailed input instruction are in 
\change_deleted -1837876828 1342195746
A
\change_inserted -1837876828 1342195746
a
\change_unchanged
ppendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Input-Instructions"

\end_inset

.
\end_layout

\begin_layout Subsection
Output Files
\end_layout

\begin_layout Standard
Several output files are generated throughout the progression of a single
 bgaPEST run.
 These files are summarized in this section.
\end_layout

\begin_layout Subsubsection
bgaPEST Record File 
\family typewriter

\begin_inset Formula $<$
\end_inset

casename
\begin_inset Formula $>$
\end_inset

.bpr
\end_layout

\begin_layout Standard
The main output file for bgaPEST is called 
\family typewriter

\begin_inset Formula $<$
\end_inset

casename
\begin_inset Formula $>$
\end_inset

.bpr
\family default
.
 Initial values of bgaPEST input are repeated to form a record for the bgaPEST
 run.
 After each inner iteration
\change_deleted -1837876828 1342195864
,
\change_unchanged
 as defined above, the objective function is reported and external files
 are written that include current parameter values and observation values.
 After each outer iteration, structural parameter values 
\change_inserted -1837876828 1342195887
also 
\change_unchanged
are 
\change_deleted -1837876828 1342195884
also
\change_unchanged
 reported for each beta association in which structural parameter estimation
 was requested and for the epistemic uncertainty term, if requested.
 After the final outer iteration, all structural parameter values--including
 those which were not estimated--are reported to make a complete record.
\end_layout

\begin_layout Subsubsection
bgaPEST Parameter Value Files 
\family typewriter

\begin_inset Formula $<$
\end_inset

casename
\begin_inset Formula $>$
\end_inset

.bpp.
\begin_inset Formula $<$
\end_inset

#Oi
\begin_inset Formula $>$
\end_inset

_
\begin_inset Formula $<$
\end_inset

#Ii
\begin_inset Formula $>$
\end_inset


\end_layout

\begin_layout Standard
The parameter values are written to files called 
\family typewriter

\begin_inset Formula $<$
\end_inset

casename
\begin_inset Formula $>$
\end_inset

.bpp.
\begin_inset Formula $<$
\end_inset

#Oi
\begin_inset Formula $>$
\end_inset

_
\begin_inset Formula $<$
\end_inset

#Ii
\begin_inset Formula $>$
\end_inset

 
\family default
where
\family typewriter
 
\begin_inset Formula $<$
\end_inset

#Oi
\begin_inset Formula $>$
\end_inset

 
\family default
is the outer iteration number and
\family typewriter
 
\begin_inset Formula $<$
\end_inset

#Ii
\begin_inset Formula $>$
\end_inset

 
\family default
is the inner iteration number.
 These 
\change_deleted -1837876828 1342196009
ascii
\change_inserted -1837876828 1342196010
ASCII
\change_unchanged
 files are printed in columns with the following headers: 
\family typewriter
ParamName
\family default
; 
\family typewriter
ParamGroup
\family default
; 
\family typewriter
BetaAssoc
\family default
; 
\family typewriter
ParamVal
\family default
.
 At the beginning of a bgaPEST run, a file 
\family typewriter

\begin_inset Formula $<$
\end_inset

casename
\begin_inset Formula $>$
\end_inset

.bpp.0 
\family default
is written in the same format to record the initial parameter values used.
 This is done to avoid cluttering the 
\family typewriter

\begin_inset Formula $<$
\end_inset

casename
\begin_inset Formula $>$
\end_inset

.bpr
\family default
 file with what is often a very long list of parameters and their values.
 Parameter values that were subjected to logarithmic transformation are
 reported in their linear space, 
\emph on
not 
\emph default
log-transformed space.
\end_layout

\begin_layout Standard
Another special case of parameter value files is written at the end of a
 bgaPEST run and called 
\family typewriter

\begin_inset Formula $<$
\end_inset

casename
\begin_inset Formula $>$
\end_inset

.bpp.fin
\family default
.
 This file contains the final parameter values estimated as optimal by bgaPEST.
 Furthermore, if posterior covariance calculation was requested, two additional
 columns are added: 
\family typewriter
95pctLCL
\family default
 and 
\family typewriter
95pctUCL
\change_deleted -1837876828 1342196042

\family default
 
\change_inserted -1837876828 1342196039
, 
\change_unchanged
which are the 95
\change_deleted -1837876828 1342457791
%
\change_inserted -1837876828 1342457793
-percent
\change_unchanged
 lower and upper confidence limits, respectively.
 These confidence limits are obtained by applying the subtraction and addition,
 respectively, of 
\begin_inset Formula $2\times\sqrt{\mathbf{V}_{ii}}$
\end_inset

 to 
\begin_inset Formula $\mathbf{s}_{i}$
\end_inset

--the 
\begin_inset Formula $i^{th}$
\end_inset

 
\change_inserted -1837876828 1342196074

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342196077
Note 12
\change_unchanged

\end_layout

\end_inset


\change_unchanged
optimal parameter value.
 In this case, 
\begin_inset Formula $\mathbf{V}$
\end_inset

 is the posterior covariance, so 
\begin_inset Formula $\sqrt{\mathbf{V}_{ii}}$
\end_inset

 is the standard deviation of the 
\begin_inset Formula $i^{th}$
\end_inset

 parameter.
 The 95
\change_deleted -1837876828 1342457801
%
\change_inserted -1837876828 1342457803
-percent
\change_unchanged
 confidence limits are reported in linear space, 
\emph on
not
\emph default
 log-transformed space, so for log-transformed parameters, the upper and
 lower 95
\change_deleted -1837876828 1342457812
%
\change_inserted -1837876828 1342457813
-percent
\change_unchanged
 percent confidence limits are not symmetrical about the parameter value.
\end_layout

\begin_layout Subsubsection
bgaPEST Observation Value Files 
\family typewriter

\begin_inset Formula $<$
\end_inset

casename
\begin_inset Formula $>$
\end_inset

.bre.
\begin_inset Formula $<$
\end_inset

#Oi
\begin_inset Formula $>$
\end_inset

_
\begin_inset Formula $<$
\end_inset

#Ii
\begin_inset Formula $>$
\end_inset


\end_layout

\begin_layout Standard
The observation values obtained by running the forward model with the currently
 estimated parameters are written to files called 
\family typewriter

\begin_inset Formula $<$
\end_inset

casename
\begin_inset Formula $>$
\end_inset

.bre.
\begin_inset Formula $<$
\end_inset

#Oi
\begin_inset Formula $>$
\end_inset

_
\begin_inset Formula $<$
\end_inset

#Ii
\begin_inset Formula $>$
\end_inset

 
\family default
following a similar convention as with the 
\family typewriter

\begin_inset Formula $<$
\end_inset

casename
\begin_inset Formula $>$
\end_inset

.bpp
\family default
 files above.
 The 
\change_deleted -1837876828 1342196880
ascii
\change_inserted -1837876828 1342196881
ASCII
\change_unchanged
 files are printed with the following headers: 
\family typewriter
ObsName
\family default
;
\family typewriter
 ObsGroup
\family default
;
\family typewriter
 Modeled
\family default
;
\family typewriter
 Measured
\family default
.
 These files 
\change_deleted -1837876828 1342550415
may
\change_inserted -1837876828 1342550416
can
\change_unchanged
 be easily copied into a spreadsheet or read with a plotting program to
 calculate and plot residuals.
\end_layout

\begin_layout Subsubsection
Posterior Covariance File 
\family typewriter

\begin_inset Formula $<$
\end_inset

casename
\begin_inset Formula $>$
\end_inset

.post.cov
\end_layout

\begin_layout Standard
If the input variable 
\family typewriter
posterior_cov_flag=1
\family default
, then posterior covariance of the parameters 
\begin_inset Formula $\mathbf{s}$
\end_inset

 is calculated.
 In addition to this information being used to report 95
\change_deleted -1837876828 1342457829
%
\change_inserted -1837876828 1342457829
-percent
\change_unchanged
 confidence limits as described above, the posterior covariance matrix is
 also written to the file 
\family typewriter

\begin_inset Formula $<$
\end_inset

casename
\begin_inset Formula $>$
\end_inset

.post.cov
\family default
.
 If the variable 
\family typewriter
Q_compression_flag=1
\family default
, then compression is used for saving the prior covariance matrix.
 This is done when 
\change_deleted -1837876828 1342196923
a large number of
\change_inserted -1837876828 1342196924
many
\change_unchanged
 parameters 
\change_deleted -1837876828 1342196926
is
\change_inserted -1837876828 1342196926
are
\change_unchanged
 used and, thus, the full covariance matrices are unwieldy.
 
\change_deleted -1837876828 1342550429
Based o
\change_inserted -1837876828 1342550426
O
\change_unchanged
n 
\change_inserted -1837876828 1342550433
the basis of 
\change_unchanged
this choice, the posterior covariance is 
\change_deleted -1837876828 1342196952
either
\change_unchanged
 reported 
\change_inserted -1837876828 1342196955
either 
\change_unchanged
as the diagonal of the posterior covariance matrix 
\begin_inset Formula $\left(diag\left(\mathbf{V}\right)\right)$
\end_inset

 if 
\family typewriter
Q_compression_flag=1
\family default
 or 
\change_inserted -1837876828 1342550445
as 
\change_unchanged
the full covariance matrix 
\begin_inset Formula $\mathbf{V}$
\end_inset

 if 
\family typewriter
Q_compression_flag=0
\family default
.
 The output formats are discussed at the end of 
\change_deleted -1837876828 1342195785
Appendix
\change_inserted -1837876828 1342195785
appendix
\change_unchanged
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Input-Instructions"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
fcolorbox{black}{ltgrey}{
\end_layout

\begin_layout Plain Layout


\backslash
begin{minipage}[t]{0.9
\backslash
columnwidth}
\end_layout

\begin_layout Plain Layout


\backslash
textbf{Posterior Covariance and Parameter log-Transformations}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

In this section, it was indicated that in the 
\backslash
texttt{$<$casename$>$.bpp.fin}
\end_layout

\begin_layout Plain Layout

file, parameter values and 95
\backslash

\change_deleted -1837876828 1342457840
%
\change_inserted -1837876828 1342457840
-percent
\change_unchanged
 confidence intervals are reported
\end_layout

\begin_layout Plain Layout

in linear (untransformed) space
\change_inserted -1837876828 1342458126
,
\change_unchanged
 
\change_deleted -1837876828 1342458128
while
\change_inserted -1837876828 1342458129
whereas
\change_unchanged
 in the 
\backslash
texttt{$<$casename$>$.post.cov
\end_layout

\begin_layout Plain Layout

}file, posterior covariance values are reported in estimation (log-transformed)
\end_layout

\begin_layout Plain Layout

space.
 Why the difference? The two files
\change_deleted -1837876828 1342458140
 
\change_unchanged
 serve slightly different
\end_layout

\begin_layout Plain Layout

purposes.
 The parameter output file presents values in the units they
\end_layout

\begin_layout Plain Layout

are entered in (and, presumably, the units ``seen'' by the forward
\end_layout

\begin_layout Plain Layout

model).
 As a result, 95
\backslash

\change_deleted -1837876828 1342457841
%
\change_inserted -1837876828 1342457841
-percent
\change_unchanged
 confidence intervals are reported in the
\end_layout

\begin_layout Plain Layout

same way.
 Furthermore, the addition and subtraction of $2
\backslash
times
\backslash
sqrt{
\backslash
mathbf{V}_{ii}}$
\end_layout

\begin_layout Plain Layout

must be applied to the parameters before back-transformation, which
\end_layout

\begin_layout Plain Layout

explains the asymmetry of the confidence limits.
 On the other hand,
\end_layout

\begin_layout Plain Layout

the full posterior covariance matrix is intended for other analysis
\end_layout

\begin_layout Plain Layout

(propagation of variance through to predictions, conditional realizations,
\end_layout

\begin_layout Plain Layout

and others) in which the information should be retained in estimation
\end_layout

\begin_layout Plain Layout

(log-transformed) space.
 In the end, the decision of how to report
\end_layout

\begin_layout Plain Layout

these values is one of convention, and this side box is intended to
\end_layout

\begin_layout Plain Layout

make clear which was chosen in each case.%
\end_layout

\begin_layout Plain Layout


\backslash
end{minipage}
\end_layout

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Suggestions and Guidelines for Initial Use
\end_layout

\begin_layout Standard
The Bayesian Geostatistical Approach is a highly parameterized method that
 is appropriate for some, but not all
\change_inserted -1837876828 1342196996
,
\change_unchanged
 applications.
 In this section, we outline a few considerations to aid in the decision
 about whether to use bgaPEST on a given problem 
\change_deleted -1837876828 1342197008
based
\change_inserted -1837876828 1342197012
given
\change_unchanged
 
\change_deleted -1837876828 1342197018
on
\change_unchanged
 the history and characteristics of the method.
 We also 
\change_deleted -1837876828 1342197024
provide
\change_inserted -1837876828 1342197025
offer
\change_unchanged
 a few guidelines to help 
\change_inserted -1837876828 1342197036
users 
\change_unchanged
avoid potential pitfalls in the application of bgaPEST.
\end_layout

\begin_layout Standard
This report documents the first release of bgaPEST and, to our knowledge,
 the first implementation of BGA available in a generalized package.
 As a result, users of this version will be among the first to apply this
 software outside of academia
\change_inserted -1837876828 1342197076
,
\change_unchanged
 where custom programs have been the rule.
 Nonetheless, the method has a 20
\change_inserted -1837876828 1342197080
-
\change_deleted -1837876828 1342197080
 
\change_unchanged
year history.
 The majority of applications have been to groundwater modeling projects
 including (but not limited to)
\change_deleted -1837876828 1342197093
:
\change_unchanged
 pumping test analysis 
\begin_inset CommandInset citation
LatexCommand citep
key "SnodgrassPKK1998"

\end_inset

; hydraulic tomography 
\begin_inset CommandInset citation
LatexCommand citep
key "LiCirpka2007,FienenWRR2008,LiCirpka2008,CardiffPKK2009,cardiff2012"

\end_inset

; borehole logging 
\begin_inset CommandInset citation
LatexCommand citep
key "fienenEtal2004"

\end_inset

; contaminant source identification 
\begin_inset CommandInset citation
LatexCommand citep
key "SnodgrassPKK1997,MichalakPKK2002a,MichalakPKK2003"

\end_inset

; and nonparametric tracer test analysis 
\begin_inset CommandInset citation
LatexCommand citep
key "FienenWRR2006"

\end_inset

.
 The main application to date that does not involve groundwater is in atmospheri
c modeling 
\begin_inset CommandInset citation
LatexCommand citep
key "MIchalak2004,MuellerEtAl2008"

\end_inset

.
\end_layout

\begin_layout Subsection
Characteristics 
\change_deleted -1837876828 1342550465
for Suggested
\change_inserted -1837876828 1342550473
of Appropriate bgaPEST
\change_unchanged
 Use
\change_inserted -1837876828 1342550483
s
\change_unchanged

\end_layout

\begin_layout Standard
The characteristics that unite these applications form a solid guide when
 deciding 
\change_deleted -1837876828 1342197124
if
\change_inserted -1837876828 1342197125
whether
\change_unchanged
 bgaPEST is appropriate for a given application.
 First
\change_deleted -1837876828 1342197131
,
\change_unchanged
 and foremost, there must be a parameter set that varies 
\change_deleted -1837876828 1342197138
either
\change_unchanged
 in 
\change_inserted -1837876828 1342197142
either 
\change_unchanged
space or time
\change_inserted -1837876828 1342197167
; 
\change_deleted -1837876828 1342197165
.
 F
\change_inserted -1837876828 1342197170
f
\change_unchanged
or example, a time series of chemical concentrations (a breakthrough curve),
 a hydraulic conductivity field, a recharge field, or surface flux of atmospheri
c gasses.
 These parameters should vary continuously over reasonably substantial areas
 
\change_deleted -1837876828 1342550501
for
\change_inserted -1837876828 1342550502
so that
\change_unchanged
 a variogram 
\change_deleted -1837876828 1342550505
to be
\change_inserted -1837876828 1342550506
serves as
\change_unchanged
 an adequate descriptor of the shape of the parameter field.
 Sub
\change_deleted -1837876828 1342197181
-
\change_unchanged
areas delineated by geologic contacts
\change_deleted -1837876828 1342197189
, 
\change_inserted -1837876828 1342197189
--
\change_unchanged
or in the case of time series, punctuated by known events
\change_deleted -1837876828 1342197194
, 
\change_inserted -1837876828 1342197194
--
\change_unchanged
can be partitioned into beta associations, as discussed throughout this
 report.
 Another consideration is a more practical one
\change_deleted -1837876828 1342197208
--
\change_inserted -1837876828 1342197208
: 
\change_unchanged
model run time.
\end_layout

\begin_layout Standard
The nature of bgaPEST is that many parameters are to be estimated.
 Throughout the parameter estimation process, a Jacobian sensitivity matrix
 must be calculated, requiring one model run per parameter.
 This computational burden must be considered and
\change_deleted -1837876828 1342197221
,
\change_unchanged
 potentially mitigated.
 In academic settings, many researchers have taken advantage of adjoint
\change_inserted -1837876828 1342550536
-
\change_deleted -1837876828 1342550536
 
\change_unchanged
state techniques to make the calculation of the Jacobian matrix more efficient
 in the case where parameters greatly outnumber observations.
 Adjoint
\change_inserted -1837876828 1342550550
-
\change_deleted -1837876828 1342550549
 
\change_unchanged
state versions of commercial and government codes are not typically available,
 however, but bgaPEST is equipped to handle Jacobian matrices calculated
 outside of bgaPEST so 
\change_inserted -1837876828 1342550557
that 
\change_unchanged
users who are able to write such codes can make use of them.
 Similarly, parallelization of the Jacobian calculations is a feature that
 will be added in the future.
 For now, through clever scripting, it is possible to use beoPEST outside
 of bgaPEST to parallelize the calculations of the Jacobian matrix.
 In this initial release of bgaPEST, however, it may be more practical to
 stick with models with short run times, run Jacobian calculations in series
\change_inserted -1837876828 1342197261
,
\change_unchanged
 and just recognize that the computational burden may be high.
\end_layout

\begin_layout Standard
Adjoint-state Jacobian calculation is an attractive method to mitigate high
 computational expense of this method
\change_deleted -1837876828 1342197324
.
 H
\change_inserted -1837876828 1342197327
; h
\change_unchanged
owever, production codes for adjoint
\change_inserted -1837876828 1342550574
-
\change_deleted -1837876828 1342550574
 
\change_unchanged
state calculations are rare.
 For more information on the technique, see 
\begin_inset CommandInset citation
LatexCommand citep
key "TownleyWilson1985,Sykes1985,SamperNeuman1986,RamaRao1995,neupauerWilson1999"

\end_inset

 and references therein.
\end_layout

\begin_layout Standard
A common occurrence in groundwater modeling applications is that parameters
 far exceed observations in number.
 This, of course, can change in transient simulations where, if each measurement
 in time at a single measurement location is considered an observation,
 the numbers of observations and parameters may equalize.
 
\change_inserted -1837876828 1342550588
Use of 
\change_unchanged
bgaPEST is most appropriate for the former case--where parameters outnumber
 observations, typically by a large margin.
 Several programming and mathematical accommodations are made to enable
 the number of parameters to grow very large (testing has been performed
 with 90,000 parameters).
 
\change_deleted -1837876828 1342197336
However, i
\change_inserted -1837876828 1342197338
I
\change_unchanged
f the number of observation grows significantly, 
\change_inserted -1837876828 1342197344
however, 
\change_unchanged
computer memory will become a limitation in many cases.
 For transient problems, one should consider the information content of
 each measurement point in time.
 Often, the number of observation points can be effectively reduced by consideri
ng moments rather than discrete points 
\begin_inset CommandInset citation
LatexCommand citep
key "LiNowakCirpka2005"

\end_inset

 or by other time
\change_inserted -1837876828 1342197361
-
\change_deleted -1837876828 1342197361
 
\change_unchanged
series processing such as methods available in R 
\begin_inset CommandInset citation
LatexCommand citep
key "R"

\end_inset

 or TSPROC 
\begin_inset CommandInset citation
LatexCommand citep
key "TSPROC"

\end_inset

.
\end_layout

\begin_layout Subsection
Guidelines
\end_layout

\begin_layout Standard
The number of applications of bgaPEST th
\change_deleted -1837876828 1342197661
i
\change_inserted -1837876828 1342197661
u
\change_unchanged
s far is limited.
 
\change_deleted -1837876828 1342197677
As
\change_inserted -1837876828 1342550605
Because bgaPEST is
\change_unchanged
 new software 
\change_deleted -1837876828 1342197683
and
\change_inserted -1837876828 1342197690
implementing
\change_unchanged
 a relatively novel technique, it will take time for users to 
\change_deleted -1837876828 1342197698

\begin_inset Quotes eld
\end_inset


\change_unchanged
get a feel
\change_deleted -1837876828 1342197700

\begin_inset Quotes erd
\end_inset


\change_unchanged
 for the behavior and characteristics of the tool.
 In this section, we provide a few guidelines that we hope will help users
 avoid pitfalls.
 In future releases, building on the experience of a larger user base, more
 guidelines will be
\change_deleted -1837876828 1342550614
come
\change_unchanged
 available.
\end_layout

\begin_layout Subparagraph*
Run Times
\end_layout

\begin_layout Standard
For a typical groundwater model, somewhere between 5 and 15 outer iterations
 will often be required.
 For each outer iteration, it is likely that about 5 inner iterations 
\change_deleted -1837876828 1342550635
are
\change_inserted -1837876828 1342550637
will be
\change_unchanged
 necessary.
 This means 
\change_deleted -1837876828 1342197727
up to
\change_inserted -1837876828 1342197730
as many as
\change_unchanged
 75 calculations of the Jacobian matrix may be required.
 Without parallelization or adjoint state, users should carefully consider
 how many parameters can be accommodated as run times grow in length.
 For planning, assume that the time required for each Jacobian calculation
 
\change_deleted -1837876828 1342197745
is
\change_inserted -1837876828 1342197748
will be
\change_unchanged
 the number of parmeters 
\begin_inset Formula $\left(m\right)$
\end_inset

 
\begin_inset Formula $\times$
\end_inset

 Run Time.
\end_layout

\begin_layout Subparagraph*
Beta Associations
\end_layout

\begin_layout Standard
Beta associations provide the ability to include knowledge about contacts
 and other partitions in the parameter fields.
 Some beta associations can have a separate parameter value in each node,
 
\change_deleted -1837876828 1342197762
while
\change_inserted -1837876828 1342197764
whereas
\change_unchanged
 others can be treated as homogeneous zones.
 
\change_deleted -1837876828 1342550653
This
\change_inserted -1837876828 1342550661
Specification of either alternitive (?)
\change_unchanged
 is accomplished through the design of the template file.
\change_inserted -1837876828 1342550666

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342550671
Is this what you mean?
\change_unchanged

\end_layout

\end_inset


\change_unchanged
 In addition to allowing for the inclusion of well-known structures such
 as lithologic contacts, beta associations also allow for some regions--either
 because of greater importance to the ultimate management decisions, 
\change_deleted -1837876828 1342197826
due to
\change_inserted -1837876828 1342197830
or because of
\change_unchanged
 greater density of data, or both--to have a large number of parameters
 whereas other regions have homogeneous values.
 By 
\change_deleted -1837876828 1342197845
only
\change_unchanged
 allowing a large number of parameters 
\change_inserted -1837876828 1342197849
only 
\change_unchanged
in focused areas of interest, the overall number of parameters can be reduced,
 thus mitigating some of the concerns about run times.
\end_layout

\begin_layout Subparagraph*
Line Search
\end_layout

\begin_layout Standard
The purpose of the line search
\change_inserted -1837876828 1342197887

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342197891
Note 13
\change_unchanged

\end_layout

\end_inset


\change_unchanged
 is similar to the purpose of the Levenberg-Marquardt adjustment used in
 PEST.
 
\change_deleted -1837876828 1342197945
While
\change_inserted -1837876828 1342197946
Whereas
\change_unchanged
 the Levenberg-Marquardt search makes a correction to the search direction
 when the optimization algorithm might otherwise stray from the optimal
 direction, the linesearch adjusts the length along the Quasi-Newton direction
 to avoid overshooting.
 The linesearch, therefore, serves its greatest purpose in its first iteration
 or two.
 After that, the value of the linesearch is limited for mathematical reasons
 having to do with linearization of the problem (see 
\change_deleted -1837876828 1342195792
Appendix
\change_inserted -1837876828 1342195792
appendix
\change_unchanged
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:methodologyDetails"

\end_inset

 for more details).
 As a result, a value of between 2 and 5 for 
\family typewriter
it_max_linesearch
\family default
 in the control variables is generally adequate.
 If the linesearch algorithm does not converge, a warning will be issued
 and, 
\change_deleted -1837876828 1342197978
while
\change_inserted -1837876828 1342197980
although
\change_unchanged
 it is good to know that this took place, the linesearch has served its
 purpose and little gain will be achieved by increasing 
\family typewriter
it_max_linesearch.
\end_layout

\begin_layout Subparagraph*
Level of Fit
\end_layout

\begin_layout Standard
\begin_inset Quotes eld
\end_inset

With great power comes great responsibility.
\begin_inset Quotes erd
\end_inset

 In applications where parameters outnumber observations, 
\change_inserted -1837876828 1342550830
there lurks 
\change_unchanged
a real danger 
\change_deleted -1837876828 1342550832
lurks
\change_unchanged
 of overfitting.
 In other words, parameters can be adjusted to achieve a 
\change_deleted -1837876828 1342550852
level of 
\change_unchanged
correspondence between simulated and observed equivalents that exceeds a
 reasonable level.
 The danger of this is that some of the 
\emph on
lack
\emph default
 of correspondence is often due to random epistemic error and is not representat
ive of actual system behavior.
 However, if the parameters are adjusted to match observations within this
 margin of error, they are 
\begin_inset Quotes eld
\end_inset

fitting the noise.
\begin_inset Quotes erd
\end_inset

 The ramifications of this 
\change_inserted -1837876828 1342198055
type of adjustment 
\change_unchanged
are mainly 
\change_deleted -1837876828 1342550883
a 
\change_unchanged
diminish
\change_deleted -1837876828 1342550887
ment of
\change_inserted -1837876828 1342550887
ed
\change_unchanged
 predictive power of the model and unrealistic roughness of the parameter
 fields estimated.
 There are two means of avoiding this problem.
 One is the maximum entropy property of BGA.
 The algorithm is designed to find the 
\emph on
smoothest
\emph default
 solution consistent with the level of fit.
 If all structural parameters--including 
\begin_inset Formula $\sigma_{R}$
\end_inset

--are estimated, 
\change_inserted -1837876828 1342198074
then 
\change_unchanged
the algorithm will try to achieve perfect fit with the smoothest solution
 that can do so.
 This may still lead to overfitting, however, so in most cases, it is more
 appropriate to set the level of fit 
\change_inserted -1837876828 1342198106
by 
\change_unchanged
using 
\family typewriter
sig_0
\family default
 in the Epistemic Error Term input block described below to a level of fit
 chosen by the user to be appropriate
\change_inserted -1837876828 1342198115
,
\change_unchanged
 given known and suspected uncertainties about both the observation quality
 and the model.
 Weights on observations can account for different levels of quality in
 different observations.
 In most cases, the user should also set 
\family typewriter
sig_opt=0
\family default
 to force the algorithm to use a consistent value for epistemic uncertainty
 and thus 
\change_deleted -1837876828 1342550988
to
\change_unchanged
 manually control the level of fit.
 If set this way, the algorithm will adjust the other structural parameters
 to achieve the smoothest possible solution corresponding to the specified
 level of fit.
\end_layout

\begin_layout Standard
The level of smoothness in the optimal BGA solution is always smoother than
 conditional realizations 
\begin_inset CommandInset citation
LatexCommand citep
key "Kitanidis1995"

\end_inset


\change_deleted -1837876828 1342198160
 
\change_inserted -1837876828 1342198158
, 
\change_unchanged
which characterize more of the potential variability in each solution.
 In cases such as transport models where heterogeneity is the most important
\change_inserted -1837876828 1342551002
 factor
\change_unchanged
, conditional realizations (made possible using the optimal solution and
 the posterior covariance--both provided by bgaPEST) will 
\change_deleted -1837876828 1342198172
provide
\change_inserted -1837876828 1342198174
result in
\change_unchanged
 a more precise characterization of system behavior in heterogeneity.
\end_layout

\begin_layout Subparagraph*
Structural Parameter Optimization
\end_layout

\begin_layout Standard
A good general guideline for all modeling is to start simple and add complexity
 as appropriate.
 In bgaPEST, this goal is achieved by starting with small values of variogram
 parameters (slope for the linear, variance for the nugget or exponential)
 such that the solution will be very smooth.
 By optimizing for structural parameters, roughness will be introduced by
 the algorithm until convergence at the optimal level of roughness
\change_inserted -1837876828 1342551037
 is achieved
\change_unchanged
.
 At the early, exploratory stages of a project, it might be desirable to
 set 
\family typewriter
sig_opt=1
\family default
 to see what level of fit may be achievable, but the user should be prepared
 to override this 
\change_inserted -1837876828 1342198387
setting 
\change_unchanged
in later stages as allowing too much roughness to be introduced.
 For the prior distribution variogram parameters, however, optimization
 should always be employed in keeping with the Empirical Bayes perspective
 
\change_inserted -1837876828 1342198437
designed into 
\change_unchanged
the algorithm
\change_deleted -1837876828 1342198442
 was designed with
\change_unchanged
.
\end_layout

\begin_layout Section
Limitations 
\change_deleted -1837876828 1342198447
to
\change_inserted -1837876828 1342198447
of
\change_unchanged
 
\change_inserted -1837876828 1342711218
bgaPEST 
\change_unchanged
Version 1.0
\end_layout

\begin_layout Standard
bgaPEST marks the first widely available implementation of BGA for use by
 
\change_inserted -1837876828 1342198480
non-academic (?) 
\change_unchanged
practitioners.
 Limitations, of course, accompany this first implementation.
 
\change_inserted -1837876828 1342198531
For example, 
\change_deleted -1837876828 1342198640
V
\change_inserted -1837876828 1342198640
v
\change_unchanged
ersion 1.0 does not have an explicit parallelization facility.
 This can be overcome by using external programs for derivatives and calling
 a parallel Jacobian calculation package such a BeoPEST 
\begin_inset CommandInset citation
LatexCommand citep
key "beoPEST"

\end_inset

 or GENIE 
\begin_inset CommandInset citation
LatexCommand citep
key "GENIE"

\end_inset

 whenever a Jacobian matrix is required.
 The impact of this 
\change_inserted -1837876828 1342198565
workaround 
\change_unchanged
is on the run times required to obtain a solution.
\end_layout

\begin_layout Standard
A practical upper limit on the number of parameters estimated is on the
 order of 100,000.
 To estimate a larger number of parameters, machines with a large amount
 of random access memory (RAM) must be used.
 At some greater limit, methods such as periodic embedding or other decompositio
ns must be incorporated to mitigate the expense of storing and calculating
 the prior covariance matrix.
\end_layout

\begin_layout Standard
The source code is written in Fortran
\change_deleted -1837876828 1342198580
-
\change_inserted -1837876828 1342198580
 
\change_unchanged
90 and should be compilable on any platform with a Fortran compiler.
 Special care was taken to avoid obscure and nonstandard language features.
 Nonetheless, it is possible that some platform- or compiler-specific problems
 may be encountered.
\end_layout

\begin_layout Standard
It is possible to use bgaPEST with a small number of parameters, but the
 assumption from the start is that parameters in at least part of the spatio
\change_deleted -1837876828 1342551059
-
\change_unchanged
temporal domain represent a field of correlated instances (
\change_deleted -1837876828 1342198603
e.g.
\change_inserted -1837876828 1342198604
for example,
\change_unchanged
 model nodes
\change_deleted -1837876828 1342198610
,
\change_inserted -1837876828 1342198611
 or
\change_unchanged
 discrete times) that often outnumber the number of data observations.
 A combination of homogeneous parameters in zones with a refined area of
 interest that is distributed is a common application and, as implemented
 through beta associations, this mix of distributed and zoned parameters
 is supported and encouraged.
 Typically, sufficient data to support a distributed parameter set is limited
 to part of a model domain in space or time.
\end_layout

\begin_layout Standard
In considering uncertainty, version 1.0 presents posterior covariance values.
 For some applications, conditional realizations may be desired to capture
 candidate roughness of solutions within the ensemble distribution of solutions.
 Details for conditional realizations are provided by 
\begin_inset CommandInset citation
LatexCommand citet
key "Kitanidis1995"

\end_inset

.
\end_layout

\begin_layout Section
References Cited
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
bibliographystyle{usgs}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
bibliography{GW}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Section
Appendix 
\begin_inset CommandInset label
LatexCommand label
name "sec:Input-Instructions"

\end_inset

Input Instructions
\end_layout

\begin_layout Standard
In this appendix, the general strategy for input instructions is described.
 The input is arranged in a file called 
\family typewriter

\begin_inset Formula $<$
\end_inset

casename
\begin_inset Formula $>$
\end_inset

.bgp
\family default
, which is made up of input blocks, as discussed below.
 Following a discussion of more detail of the general input protocols, subsectio
ns 
\change_inserted -1837876828 1342201293
are presented 
\change_unchanged
in which specific input blocks are discussed
\change_inserted -1837876828 1342201300
,
\change_unchanged
 including variables and data that can be 
\change_deleted -1837876828 1342551417
input in them
\change_inserted -1837876828 1342551419
inserted
\change_unchanged
 
\change_deleted -1837876828 1342201290
are presented
\change_unchanged
.
\end_layout

\begin_layout Subsection
General Structure of Input
\end_layout

\begin_layout Standard
The general input structure is designed on a subset of the JUPITER protocol
 
\begin_inset CommandInset citation
LatexCommand citep
key "BantaEtAl2006"

\end_inset

.
 The advantage of this protocol over XML or the previous input format for
 PEST is that annotations that are easily read by humans are part of the
 input protocol.
 The full JUPITER protocol, however, has memory and computational overhead
 that can become a problem for large and complicated data
\change_deleted -1837876828 1342201336
 
\change_unchanged
sets.
 The protocol used here, therefore, is simplified but should be easily recogniza
ble to users of other JUPITER-compatible programs.
\end_layout

\begin_layout Standard
The strategy for input is designed to use 
\family typewriter
BLOCKS
\family default
 that are made up of either 
\family typewriter
KEYWORDS
\family default
 for individual variables or 
\family typewriter
TABLES
\family default
 for a series of data.
 The specification of whether a given block uses 
\family typewriter
KEYWORDS
\family default
 or 
\family typewriter
TABLES
\family default
 is pre
\change_deleted -1837876828 1342201364
ordained
\change_inserted -1837876828 1342201366
determined,
\change_unchanged
 and the input blocks defined below indicate which is required.
\end_layout

\begin_layout Subsubsection
Blocks
\end_layout

\begin_layout Standard
Input 
\change_deleted -1837876828 1342201374
B
\change_inserted -1837876828 1342201374
b
\change_unchanged
locks are allowed to take one of two forms: either 
\family typewriter
KEYWORDS 
\family default
or
\family typewriter
 TABLES
\family default
.
 All input blocks are delineated by the words 
\family typewriter
BEGIN
\family default
 and 
\family typewriter
END
\family default
.
 The header line also includes the name and type of the block
\change_inserted -1837876828 1342201389
,
\change_unchanged
 and the final line contains the name of the block.
 For example
\change_inserted -1837876828 1342551437
,
\change_deleted -1837876828 1342551436
:
\change_unchanged

\end_layout

\begin_layout Standard

\family typewriter
BEGIN prior_mean_cv KEYWORDS
\family default

\begin_inset space ~
\end_inset


\begin_inset Newline newline
\end_inset

 
\family typewriter
prior_betas=1
\family default

\begin_inset space ~
\end_inset


\begin_inset Newline newline
\end_inset

 
\family typewriter
beta_cov_form = 0
\family default

\begin_inset space ~
\end_inset


\begin_inset Newline newline
\end_inset

 
\family typewriter
END prior_mean_cv
\end_layout

\begin_layout Subsubsection
Keywords
\end_layout

\begin_layout Standard
Keyword variables correspond to single values identifie
\change_deleted -1837876828 1342201400
s
\change_inserted -1837876828 1342201400
d
\change_unchanged
 with an 
\begin_inset Quotes eld
\end_inset

=
\begin_inset Quotes erd
\end_inset

 sign.
 Multiple 
\family typewriter
KEYWORDS
\family default
 can be entered on each line in an input file
\change_inserted -1837876828 1342201409
,
\change_unchanged
 but no spaces are allowed in 
\family typewriter
KEYWORDS
\family default
 names or variable values.
 An example is
\change_deleted -1837876828 1342551443
:
\change_unchanged
 
\family typewriter
prior_betas=1.
\end_layout

\begin_layout Subsubsection
Tables
\end_layout

\begin_layout Standard
Table variables are used for tabular data series that have multiple values
 in categories.
 Tables are identified by listing the number of rows (
\family typewriter
nrow
\family default
)
\change_deleted -1837876828 1342201435
,
\change_inserted -1837876828 1342201436
 and
\change_unchanged
 number of columns (
\family typewriter
ncol
\family default
)
\change_deleted -1837876828 1342201440
,
\change_unchanged
 and 
\change_inserted -1837876828 1342201443
by 
\change_unchanged
providing the keyword 
\family typewriter
columnlabels
\family default
.
 This is followed by 
\family typewriter
nrow
\family default
 rows of data, with values arranged in 
\family typewriter
ncol
\family default
 columns
\change_deleted -1837876828 1342201478
,
\change_unchanged
 corresponding to the same order as the 
\family typewriter
columnlabels
\change_deleted -1837876828 1342201481

\family default
,
\change_unchanged
 and delimited by one or more spaces.
 For example
\change_inserted -1837876828 1342551449
,
\change_deleted -1837876828 1342551448
:
\change_unchanged

\end_layout

\begin_layout Standard

\family typewriter
BEGIN Q_compression_cv TABLE
\family default

\begin_inset space ~
\end_inset


\begin_inset Newline newline
\end_inset

 
\family typewriter
nrow=2 ncol=5 columnlabels 
\family default

\begin_inset space ~
\end_inset


\begin_inset Newline newline
\end_inset

 
\family typewriter
BetaAssoc Toep_flag Nrow Ncol Nlay 
\family default

\begin_inset space ~
\end_inset


\begin_inset Newline newline
\end_inset

 
\family typewriter
1 0 21 21 1 
\family default

\begin_inset space ~
\end_inset


\begin_inset Newline newline
\end_inset

 
\family typewriter
2 1 21 21 1 
\family default

\begin_inset space ~
\end_inset


\begin_inset Newline newline
\end_inset

 
\family typewriter
END Q_compression_cv
\end_layout

\begin_layout Subsubsection
Files 
\end_layout

\begin_layout Standard
A user may want to shorten the length of the main input file by reading
 certain input from external text files.
 This can be done by signaling an input block with the word 
\family typewriter
FILES
\family default
, to read a file containing the entire set of information for the block.
 Regardless of whether the external text file contains a 
\family typewriter
KEYWORDS
\family default
 or 
\family typewriter
TABLE
\family default
 block, a block definition must be in place directing the program to the
 external file.
 For example
\change_inserted -1837876828 1342551454
,
\change_deleted -1837876828 1342551453
:
\change_unchanged

\end_layout

\begin_layout Standard

\family typewriter
BEGIN Q_compression_cv FILE 
\family default

\begin_inset space ~
\end_inset


\begin_inset Newline newline
\end_inset

 
\family typewriter
compression.txt
\family default

\begin_inset space ~
\end_inset


\begin_inset Newline newline
\end_inset

 
\family typewriter
END Q_compression_cv
\end_layout

\begin_layout Standard
In this example, the contents of the file compression.txt would be
\change_deleted -1837876828 1342551458
:
\change_unchanged

\end_layout

\begin_layout Standard

\family typewriter
BEGIN Q_compression_cv TABLE 
\family default

\begin_inset space ~
\end_inset


\begin_inset Newline newline
\end_inset

 
\family typewriter
nrow=2 ncol=5 columnlabels 
\family default

\begin_inset space ~
\end_inset


\begin_inset Newline newline
\end_inset

 
\family typewriter
BetaAssoc Toep_flag Nrow Ncol Nlay 
\family default

\begin_inset space ~
\end_inset


\begin_inset Newline newline
\end_inset

 
\family typewriter
1 0 21 21 1 
\family default

\begin_inset space ~
\end_inset


\begin_inset Newline newline
\end_inset

 
\family typewriter
2 1 21 21 1 
\family default

\begin_inset space ~
\end_inset


\begin_inset Newline newline
\end_inset

 
\family typewriter
END Q_compression_cv
\end_layout

\begin_layout Subsection
bgaPEST Input Blocks
\end_layout

\begin_layout Standard
The specific input blocks used in bgaPEST are discussed, in order of appearance
 in the 
\family typewriter

\begin_inset Formula $<$
\end_inset

casename
\begin_inset Formula $>$
\end_inset

.bgp
\family default
 file.
 
\change_deleted -1837876828 1342201551
T
\change_inserted -1837876828 1342201558
It is important to maintain t
\change_unchanged
he order of the blocks 
\change_deleted -1837876828 1342201547
is important to maintain 
\change_unchanged
in the 
\change_inserted -1837876828 1342201564
same 
\change_unchanged
order 
\change_inserted -1837876828 1342201567
as 
\change_unchanged
discussed in this report.
 For each block, data types are identified either as 
\emph on
float
\emph default
, 
\emph on
integer
\emph default
, or 
\emph on
string
\emph default
.
 Values entered as 
\emph on
float
\emph default
 can include scientific/engineering notation, but in all cases should contain
 a 
\begin_inset Quotes eld
\end_inset

.
\begin_inset Quotes erd
\end_inset

 even if no fractional detail is included.
 Conversely, 
\emph on
integers
\emph default
 must not contain 
\begin_inset Quotes eld
\end_inset

.
\begin_inset Quotes erd
\end_inset

.
 Variables identified as 
\emph on
string
\emph default
 may not include spaces because whitespace is used as the delimiter for
 rows in tables and separating keywords.
\end_layout

\begin_layout Standard
Each block is also defined with a suffix of 
\begin_inset Quotes eld
\end_inset

cv
\begin_inset Quotes erd
\end_inset

 for 
\begin_inset Quotes eld
\end_inset

control variables,
\begin_inset Quotes erd
\end_inset

 or 
\begin_inset Quotes eld
\end_inset

data
\begin_inset Quotes erd
\end_inset

 for data.
 Control variables are those that govern the behavior of the algorithm as
 a whole
\change_inserted -1837876828 1342201599
,
\change_unchanged
 as opposed to data points (such as parameter values, structural parameter
 values, 
\change_deleted -1837876828 1342201604
etc.
\change_inserted -1837876828 1342201605
and so forth
\change_unchanged
).
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
fcolorbox{black}{ltgrey}{
\end_layout

\begin_layout Plain Layout


\backslash
begin{minipage}[t]{0.9
\backslash
columnwidth}
\end_layout

\begin_layout Plain Layout


\backslash
textbf{A note on default variable values}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

In the input instructions below, some variables list a default value.
\end_layout

\begin_layout Plain Layout

Part of the design strategy of this software was to not burden users
\end_layout

\begin_layout Plain Layout

with determining appropriate values for each and every variable that
\end_layout

\begin_layout Plain Layout

controls the algorithm.
 As a result, default values are provided for
\end_layout

\begin_layout Plain Layout

some variables.
 In those cases, input by the user in the 
\backslash
texttt{.bgp}
\end_layout

\begin_layout Plain Layout

file is optional.
 If no value is provided by the user, the default
\end_layout

\begin_layout Plain Layout

value will be used by bgaPEST.
 If a variable not listed with a default
\end_layout

\begin_layout Plain Layout

value in these input instructions is omitted by a user, bgaPEST will
\end_layout

\begin_layout Plain Layout

return with an error indicating that the variable is not present.%
\end_layout

\begin_layout Plain Layout


\backslash
end{minipage}}
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Algorithmic Control Variables 
\family typewriter
algorithmic_cv
\family default
 KEYWORDS
\end_layout

\begin_layout Standard
The following 
\family typewriter
KEYWORDS
\family default
 variables are in the 
\family typewriter
algorithmic_cv
\family default
 block.
 
\end_layout

\begin_layout Description

\family typewriter
structural_conv
\family default
 
\emph on
float,default=0.001
\emph default
 Convergence criterion for structural parameter convergence.
 If positive, convergence is based on the absolute difference in structural
 parameter objective function over consecutive iterations.
 If negative, convergence is based on the norm of the difference between
 consecutive structural parameter values.
 Used only if at least one structural parameter is to be estimated.
 
\end_layout

\begin_layout Description

\family typewriter
phi_conv
\family default
 
\emph on
float, default=0.001 
\emph default
Convergence criterion for objective function inner iterations.
 
\end_layout

\begin_layout Description

\family typewriter
bga_conv
\family default
 
\emph on
float, default=
\begin_inset Formula $10\times$
\end_inset


\family typewriter
\emph default
phi_conv
\family default
\emph on
 
\emph default
Convergence criterion for objective function outer iterations.
 
\end_layout

\begin_layout Description

\family typewriter
it_max_structural
\family default
 
\emph on
integer, default=10 
\emph default
Total number of iterations allowed in structural parameter optimization.
\end_layout

\begin_layout Description

\family typewriter
it_max_phi
\family default
 
\emph on
integer, default=10 
\emph default
Total number of iterations allowed in each quasi-linear estimation optimization.
\end_layout

\begin_layout Description

\family typewriter
it_max_bga
\family default
 
\emph on
integer, default=10 
\emph default
Total number of outer iterations allowed for the entire algorithm.
 
\end_layout

\begin_layout Description

\family typewriter
linesearch
\family default
 
\emph on
integer, default=0 
\emph default
Flag to determine whether a line search should be conducted
\change_inserted -1837876828 1342551478
:
\change_deleted -1837876828 1342551477
.

\change_unchanged
 [0] = do not use linesearch, [1] = use linesearch.
 
\end_layout

\begin_layout Description

\family typewriter
it_max_linesearch
\family default
 
\emph on
integer, default=4 
\emph default
Total number of outer iterations allowed for the line search.
 Used only if 
\family typewriter
linesearch
\family default
 = 1.
 
\end_layout

\begin_layout Description

\family typewriter
theta_cov_form
\family default
 
\emph on
integer, default=0
\emph default
 Form of the theta covariance matrix
\change_inserted -1837876828 1342551485
:
\change_deleted -1837876828 1342551485
.

\change_unchanged
 [0] = none, [1] = diagonal, [2] = full matrix.
 [0] means no prior covariance on theta provided
\change_inserted -1837876828 1342201678
,
\change_unchanged
 and it is assumed 
\change_inserted -1837876828 1342201682
to be 
\change_deleted -1837876828 1342551491
totally
\change_unchanged
 unknown
\change_inserted -1837876828 1342551496

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342551509
\begin_inset Quotes eld
\end_inset

Unknown
\begin_inset Quotes erd
\end_inset

 implies 
\begin_inset Quotes eld
\end_inset

totally.
\begin_inset Quotes erd
\end_inset


\change_unchanged

\end_layout

\end_inset


\change_unchanged
.
 Used only if at least one structural parameter is to be estimated.
 
\end_layout

\begin_layout Description

\family typewriter
Q_compression_flag
\family default
 
\emph on
integer, default=0 
\emph default
Flag to determine how to calculate 
\begin_inset Formula $Q_{0}$
\end_inset


\change_inserted -1837876828 1342551521
:
\change_unchanged
 [0] = no compression--calculate full 
\begin_inset Formula $Q_{0}$
\end_inset

 matrix, [1] = Calculate separate 
\begin_inset Formula $Q_{0}$
\end_inset

 matrix for each beta association.
 
\end_layout

\begin_layout Description

\family typewriter
par_anisotropy
\family default
 
\emph on
integer, default=0 
\emph default
Flag to determine whether parameter anisotropy should be considered when
 making the 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 matrix: [0] = do not consider anisotropy, [1]=consider anisotropy.
 If anisotropy is considered, a 
\family typewriter
parameter_anisotropy
\family default
 block should be included, as defined below.
 
\end_layout

\begin_layout Description

\family typewriter
deriv_mode
\family default
 
\emph on
integer, default=0 
\emph default
Flag to determine whether sensitivities are calculated 
\change_inserted -1837876828 1342201760
by 
\change_unchanged
using an external call to PEST or using a user-supplied program (such as
 adjoint state)
\change_inserted -1837876828 1342551531
:
\change_deleted -1837876828 1342551531
.

\change_unchanged
 [0] = use PEST, [1] = use external program identified below in the 
\family typewriter
model_command_lines
\family default
 block.
 
\end_layout

\begin_layout Description

\family typewriter
posterior_cov_flag
\family default
 
\emph on
integer, default=0 
\emph default
Flag to determine whether posterior covariance matrix should be calculated
\change_inserted -1837876828 1342551539
:
\change_deleted -1837876828 1342551538
.

\change_unchanged
 [0] = do not calculate posterior covariance matrix, [1] = calculate posterior
 covariance matrix.
 If 
\family typewriter
Q_compression_flag = 1
\family default
, only the diagonal of the posterior covariance matrix is calculated.
\end_layout

\begin_layout Description

\family typewriter
jacobian_file
\family default
 
\emph on
string, default=
\begin_inset Quotes eld
\end_inset

scratch.jco
\begin_inset Quotes erd
\end_inset

 
\emph default
Name of the file generated by an external program if 
\family typewriter
deriv_mode = 1
\family default
.
 If
\family typewriter
 deriv_mode = 0
\family default
, this value is ignored and left at its default value.
 
\end_layout

\begin_layout Description

\family typewriter
jacobian_format
\family default
 
\emph on
string, default=
\begin_inset Quotes eld
\end_inset

binary
\begin_inset Quotes erd
\end_inset

 
\emph default
Format of the file indicated in jacobian_file.
 [binary] indicates a binary file formatted as a JCO file from PEST, [ascii]
 indicates a file of a standard PEST matrix format, discussed below in this
 documentation.
 If
\family typewriter
 deriv_mode = 0
\family default
, this value is ignored and left at its default value.
 
\end_layout

\begin_layout Subsubsection
Prior Mean Control Variables 
\family typewriter
prior_mean_cv
\family default
 KEYWORDS
\end_layout

\begin_layout Standard
The following 
\family typewriter
KEYWORDS
\family default
 variables are in the 
\family typewriter
prior_mean_cv
\family default
 block.
 
\end_layout

\begin_layout Description

\family typewriter
prior_betas
\family default
 
\emph on
integer
\emph default
 Flag indicating whether information about prior mean 
\begin_inset Formula $\left(\beta\right)$
\end_inset

 will be supplied
\change_deleted -1837876828 1342551571
.
\change_inserted -1837876828 1342551571
:
\change_unchanged
 [0] = no, [1] = yes.
 
\end_layout

\begin_layout Description

\family typewriter
beta_cov_form
\family default
 
\emph on
integer, default=0 
\emph default
Form of the prior mean 
\begin_inset Formula $\left(\beta\right)$
\end_inset

 covariance matrix 
\begin_inset Formula $\left(\mathbf{Q}_{\beta\beta}\right)$
\end_inset


\change_deleted -1837876828 1342551576
.
\change_inserted -1837876828 1342551576
:
\change_unchanged
 [0] = none, [1] = diagonal, [2] = full matrix.
 This value is used only if
\family typewriter
 prior_betas = 1
\family default
.

\emph on
 
\emph default
 
\end_layout

\begin_layout Subsubsection
Beta Association Data 
\family typewriter
prior_mean_data
\family default
 TABLE
\end_layout

\begin_layout Standard
This table must contain the same number of rows as there are beta associations
 to be defined.
 The rows must be in ascending order of beta association numbers.
 This is also the block where beta associations are defined, even if prior
 means are not defined.
 
\end_layout

\begin_layout Description

\family typewriter
BetaAssoc
\family default
 
\emph on
integer 
\emph default
Identifier of each beta association (one per row).
 These should be sequential integers.
 
\end_layout

\begin_layout Description

\family typewriter
Partrans
\family default
 
\emph on
string 
\emph default
Transformation indicator determining whether 
\begin_inset Formula $\beta$
\end_inset

 values will be in physical or estimation space.
 Acceptable values are 
\family typewriter
log
\family default
 and 
\family typewriter
none
\family default
.
 
\end_layout

\begin_layout Description

\family typewriter
beta_0
\family default
 
\emph on
float
\emph default
 Value of prior mean value 
\begin_inset Formula $\left(\beta_{0}\right)$
\end_inset

 for the row's beta association.
 This value is used only if
\family typewriter
 prior_betas = 1
\family default
.
 
\end_layout

\begin_layout Description

\family typewriter
beta_cov_#
\family default
 
\emph on
float 
\emph default
The number of values provided is based on the value of 
\family typewriter
beta_cov_form
\family default
 specified above:
\end_layout

\begin_deeper
\begin_layout Description

\series medium
If
\series default
 
\family typewriter
beta_cov_form = 1
\family default
, one value is provided.
 
\end_layout

\begin_layout Description

\series medium
If
\series default
 
\family typewriter
beta_cov_form = 2
\family default
, 
\family typewriter
nrow
\family default
 values are provided, corresponding to the current row of the beta covariance
 matrix 
\begin_inset Formula $\left(\mathbf{Q}_{\beta\beta}\right)$
\end_inset

.
\begin_inset Newline newline
\end_inset

 This value is used only if
\family typewriter
 prior_betas = 1
\family default
.
 
\end_layout

\end_deeper
\begin_layout Subsubsection
Structural Parameter Control Variables 
\family typewriter
structural_parameter_cv
\family default
 TABLE
\end_layout

\begin_layout Standard
This table must contain the same number of rows as there are beta associations
 to be defined.
 The rows must be in ascending order of beta association numbers.
 
\end_layout

\begin_layout Description

\family typewriter
BetaAssoc
\family default
 
\emph on
integer 
\emph default
Identified for each beta association (one per row).
 These should be sequential integers.
 
\end_layout

\begin_layout Description

\family typewriter
prior_cov_mode
\family default
 
\emph on
integer, default = 1 
\emph default
Flag to indicate whether prior covariance of parameters 
\begin_inset Formula $\left(\mathbf{Q}_{\mathbf{ss}}\right)$
\end_inset

 is supplied or calculated.
 This is reserved for future use
\change_deleted -1837876828 1342201888
 - 
\change_inserted -1837876828 1342201888
.
 
\change_deleted -1837876828 1342201892
c
\change_inserted -1837876828 1342201892
C
\change_unchanged
urrently
\change_inserted -1837876828 1342201895
,
\change_unchanged
 
\begin_inset Formula $\mathbf{Q_{ss}}$
\end_inset

 is always calculated, so this value is ignored if present.
 
\end_layout

\begin_layout Description

\family typewriter
var_type
\family default
 
\emph on
integer, 
\shape italic
\emph default
default=1
\shape default
\emph on
 
\emph default
This is a flag to indicate which variogram type is used to express the prior
 covariance 
\begin_inset Formula $\left(\mathbf{Q}_{\mathbf{ss}}\right)$
\end_inset

.
 Acceptable choices are [0] = pure nugget, [1] = linear, [2] = exponential.
\end_layout

\begin_layout Description

\family typewriter
struct_par_opt
\family default
 
\emph on
integer, 
\shape italic
\emph default
default=1
\shape default
\emph on
 
\emph default
Flag for whether structural parameters are meant to be optimized or not.
 This can be chosen for each structural parameter individually
\change_deleted -1837876828 1342551598
.
\change_inserted -1837876828 1342551598
:
\change_unchanged
 [0] = do not optimize (hold at initial value), [1] = optimize 
\change_inserted -1837876828 1342201914
by 
\change_unchanged
using a marginal distribution.
 
\end_layout

\begin_layout Description

\family typewriter
trans_theta
\family default
 
\emph on
integer, 
\shape italic
\emph default
default=0
\shape default
\emph on
 
\emph default
Flag for whether a power transformation should be applied to the structural
 parameters in the current row
\change_deleted -1837876828 1342551604
.
\change_inserted -1837876828 1342551604
:
\change_unchanged
 [0] = do not transform, [1] = transform.
 This value is 
\change_inserted -1837876828 1342551628
used 
\change_unchanged
only 
\change_deleted -1837876828 1342551624
used
\change_unchanged
 
\change_deleted -1837876828 1342201933
of
\change_inserted -1837876828 1342201934
if
\change_unchanged
 
\family typewriter
struct_par_opt = 1
\family default
.
 
\end_layout

\begin_layout Description

\family typewriter
alpha_trans
\family default
 
\emph on
float, 
\shape italic
\emph default
default = 50
\shape default
 Exponent of the power transformation
\change_inserted -1837876828 1342551642
,
\change_unchanged
 used only if 
\family typewriter
trans_theta = 1
\family default
.
\end_layout

\begin_layout Subsubsection
Structural Parameter Data 
\family typewriter
structural_parameter_data
\family default
 TABLE
\end_layout

\begin_layout Standard
This table must contain the same number of rows as there are beta associations
 to be defined.
 The rows must be in ascending order of beta association numbers.
 
\end_layout

\begin_layout Description

\family typewriter
BetaAssoc
\family default
 
\emph on
integer 
\emph default
Identifier of each beta association (one per row).
 These should be sequential integers.
 
\end_layout

\begin_layout Description

\family typewriter
theta_0_1
\family default
 
\emph on
float 
\emph default
Initial value of 
\begin_inset Formula $\theta_{1,0}$
\end_inset


\change_deleted -1837876828 1342202250
 
\change_inserted -1837876828 1342202247
, 
\change_unchanged
which is the starting value of the first structural parameter for prior
 covariance.
 
\end_layout

\begin_layout Description

\family typewriter
theta_0_2
\family default
 
\emph on
float 
\emph default
Initial value of 
\begin_inset Formula $\theta_{2,0}$
\end_inset


\change_deleted -1837876828 1342202256
 
\change_inserted -1837876828 1342202254
, 
\change_unchanged
which is the starting value of the second structural parameter for prior
 covariance.
 If 
\change_deleted -1837876828 1342202269
using 
\change_unchanged
a linear or nugget variogram
\change_inserted -1837876828 1342202273
 is used
\change_unchanged
, an arbitrary negative value should be entered here indicating that the
 value will be ignored.
 For an exponential variogram, this parameter is the correlation length.
 
\end_layout

\begin_layout Subsubsection
Structural Parameter Covariance Data 
\family typewriter
structural_parameter_cov
\family default
 TABLE
\end_layout

\begin_layout Standard
The only covariance model currently supported is diagonal, so there must
 be one covariance value for each 
\begin_inset Formula $\theta$
\end_inset

 parameter.
 This block is 
\change_deleted -1837876828 1342202293
only
\change_unchanged
 read 
\change_inserted -1837876828 1342202296
only 
\change_unchanged
if 
\family typewriter
theta_cov_form
\family default
 is not zero.
 
\end_layout

\begin_layout Description

\family typewriter
theta_cov_1
\family default
 
\emph on
float 
\emph default
Variance of the current row's 
\begin_inset Formula $\theta$
\end_inset

 parameter.
 If 
\change_deleted -1837876828 1342202306
using
\change_unchanged
 an exponential variogram
\change_inserted -1837876828 1342202314
 is used
\change_unchanged
, then a single beta association will have two structural parameters.
 To handle this possibility, the variance values should be listed, one per
 line, in the order of beta associations, then in order
\change_inserted -1837876828 1342202332
 of
\change_unchanged
 
\begin_inset Formula $\theta_{1}$
\end_inset

 then 
\begin_inset Formula $\theta_{2}$
\end_inset

.
 Even structural parameters that will not be estimated (
\change_deleted -1837876828 1342202344
e.g.
\change_inserted -1837876828 1342202347
for example, those
\change_unchanged
 that are held at their initial values, as indicated by 
\family typewriter
struct_par_opt
\family default
 above
\change_deleted -1837876828 1342202356
,
\change_inserted -1837876828 1342202356
)
\change_unchanged
 must have a placeholder value entered here to maintain the order--the placehold
er value is arbitrary and will be ignored.
 
\end_layout

\begin_layout Subsubsection
Epistemic Error Term 
\family typewriter
epistemic_error_term
\family default
 KEYWORDS
\end_layout

\begin_layout Description

\family typewriter
sig_0
\family default
 
\emph on
float 
\emph default
Initial value of the epistemic error 
\begin_inset Formula $\left(\sigma_{o}\right)$
\end_inset

.
 
\end_layout

\begin_layout Description

\family typewriter
sig_opt
\family default
 
\emph on
integer 
\emph default
Flag indicating whether epistemic error should be optimized for or not
\change_deleted -1837876828 1342551664
.
\change_inserted -1837876828 1342551664
:
\change_unchanged
 [0] = do not optimize, [1] = optimize.
 If 
\family typewriter
sig_opt = 0
\family default
, then the value of 
\family typewriter
sig_0
\family default
 is used throughout the inversion.
 
\end_layout

\begin_layout Description

\family typewriter
sig_p_var
\family default
 
\emph on
float, 
\shape italic
\emph default
default=0
\shape default
\emph on
 
\emph default
Prior variance on 
\begin_inset Formula $\sigma$
\end_inset

.
 
\family typewriter
sig_p_var = 0
\family default
 means no prior variance on epistemic error is provided
\change_inserted -1837876828 1342202400
,
\change_unchanged
 and it is assumed
\change_inserted -1837876828 1342202406
 to be
\change_unchanged
 totally unknown.
 This value is used only if 
\family typewriter
sig_opt = 1
\family default
.
 
\end_layout

\begin_layout Description

\family typewriter
trans_sig
\family default
 
\emph on
integer, 
\shape italic
\emph default
default=0
\shape default
\emph on
 
\emph default
Flag for whether a power transformation should be applied to the epistemic
 error
\change_deleted -1837876828 1342551671
.
\change_inserted -1837876828 1342551671
:
\change_unchanged
 [0] = do not transform, [1] = transform.
 This value is used only if 
\family typewriter
sig_opt = 1.

\family default
 
\end_layout

\begin_layout Description

\family typewriter
alpha_trans
\family default
 
\emph on
float, 
\shape italic
\emph default
default = 50
\shape default
 Exponent of the power transformation, used only if 
\family typewriter
trans_sig = 1
\family default
.
\end_layout

\begin_layout Subsubsection
Parameter Control Variables 
\family typewriter
parameter_cv
\family default
 KEYWORDS
\end_layout

\begin_layout Description

\family typewriter
ndim
\family default
 
\emph on
integer
\emph default
 Number of dimensions over which the estimated parameters span.
 
\end_layout

\begin_layout Subsubsection
Prior Covariance Compression Control Variables 
\family typewriter
Q_compression_cv
\family default
 TABLE
\end_layout

\begin_layout Standard
This table must contain the same number of rows as there are beta associations
 to be defined.
 The rows must be in ascending order of beta association numbers.
 This block is 
\change_deleted -1837876828 1342202438
only
\change_unchanged
 read 
\change_inserted -1837876828 1342202441
only 
\change_unchanged
if 
\family typewriter
Q_compression_flag
\family default
 = 1.
 
\end_layout

\begin_layout Description

\family typewriter
BetaAssoc
\family default
 
\emph on
integer 
\emph default
Identified of each beta association (one per row).
 These typically are sequential integers.
 
\end_layout

\begin_layout Description

\family typewriter
Toep_flag
\family default
 
\emph on
integer
\emph default
 This is a flag to determine whether a Toeplitz transformation should be
 applied to the prior covariance matrix 
\begin_inset Formula $\mbox{\ensuremath{\left(\mathbf{Q_{ss}}\right)}}$
\end_inset


\change_deleted -1837876828 1342551681
.
\change_inserted -1837876828 1342551681
:
\change_unchanged
 [0] = do not use Toeplitz transformation, [1] = 
\change_deleted -1837876828 1342202458
do 
\change_unchanged
use Toeplitz transformation.
 
\end_layout

\begin_layout Description

\family typewriter
Nrow
\family default
 
\emph on
integer 
\emph default
Number of rows in the current beta association (
\change_deleted -1837876828 1342551699
only
\change_unchanged
 read 
\change_inserted -1837876828 1342551702
only 
\change_unchanged
if 
\family typewriter
Toep_flag = 1
\family default
).
 
\end_layout

\begin_layout Description

\family typewriter
Ncol
\family default
 
\emph on
integer 
\emph default
Number of columns in the current beta association (
\change_deleted -1837876828 1342551704
only
\change_unchanged
 read 
\change_inserted -1837876828 1342551707
only 
\change_unchanged
if 
\family typewriter
Toep_flag = 1
\family default
).
 
\end_layout

\begin_layout Description

\family typewriter
Nlay
\family default
 
\emph on
integer 
\emph default
Number of layers in the current beta association (
\change_deleted -1837876828 1342551710
only
\change_unchanged
 read 
\change_inserted -1837876828 1342551712
only 
\change_unchanged
if 
\family typewriter
Toep_flag = 1
\family default
).
 
\end_layout

\begin_layout Subsubsection
Parameter Groups 
\family typewriter
parameter_groups
\family default
 TABLE
\end_layout

\begin_layout Standard
Each row of this table corresponds to one of the parameter groups.
 These groups are used to group together parameters by type and are not
 the same as beta associations.
 
\end_layout

\begin_layout Description

\family typewriter
groupname
\family default
 
\emph on
string
\emph default
 Name of the group in the current row.
 Note that these cannot contain spaces.
 
\end_layout

\begin_layout Subsubsection
Parameter Data 
\family typewriter
parameter_data
\family default
 TABLE
\end_layout

\begin_layout Standard
Each row of this table provides information for one parameter.
 
\end_layout

\begin_layout Description

\family typewriter
ParamName
\family default
 
\emph on
string
\emph default
 Name for the parameter.
 
\end_layout

\begin_layout Description

\family typewriter
StartValue
\family default
 
\emph on
float 
\emph default
Star
\change_inserted -1837876828 1342202497
t
\change_unchanged
ing parameter value.
 
\end_layout

\begin_layout Description

\family typewriter
GroupName
\family default
 
\emph on
string
\emph default
 Name of the group to which the parameter belongs.
 This name must be defined in the 
\family typewriter
parameter_groups
\family default
 block.
 
\end_layout

\begin_layout Description

\family typewriter
BetaAssoc
\family default
 
\emph on
integer
\emph default
 Beta association to which this parameter belongs.
 
\end_layout

\begin_layout Description

\family typewriter
SenMethod
\family default
 
\emph on
integer
\emph default
 Sensitivity method used for this parameter type.
 This parameter may now be arbitrary--it is reserved for future use and
 currently is ignored.
 
\end_layout

\begin_layout Description

\family typewriter
x1
\family default
 
\emph on
float
\emph default
 Location in the first dimension.
 
\end_layout

\begin_layout Description

\family typewriter
x2
\family default
 
\emph on
float
\emph default
 Location in the second dimension.
 
\change_deleted -1837876828 1342202543
O
\change_inserted -1837876828 1342202548
Read o
\change_unchanged
nly 
\change_deleted -1837876828 1342202543
read
\change_unchanged
 if 
\family typewriter
ndim 
\begin_inset Formula $>$
\end_inset

= 2
\family default
.
 
\end_layout

\begin_layout Description

\family typewriter
x3
\family default
 
\emph on
float
\emph default
 Location in the third dimension.
 
\change_inserted -1837876828 1342202557
Read o
\change_deleted -1837876828 1342202557
O
\change_unchanged
nly 
\change_deleted -1837876828 1342202560
read
\change_unchanged
 if 
\family typewriter
ndim = 3
\family default
.
 
\end_layout

\begin_layout Subsubsection
Observation Groups 
\family typewriter
observation_groups
\family default
 TABLE
\end_layout

\begin_layout Standard
Each row of this table corresponds to one of the observation groups.
 These groups are used to group together observations by type and are used
 to report portions of the objective function.
 
\end_layout

\begin_layout Description

\family typewriter
groupname
\family default
 
\emph on
string
\emph default
 Name of the group in the current row.
 Note that these cannot contain spaces.
 
\end_layout

\begin_layout Subsubsection
Observation Data 
\family typewriter
observation_data
\family default
 TABLE
\end_layout

\begin_layout Standard
One observation is presented on each line.
 
\end_layout

\begin_layout Description

\family typewriter
ObsName
\family default
 
\emph on
string
\emph default
 Name of an observation.
 
\end_layout

\begin_layout Description

\family typewriter
ObsValue
\family default
 
\emph on
float
\emph default
 Value of the observation.
 
\end_layout

\begin_layout Description

\family typewriter
GroupName
\family default
 
\emph on
string
\emph default
 Name of the group to which the observation belongs.
 This name must be defined in the 
\family typewriter
observation_groups
\family default
 block.
 
\end_layout

\begin_layout Description

\family typewriter
Weight
\family default
 
\emph on
float
\emph default
 A relative weight that gets applied to the epistemic error.
 
\end_layout

\begin_layout Subsubsection
Model Command Lines 
\family typewriter
model_command_lines
\family default
 KEYWORDS
\end_layout

\begin_layout Standard
Currently
\change_inserted -1837876828 1342202611
,
\change_unchanged
 a single forward model command and an option derivative model command can
 be supplied here.
 These string keywords can include path information if the command line
 batch files or shell scripts are not located in the current working directory,
 but spaces are not allowed.
 
\end_layout

\begin_layout Description

\family typewriter
Command
\family default
 
\emph on
string
\emph default
 This is the batch file or shell script that runs the forward model.
 
\end_layout

\begin_layout Description

\family typewriter
DerivCommand
\family default
 
\emph on
string
\emph default
 This is the optional batch file or shell script that is used to calculate
 derivatives.
 This is 
\change_deleted -1837876828 1342202633
only
\change_unchanged
 used 
\change_inserted -1837876828 1342202636
only 
\change_unchanged
if 
\family typewriter
deriv_method = 1
\family default
 in the 
\family typewriter
algorithmic_cv
\family default
 block.
 
\end_layout

\begin_layout Subsubsection
Model Input Files 
\family typewriter
model_input_files
\family default
 TABLE
\end_layout

\begin_layout Standard
Each row of this table includes a matched template file and model input
 file.
 This allows the program to create the correct input files for the model.
 
\end_layout

\begin_layout Description

\family typewriter
TemplateFile
\family default
 
\emph on
string
\emph default
 Name of a template file for making model input.
 Must end in 
\family typewriter
.tpl
\family default
.
 
\end_layout

\begin_layout Description

\family typewriter
ModInFile
\family default
 
\emph on
string
\emph default
 Name of the model input file corresponding to the TemplateFile identified
 on the same row.
 
\end_layout

\begin_layout Subsubsection
Model Output Files 
\family typewriter
model_output_files
\family default
 TABLE
\end_layout

\begin_layout Standard
Each row of this table includes a matched instruction file and model output
 file.
 This allows the program to read the results of model runs correctly.
 
\end_layout

\begin_layout Description

\family typewriter
InstructionFile
\family default
 
\emph on
string
\emph default
 Name of an instruction file for reading model output.
 Must end in 
\family typewriter
.ins
\family default
.
 
\end_layout

\begin_layout Description

\family typewriter
ModOutFile
\family default
 
\emph on
string
\emph default
 Name of the model output file corresponding to the InstructionFile identified
 on the same row.
 
\end_layout

\begin_layout Subsubsection
Parameter Anisotropy 
\family typewriter
parameter_anisotropy
\family default
 TABLE
\end_layout

\begin_layout Standard
Each row of this table contains information for parameter anisotropy for
 a beta association.
 This block is read only if the variable 
\family typewriter
par_anisotropy
\family default
 =1 in the 
\family typewriter
algorithmic_cv
\family default
 block.
 
\end_layout

\begin_layout Description

\family typewriter
BetaAssoc
\family default
 
\emph on
integer
\emph default
 Identifier of a beta association.
 
\end_layout

\begin_layout Description

\family typewriter
horiz_angle
\family default
 
\emph on
float 
\emph default
Angle, in degrees of the principal direction of anisotropy in a horizontal
 plane.
 See 
\change_deleted -1837876828 1342551743
F
\change_inserted -1837876828 1342551743
f
\change_unchanged
igure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:anisotropy"

\end_inset

 for details.
 
\end_layout

\begin_layout Description

\family typewriter
horiz_ratio
\family default
 
\emph on
float 
\emph default
Ratio of maximum to minimum principal property values in the horizontal
 plane.
 See 
\change_deleted -1837876828 1342551745
F
\change_inserted -1837876828 1342551745
f
\change_unchanged
igure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:anisotropy"

\end_inset

 for details.
 
\end_layout

\begin_layout Description

\family typewriter
vertical_ratio
\family default
 
\emph on
float 
\emph default
Ratio of maximum to minimum principal property values in the vertical direction.
 See 
\change_deleted -1837876828 1342551747
F
\change_inserted -1837876828 1342551747
f
\change_unchanged
igure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:anisotropy"

\end_inset

 for details.
 This value is 
\change_deleted -1837876828 1342551755
only
\change_unchanged
 read 
\change_inserted -1837876828 1342551757
only 
\change_unchanged
if 
\family typewriter
ndim=3
\family default
.
 
\end_layout

\begin_layout Subsection
PEST Matrix Formats for Jacobian and Posterior Covariance
\end_layout

\begin_layout Standard
On two occasions in 
\family typewriter
bgaPEST
\change_deleted -1837876828 1342203754

\family default
 
\change_inserted -1837876828 1342203752
, 
\change_unchanged
a matrix text file format from 
\family typewriter
PEST
\change_inserted -1837876828 1342613432

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342613463
Note 14
\change_unchanged

\end_layout

\end_inset


\change_unchanged

\family default
 is used to store matrices: when posterior covariance output from 
\family typewriter
bgaPEST
\family default
 is specified as a full matrix; and when Jacobian sensitivity matrix information
 is exchanged from an external code with 
\family typewriter
bgaPEST
\family default
 run through, for example, a Python script.
\end_layout

\begin_layout Standard
The posterior covariance matrix may take two forms: a full matrix
\change_deleted -1837876828 1342203780
;
\change_unchanged
 or a diagonal matrix.
 These options are discussed below.
 Two options are available for Jacobian sensitivity matrices 
\begin_inset Formula $\left(\mathbf{H}\right)$
\end_inset

 to be read by 
\family typewriter
bgaPEST
\family default
.
 If 
\family typewriter
deriv_mode=0
\family default
, 
\family typewriter
PEST
\family default
 is used, external to 
\family typewriter
bgaPEST
\family default
, to calculate the Jacobian matrix resulting in a binary file with the extension
 
\family typewriter
.jco
\family default
.
 If 
\family typewriter
deriv_mode=
\family default
1 then an external program is used to calculate 
\begin_inset Formula $\mathbf{H}$
\end_inset


\change_deleted -1837876828 1342203808
 
\change_inserted -1837876828 1342203806
, 
\change_unchanged
and a file written by the external program must be communicated to 
\family typewriter
bgaPEST
\family default
.
 This file can either be a 
\family typewriter
.jco
\family default
 file or a 
\family typewriter
.jac
\family default
 file
\change_inserted -1837876828 1342203818
,
\change_unchanged
 which is an ASCII file following the format of a standard matrix file used
 by 
\family typewriter
PEST
\family default
, as described in 
\begin_inset CommandInset citation
LatexCommand citet
key "PESTAdd"

\end_inset

, 
\change_deleted -1837876828 1342203832
S
\change_inserted -1837876828 1342203832
s
\change_unchanged
ection 4.4.3.
 An example and description of the format of a standard 
\family typewriter
PEST
\family default
 matrix follow, quoting from 
\begin_inset CommandInset citation
LatexCommand citet
key "PESTAdd"

\end_inset

.
\change_inserted -1837876828 1342614562

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342614566
Note 15
\change_unchanged

\end_layout

\end_inset


\change_unchanged

\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:matrix"

\end_inset

 depicts an example matrix file holding a matrix with three rows and four
 columns.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/standard_PEST_matrix.pdf
	scale 25

\end_inset

 
\begin_inset Caption

\begin_layout Plain Layout
Example of a standard 
\family typewriter
PEST
\family default
 matrix file, adapted from 
\begin_inset CommandInset citation
LatexCommand citet
key "PESTAdd"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset CommandInset label
LatexCommand label
name "fig:matrix"

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The first line of a matrix file contains 3 integers.
 The first two indicate the number of rows (
\family typewriter
NROW
\family default
) and number of columns (
\family typewriter
NCOL
\family default
) in the following matrix.
 The next integer (named 
\family typewriter
ICODE
\family default
) is a code, the role of which will be discussed shortly.
 Following the header line is the matrix itself, in which entries are space-sepa
rated and wrapped to the next line if appropriate.
 The maximum line length is 500 characters, so wrapping to the next line
 must occur within 500 characters.
 It is recommended to wrap lines after 8 values and to maintain maximum
 possible precision.
\end_layout

\begin_layout Standard
In use for Jacobian matrices by 
\family typewriter
bgaPEST
\family default
, 
\family typewriter
ICODE
\family default
 is set to 2, so the string 
\begin_inset Quotes grd
\end_inset


\family typewriter
* row names
\family default
‚Äù is printed next, followed by 
\family typewriter
NROW
\family default
 names (of 20 characters or less in length), containing the names associated
 with rows of the matrix.
 
\family typewriter
NCOL
\family default
 column names follow in a similar format, following the string 
\begin_inset Quotes grd
\end_inset


\family typewriter
* column names
\family default
‚Äù.
\end_layout

\begin_layout Standard
Other options for 
\family typewriter
ICODE
\family default
 are described in 
\begin_inset CommandInset citation
LatexCommand citet
key "PESTAdd"

\end_inset

 and are used in 
\family typewriter
bgaPEST
\family default
 for output of the posterior covariance matrix.
 The two options for posterior covariance output both refer to square matri
\change_deleted -1837876828 1342203908
x
\change_inserted -1837876828 1342203908
c
\change_unchanged
es that have the same names of columns and rows.
 As a result, only one list of names follows the data following the string
 
\begin_inset Quotes grd
\end_inset


\family typewriter
* row and column names
\family default
‚Äù.
\end_layout

\begin_layout Standard
If compression is used in the prior covariance matrix, 
\family typewriter
bgaPEST
\family default
 
\change_deleted -1837876828 1342203945
only
\change_unchanged
 outputs 
\change_inserted -1837876828 1342203948
only 
\change_unchanged
the diagonal elements of the posterior covariance.
 In this case, 
\family typewriter
ICODE=-1
\family default
 and only the diagonal entries are listed, one per line, after the header
 line.
 If compression is not used, the entire posterior covariance matrix is printed
 using 
\family typewriter
ICODE=1
\family default
 with 8 values per line.
\end_layout

\begin_layout Subsection
References Cited
\end_layout

\begin_layout Section
Appendix 
\begin_inset CommandInset label
LatexCommand label
name "sec:quickstart"

\end_inset

Quick Start Instructions
\end_layout

\begin_layout Standard
One advantage of using block input and keywords, as discussed in 
\change_deleted -1837876828 1342195804
Appendix
\change_inserted -1837876828 1342195804
appendix
\change_unchanged
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Input-Instructions"

\end_inset

, is that default values are 
\change_deleted -1837876828 1342204005
provided
\change_inserted -1837876828 1342204009
supplied
\change_unchanged
 within bgaPEST so they can be skipped by a user.
 The values 
\change_deleted -1837876828 1342204015
provided
\change_inserted -1837876828 1342204016
supplied
\change_unchanged
 as defaults have general applicability and will all be reported in the
 
\family typewriter

\begin_inset Formula $<$
\end_inset

casename
\begin_inset Formula $>$
\end_inset

.bpr 
\family default
file.
 In this section, then, the bare minimum level of input is described to
 get a project running.
\end_layout

\begin_layout Paragraph*
Forward Model
\end_layout

\begin_layout Standard
The forward model must exist and have the ability--either inherently or
 through pre- and post
\change_deleted -1837876828 1342204041
-
\change_unchanged
processing--to receive input and provide output using text (
\change_deleted -1837876828 1342204049
ascii
\change_inserted -1837876828 1342204050
ASCII
\change_unchanged
) files.
 For bgaPEST to be able to run the model, template files (
\family typewriter
.TPL
\family default
) and instruction files (
\family typewriter
.INS
\family default
) must be provided
\change_inserted -1837876828 1342204065
,
\change_unchanged
 corresponding with model input and output, respectively.
 Details of the contruction of these files are in 
\begin_inset CommandInset citation
LatexCommand citep
after "chapter 3"
key "PEST"

\end_inset

.
 The template and instruction files are detailed in the 
\family typewriter
model_input_files
\family default
 and 
\family typewriter
model_output_files 
\family default
blocks, respectively.
 The 
\family typewriter
model_command_lines
\family default
 block must also be included with an entry for either a batch file or shell
 script in the 
\family typewriter
command
\family default
 keyword that runs the model.
\end_layout

\begin_layout Paragraph*
Observations
\end_layout

\begin_layout Standard
The 
\family typewriter
observation_groups
\family default
 block must be completed.
 All observations can belong to the same group if desired.
 Groups are reported in output to assist in interpretation of results.
 The 
\family typewriter
observation_data
\family default
 block 
\change_deleted -1837876828 1342204100
must
\change_unchanged
 also 
\change_inserted -1837876828 1342204105
must 
\change_unchanged
be completed.
\end_layout

\begin_layout Paragraph*
Beta Associations
\end_layout

\begin_layout Standard
Beta associations are first defined in the 
\family typewriter
prior_mean_data
\family default
 block.
 If no prior information about mean values and their covariance is to be
 supplied, the only information necessary is a row for each beta association
 in the 
\family typewriter
prior_mean_data
\family default
 block and a decision about whether to transform the value with a logarithmic
 transform
\change_deleted -1837876828 1342204186
 or not
\change_unchanged
.
 Note that beta associations indicate regions and groups that will have
 the same mean value estimated regardless of whether prior information about
 the mean is provided
\change_deleted -1837876828 1342204195
 or not
\change_unchanged
.
\change_inserted -1837876828 1342204201

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342614576
Note 16
\change_unchanged

\end_layout

\end_inset


\change_unchanged

\end_layout

\begin_layout Paragraph*
Structural Parameters
\end_layout

\begin_layout Standard
Each beta association must have a variogram specified for it, defined by
 structural parameters.
 Therefore, the 
\family typewriter
structural_parameters_cv
\family default
 and 
\family typewriter
structural_parameter_data
\family default
 blocks must be completed.
 Whether 
\change_deleted -1837876828 1342204294
or not
\change_unchanged
 to optimize for structural parameter values
\change_deleted -1837876828 1342204298
,
\change_unchanged
 and whether 
\change_deleted -1837876828 1342204303
or not 
\change_unchanged
to provide prior information about the values 
\change_deleted -1837876828 1342204309
is
\change_inserted -1837876828 1342204309
are
\change_unchanged
 optional.
\end_layout

\begin_layout Paragraph*
Parameters
\end_layout

\begin_layout Standard
The 
\family typewriter
parameter_groups
\family default
 block must be completed and, like with observations, it is acceptable for
 all parameters to be in a single group, and groups do not need to correspond
 with beta associations.
 The 
\family typewriter
parameter_cv
\family default
 keyword 
\family typewriter
ndim
\family default
 must be provided, and the 
\family typewriter
parameter_data
\family default
 block must be completed.
\end_layout

\begin_layout Paragraph*
Algorithmic Control Variables
\end_layout

\begin_layout Standard
The 
\family typewriter
algorithmic_cv
\family default
 block contains variables that all have default values
\change_deleted -1837876828 1342204376
.
 H
\change_inserted -1837876828 1342204377
; h
\change_unchanged
owever, bgaPEST must find the 
\family typewriter
algorithmic_cv
\family default
 block
\change_deleted -1837876828 1342204363
 - 
\change_inserted -1837876828 1342204364
--
\change_unchanged
even if it is empty.
 If the 
\family typewriter
algorithmic_cv
\family default
 block is empty, all default values will be used.
\end_layout

\begin_layout Paragraph*
Example .bgp Input File
\end_layout

\begin_layout Standard
The following text shows a bgaPEST input file.
 Two dependent files for parameters and observations are shown in abbreviated
 form to indicate their format.
 
\end_layout

\begin_layout Verse

\family typewriter
\begin_inset Newline newline
\end_inset


\family default
 
\end_layout

\begin_layout Standard

\series bold
Example1.bgp
\series default
 
\begin_inset Newline newline
\end_inset

 
\family typewriter
BEGIN algorithmic_cv KEYWORDS 
\begin_inset Newline newline
\end_inset

 structural_conv=0.004 phi_conv=0.004 
\begin_inset Newline newline
\end_inset

 bga_conv=1.0e-2 it_max_structural=10 
\begin_inset Newline newline
\end_inset

 it_max_phi=15 it_max_bga=15 
\begin_inset Newline newline
\end_inset

 linesearch=1 it_max_linesearch=3 
\begin_inset Newline newline
\end_inset

 theta_cov_form=1 Q_compression_flag=1 deriv_mode = 1 
\begin_inset Newline newline
\end_inset

 jacobian_format = ascii jacobian_file = S1_1.jac 
\begin_inset Newline newline
\end_inset

 posterior_cov_flag = 1 par_anisotropy=0 
\begin_inset Newline newline
\end_inset

 END algorithmic_cv 
\begin_inset Newline newline
\end_inset

 BEGIN prior_mean_cv KEYWORDS 
\begin_inset Newline newline
\end_inset

 prior_betas= 1 beta_cov_form=1 
\begin_inset Newline newline
\end_inset

 END prior_mean_cv 
\begin_inset Newline newline
\end_inset

 BEGIN prior_mean_data TABLE 
\begin_inset Newline newline
\end_inset

 nrow=1 ncol=7 columnlabels 
\begin_inset Newline newline
\end_inset

 BetaAssoc Partrans beta_0 beta_cov_1 beta_cov_2 beta_cov_3 beta_cov_4 
\begin_inset Newline newline
\end_inset

 1 log -7.6 5e-7 65.
 3.1 4.1 
\begin_inset Newline newline
\end_inset

 END prior_mean_data 
\begin_inset Newline newline
\end_inset

 BEGIN structural_parameter_cv TABLE 
\begin_inset Newline newline
\end_inset

 nrow=1 ncol=6 columnlabels 
\begin_inset Newline newline
\end_inset

 BetaAssoc prior_cov_mode var_type struct_par_opt trans_theta alpha_trans
 
\begin_inset Newline newline
\end_inset

 1 2 1 1 1 20 
\begin_inset Newline newline
\end_inset

 END structural_parameter_cv 
\begin_inset Newline newline
\end_inset

 BEGIN structural_parameters_data TABLE
\begin_inset Newline newline
\end_inset

 nrow=1 ncol=3 columnlabels 
\begin_inset Newline newline
\end_inset

 BetaAssoc theta_0_1 theta_0_2 
\begin_inset Newline newline
\end_inset

 1 1.0e-007 -0.1 
\begin_inset Newline newline
\end_inset

 END structural_parameters_data
\begin_inset Newline newline
\end_inset

 BEGIN structural_parameters_cov TABLE 
\begin_inset Newline newline
\end_inset

 nrow=1 ncol=1 columnlabels 
\begin_inset Newline newline
\end_inset

 theta_cov_1 
\begin_inset Newline newline
\end_inset

 11.1 
\begin_inset Newline newline
\end_inset

 END structural_parameters_cov
\begin_inset Newline newline
\end_inset

 BEGIN epistemic_error_term KEYWORDS 
\begin_inset Newline newline
\end_inset

 sig_0 = 1.000e-000 sig_opt = 0 sig_p_var=0.00001 
\begin_inset Newline newline
\end_inset

 END epistemic_error_term
\begin_inset Newline newline
\end_inset

 BEGIN parameter_cv KEYWORDS 
\begin_inset Newline newline
\end_inset

 ndim=3 
\begin_inset Newline newline
\end_inset

 END parameter_cv 
\begin_inset Newline newline
\end_inset

 BEGIN Q_compression_cv TABLE
\begin_inset Newline newline
\end_inset

 nrow=1 ncol=5 columnlabels 
\begin_inset Newline newline
\end_inset

 BetaAssoc Toep_flag Nrow Ncol Nlay 
\begin_inset Newline newline
\end_inset

 1 1 21 21 1 
\begin_inset Newline newline
\end_inset

 END Q_compression_cv
\begin_inset Newline newline
\end_inset

 BEGIN parameter_groups TABLE 
\begin_inset Newline newline
\end_inset

 nrow=1 ncol=2 columnlabels
\begin_inset Newline newline
\end_inset

 groupname grouptype 
\begin_inset Newline newline
\end_inset

 pargp_uno 1 
\begin_inset Newline newline
\end_inset

 END parameter_groups 
\begin_inset Newline newline
\end_inset

 BEGIN parameter_data FILES 
\begin_inset Newline newline
\end_inset

 PARAMETERS.txt 
\begin_inset Newline newline
\end_inset

 END parameter_data 
\begin_inset Newline newline
\end_inset

 BEGIN observation_groups TABLE 
\begin_inset Newline newline
\end_inset

 nrow=1 ncol=1 columnlabels
\begin_inset Newline newline
\end_inset

 groupname obsgp_oden 
\begin_inset Newline newline
\end_inset

 END observation_groups 
\begin_inset Newline newline
\end_inset

 BEGIN observation_data FILES 
\begin_inset Newline newline
\end_inset

 obs12.txt 
\begin_inset Newline newline
\end_inset

 END observation_data 
\begin_inset Newline newline
\end_inset

 BEGIN model_command_lines KEYWORDS 
\begin_inset Newline newline
\end_inset

 Command = modflow.bat 
\begin_inset Newline newline
\end_inset

 DerivCommand = modflow_adj.bat 
\begin_inset Newline newline
\end_inset

 END model_command_lines 
\begin_inset Newline newline
\end_inset

 BEGIN model_input_files TABLE 
\begin_inset Newline newline
\end_inset

 nrow=1 ncol=2 columnlabels 
\begin_inset Newline newline
\end_inset

 TemplateFile ModInFile 
\begin_inset Newline newline
\end_inset

 S1_mul.tpl S1_.mul 
\begin_inset Newline newline
\end_inset

 END model_input_files 
\begin_inset Newline newline
\end_inset

 BEGIN model_output_files TABLE
\begin_inset Newline newline
\end_inset

 nrow=1 ncol=2 columnlabels
\begin_inset Newline newline
\end_inset

 InstructionFile ModOutFile
\begin_inset Newline newline
\end_inset

 S1_1_hbs.ins S1_1.hbs 
\begin_inset Newline newline
\end_inset

 END model_output_files 
\begin_inset Newline newline
\end_inset

 BEGIN parameter_anisotropy TABLE
\begin_inset Newline newline
\end_inset

 nrow = 1 ncol = 4 columnlabels 
\begin_inset Newline newline
\end_inset

 BetaAssoc horiz_angle horiz_ratio vertical_ratio 
\begin_inset Newline newline
\end_inset

 1 45 10 10 
\begin_inset Newline newline
\end_inset

 END parameter_anisotropy
\family default
 
\begin_inset Newline newline
\end_inset

 
\series bold
PARAMETERS.txt
\series default
 
\begin_inset Newline newline
\end_inset

 
\family typewriter
BEGIN parameter_data 
\begin_inset Newline newline
\end_inset

 TABLE nrow=441 ncol=8 columnlabels 
\begin_inset Newline newline
\end_inset

 ParamName StartValue GroupName BetaAssoc SenMethod x1 x2 x3 
\begin_inset Newline newline
\end_inset

 P1 2.000000000000000E-04 pargp_uno 1 1 1.0000E+00 1.000E+000.00E+00 
\begin_inset Newline newline
\end_inset

 P2 2.000000000000000E-04 pargp_uno 1 1 2.0000E+00 1.000E+000.00E+00 
\begin_inset Newline newline
\end_inset

 P3 2.000000000000000E-04 pargp_uno 1 1 3.0000E+00 1.000E+000.00E+00
\begin_inset Newline newline
\end_inset

 ...
\begin_inset Newline newline
\end_inset

 P440 2.000000000000000E-04 pargp_uno 1 1 2.0000E+01 2.100E+010.00E+00 
\begin_inset Newline newline
\end_inset

 P441 2.000000000000000E-04 pargp_uno 1 1 2.1000E+01 2.100E+010.00E+00 
\begin_inset Newline newline
\end_inset

 END parameter_data
\family default
 
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard

\series bold
obs12.txt
\series default
 
\begin_inset Newline newline
\end_inset

 
\family typewriter
BEGIN observation_data TABLE 
\begin_inset Newline newline
\end_inset

 nrow=12 ncol=4 columnlabels ObsName ObsValue GroupName Weight 
\begin_inset Newline newline
\end_inset

 P001T0000 33.8154 obsgp_oden 1.0 
\begin_inset Newline newline
\end_inset

 P002T0000 29.9383 obsgp_oden 1.0 
\begin_inset Newline newline
\end_inset

 P003T0000 28.4674 obsgp_oden 1.0 
\begin_inset Newline newline
\end_inset

 P004T0000 30.9286 obsgp_oden 1.0 
\begin_inset Newline newline
\end_inset

 P005T0000 24.7332 obsgp_oden 1.0 
\begin_inset Newline newline
\end_inset

 P006T0000 31.5769 obsgp_oden 1.0 
\begin_inset Newline newline
\end_inset

 P007T0000 27.3057 obsgp_oden 1.0 
\begin_inset Newline newline
\end_inset

 P008T0000 29.3834 obsgp_oden 1.0 
\begin_inset Newline newline
\end_inset

 P009T0000 27.8658 obsgp_oden 1.0 
\begin_inset Newline newline
\end_inset

 P010T0000 30.4177 obsgp_oden 1.0 
\begin_inset Newline newline
\end_inset

 P011T0000 28.5865 obsgp_oden 1.0 
\begin_inset Newline newline
\end_inset

 P012T0000 27.4403 obsgp_oden 1.0 
\family default
 
\begin_inset Newline newline
\end_inset

 
\family typewriter
END observation_data 
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Standard
Tables 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:variables1-1"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:variables1-2"

\end_inset

 summarize the input blocks and variables names, types, and default values.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement !t
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../Variables_for_documentation1.pdf
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:variables1-1"

\end_inset

Summary of input blocks with variables identified.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
placement !t
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../Variables_for_documentation2.pdf
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:variables1-2"

\end_inset

Summary of input blocks with variables identified (continued)
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
References Cited
\end_layout

\begin_layout Section
Appendix Details of the Method
\begin_inset CommandInset label
LatexCommand label
name "sec:methodologyDetails"

\end_inset


\end_layout

\begin_layout Standard
The Bayesian geostatistical approach is described in detail 
\change_deleted -1837876828 1342443886
in
\change_inserted -1837876828 1342443886
by
\change_unchanged
 
\begin_inset CommandInset citation
LatexCommand citet
key "KitanidisVomvoris1983,HoeksemaKitanidis1984a,Kitanidis1995,NowakCirpka2004"

\end_inset


\change_inserted -1837876828 1342443900
,
\change_unchanged
 among others.
 The mathematics are reviewed here.
\end_layout

\begin_layout Subsection
The Bayesian Geostatistical Approach
\end_layout

\begin_layout Standard
In the Bayesian geostatistical approach, the posterior pdf is calculated
 as 
\begin_inset Formula 
\begin{equation}
p(\mathbf{s|y})\propto\mathrm{\underbrace{\exp\left(\mathbf{-}\frac{1}{2}\left(\mathbf{y-h}(\mathbf{s})\right)^{T}\mathbf{R^{-1}\left(\mathbf{y-h}(\mathbf{s})\right)}\right)}_{L\left(\mathbf{y}|\mathbf{s}\right)}\underbrace{\exp\left(\mathbf{-}\frac{1}{2}(\mathbf{s-X\beta}^{*})^{T}\mathbf{G_{\mathbf{ss}}^{-1}}(\mathbf{s-X\beta^{*}})\right)}_{p\left(\mathbf{s}\right)}}\label{eq:BGA}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0 in where 
\series bold

\begin_inset Formula $\mathbf{s}$
\end_inset

 
\series default
is the 
\begin_inset Formula $m\times1$
\end_inset

 vector of parameter values at distributed spatial locations in the model,
 
\begin_inset Formula $\mathbf{X\beta^{*}}$
\end_inset

 is the prior mean, 
\begin_inset Formula $\mathbf{G_{ss}}$
\end_inset

 is the 
\begin_inset Formula $m\times m$
\end_inset

 prior covariance of 
\begin_inset Formula $\left(\mathbf{s}-\mathbf{X\beta^{*}}\right)$
\end_inset

, 
\begin_inset Formula $\mathbf{h\left(\mathbf{s}\right)}$
\end_inset

 is the 
\begin_inset Formula $n\times1$
\end_inset

 vector of modeled forecasts co
\change_deleted -1837876828 1342443956
l
\change_unchanged
located with observations 
\begin_inset Formula $\left(\mathbf{y}\right),$
\end_inset

 and 
\series bold

\begin_inset Formula $\mathbf{R}$
\end_inset

 
\series default
is the 
\begin_inset Formula $n\times n$
\end_inset

 epistemic uncertainty covariance, modeled as 
\begin_inset Formula $\sigma_{R}^{2}\mathbf{I}$
\end_inset

 where 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 represents epistemic uncertainty, and 
\begin_inset Formula $\mathbf{I}$
\end_inset

 is an 
\begin_inset Formula $n\times n$
\end_inset

 identity matrix.
 In general terms, the likelihood function 
\begin_inset Formula $\left(L\left(\mathbf{y}|\mathbf{s}\right)\right)$
\end_inset

 characterizes the misfit between model forecasts and observations
\change_inserted -1837876828 1342443997
,
\change_unchanged
 
\change_deleted -1837876828 1342443999
while
\change_inserted -1837876828 1342444000
whereas
\change_unchanged
 the prior pdf 
\begin_inset Formula $\left(p\left(\mathbf{s}\right)\right)$
\end_inset

 defines a characteristic (such as smoothness or continuity) that is assumed
 to apply to the parameter field.
 The prior pdf also serves the role of regularization.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0.25 in The best estimate of 
\begin_inset Formula $\mathbf{s}$
\end_inset

 maximizes the posterior pdf.
 A computationally efficient method to find the best estimates of 
\begin_inset Formula $\mathbf{s}$
\end_inset

 and 
\begin_inset Formula $\mathbf{\beta}$
\end_inset

 
\begin_inset Formula $\left(\hat{\mathbf{s}}\mbox{ and }\mathbf{\hat{\beta}}\mbox{, respectively}\right)$
\end_inset

 is through 
\begin_inset Formula 
\begin{equation}
\hat{\mathbf{s}}=\mathbf{X\hat{\beta}+Q_{ss}H^{\mathbf{T}}\xi}\label{eq:bestest}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0 in which is the superposition of the prior mean (first term) and an innovatio
n term 
\change_deleted -1837876828 1342444066
which
\change_inserted -1837876828 1342444066
that
\change_unchanged
 
\change_deleted -1837876828 1342444069
considers
\change_inserted -1837876828 1342444071
accounts for
\change_unchanged
 deviations of the predictions from the observations (second term).
 In this context, 
\begin_inset Formula $\beta$
\end_inset

 in the first term is not the prior mean
\change_deleted -1837876828 1342444080
,
\change_unchanged
 but is the best estimate of the mean (mapped onto the parameter field through
 the 
\begin_inset Formula $m\times p$
\end_inset

 
\begin_inset Formula $\mathbf{X}$
\end_inset

 matrix)
\change_inserted -1837876828 1342444088
,
\change_unchanged
 
\change_deleted -1837876828 1342444090
while
\change_inserted -1837876828 1342444091
whereas
\change_unchanged
 the second term is fluctuations about the estimated mean.
 
\begin_inset Formula $\mathbf{H}$
\end_inset

 in the second term (often referred to as the 
\begin_inset Formula $n\times m$
\end_inset

 Jacobian, sensitivity, or susceptibility matrix) is the sensitivity of
 observation values to parameter values 
\begin_inset Formula $\mbox{where }H_{ij}=\frac{\partial\mathbf{h}\left(\mathbf{s}\right)_{i}}{\partial\mathbf{s}_{j}}$
\end_inset

, which can be calculated 
\change_inserted -1837876828 1342444167
by 
\change_unchanged
using either finite
\change_inserted -1837876828 1342444174
-
\change_deleted -1837876828 1342444174
 
\change_unchanged
difference or adjoint-state methods.
 In bgaPEST, finite-difference calculations for 
\begin_inset Formula $\mathbf{H}$
\end_inset

 are 
\change_deleted -1837876828 1342444185
calculated
\change_inserted -1837876828 1342444193
made
\change_unchanged
 
\change_inserted -1837876828 1342444195
by 
\change_unchanged
using PEST
\change_inserted -1837876828 1342444207
,
\change_unchanged
 whereas adjoint-state calculations depend on the specific model being used
 and must be 
\change_deleted -1837876828 1342444215
calculated
\change_inserted -1837876828 1342444216
made by
\change_unchanged
 using an external program.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0.25 in
\end_layout

\begin_layout Standard
The values for 
\begin_inset Formula $\mathbf{\hat{\beta}}$
\end_inset

 and 
\begin_inset Formula $\mathbf{\xi}$
\end_inset

 are found by solving the 
\begin_inset Formula $(n+p)\times(n+p)$
\end_inset

 linear system of cokriging equations 
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{cc}
\mathbf{Q_{yy}} & \mathbf{HX}\\
\mathbf{X}^{T}\mathbf{H}^{T} & \mathbf{-}\mathbf{Q_{\beta\beta}^{-1}}
\end{array}\right]\left[\begin{array}{c}
\mathbf{\xi}\\
\mathbf{\hat{\beta}}
\end{array}\right]=\left[\begin{array}{c}
\mathbf{y}\\
\mathbf{-}\mathbf{Q_{\beta\beta}^{-1}}\beta^{*}
\end{array}\right]\label{eq:cokriging-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0 in where 
\begin_inset Formula $\mathbf{Q_{yy}}$
\end_inset

 is the 
\begin_inset Formula $n\times n$
\end_inset

 auto-covariance matrix of the observations, defined as 
\begin_inset Formula $\mathbf{HQ_{ss}H^{\mathbf{T}}+R}$
\end_inset

, 
\begin_inset Formula $n$
\end_inset

 is the number of observations, and 
\begin_inset Formula $p$
\end_inset

 is the number of beta associations.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0.25 in In hydrogeologic applications, the numerical forward model is typically
 nonlinear.
 Further nonlinearity can be induced by using a logarithmic transformation,
 which is a convenient way to enforce non-negativity on parameters and is
 often an appropriate transformation for hydraulic
\change_inserted -1837876828 1342444275
-
\change_deleted -1837876828 1342444274
 
\change_unchanged
conductivity parameters in groundwater models.
\end_layout

\begin_layout Standard
Provided that the nonlinearities introduced are not too extreme, a solution
 can be obtained through successive linearizations following the quasi-linear
 extension 
\begin_inset CommandInset citation
LatexCommand citep
key "Kitanidis1995"

\end_inset

.
 The forward model, 
\begin_inset Formula $\mathbf{h(s)}$
\end_inset

 is expanded about the current best estimate of the parameters 
\begin_inset Formula $\mathbf{\tilde{s}}$
\end_inset


\change_inserted -1837876828 1342699916
:
\change_unchanged
 
\begin_inset Formula 
\[
\mathbf{h}(\mathbf{s})\mathbf{\approx h}(\mathbf{\tilde{s}})\mathbf{+\tilde{H}}(\mathbf{s-\tilde{s}})
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0 in where 
\begin_inset Formula $\mathbf{\tilde{H}}$
\end_inset

, as a function of 
\begin_inset Formula $\mathbf{\tilde{s,}}$
\end_inset

 is evaluated at each linearization.
 We assign the subscript 
\begin_inset Formula $_{k}$
\end_inset

 to indicate iteration number
\change_deleted -1837876828 1342444302
,
\change_unchanged
 and correct the measurements for the 
\begin_inset Formula $k^{th}$
\end_inset

 
\change_inserted -1837876828 1342699941

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342699944
See note 12.
\change_unchanged

\end_layout

\end_inset


\change_unchanged
linearization as 
\begin_inset Formula 
\[
\mathbf{y}_{k}^{'}=\mathbf{y}-\mathbf{h}(\tilde{\mathbf{s}}_{k})+\tilde{\mathbf{H}}_{k}\tilde{\mathbf{s}}_{k}.
\]

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0.25 in Then the cokriging equations (
\change_deleted -1837876828 1342699984
E
\change_inserted -1837876828 1342699985
e
\change_unchanged
q
\change_deleted -1837876828 1342699991
uation
\change_inserted -1837876828 1342699991
.

\change_unchanged
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:cokriging-1"

\end_inset

) are updated
\change_inserted -1837876828 1342699995
:
\change_unchanged
 
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{cc}
\tilde{\mathbf{Q}}_{\mathbf{yy},k} & \tilde{\mathbf{H}}_{k}\mathbf{X}\\
\mathbf{X}^{T}\tilde{\mathbf{H}}_{k}^{T} & \mathbf{-}\mathbf{Q_{\beta\beta}^{-1}}
\end{array}\right]\left[\begin{array}{c}
\mathbf{\xi}_{k}\\
\hat{\mathbf{\beta}}_{k}
\end{array}\right]=\left[\begin{array}{c}
\mathbf{y}_{k}^{'}\\
\mathbf{-}\mathbf{Q_{\beta\beta}^{-1}}\beta^{*}
\end{array}\right]\label{eq:iterations-1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0 in where 
\begin_inset Formula $\tilde{\mathbf{Q}}_{\mathbf{yy},k}=\tilde{\mathbf{H}}_{k}\mathbf{Q_{ss}}\tilde{\mathbf{H}}_{k}^{T}+\mathbf{R}$
\end_inset

 .
 From this set of equations, the next estimate of 
\begin_inset Formula $\mathbf{s}$
\end_inset

 is 
\begin_inset Formula 
\[
\tilde{\mathbf{s}}_{k+1}=\mathbf{X\hat{\beta}}_{k}+\mathbf{Q_{ss}}\tilde{\mathbf{H}}_{k}^{T}\mathbf{\xi}_{k}.
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0.25 in This 
\change_inserted -1837876828 1342444356
process 
\change_unchanged
can be iterated until there is minimal difference in the parameter estimates
\change_deleted -1837876828 1342444374
,
\change_unchanged
 or 
\change_deleted -1837876828 1342444382
when there is 
\change_unchanged
minimal further improvement in the objective function.
 The objective function, which we seek to minimize, is 
\begin_inset Formula $\mathbf{-}\ln p\left(\mathbf{s|y}\right)$
\end_inset


\change_inserted -1837876828 1342444393
,
\change_unchanged
 which is equivalent to maximizing 
\change_deleted -1837876828 1342444397
E
\change_inserted -1837876828 1342444397
e
\change_unchanged
quation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:BGA"

\end_inset


\change_inserted -1837876828 1342700017
:
\change_unchanged
 
\begin_inset Formula 
\[
\Phi=\mathbf{-}\ln p\left(\mathbf{s|y}\right)=(\mathbf{s-X\beta}^{*})^{T}\mathbf{G_{\mathbf{ss}}^{-1}}(\mathbf{s-X\beta^{*}})+\left(\mathbf{y-h}(\mathbf{s})\right)^{T}\mathbf{R^{-1}\left(\mathbf{y-h}(\mathbf{s})\right)}
\]

\end_inset


\end_layout

\begin_layout Subsection
Line Search
\change_inserted -1837876828 1342616962

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342616969
Refer back to note 13
\change_unchanged

\end_layout

\end_inset


\change_unchanged

\end_layout

\begin_layout Standard
In some cases, numerical instability makes convergence difficult.
 A line search is implemented in which a linear search is performed between
 the most recent best estimate of the parameters 
\begin_inset Formula $\left(\mathbf{\hat{s}}\right)$
\end_inset

 and the current linearization of the parameters 
\begin_inset Formula $\left(\mathbf{\widetilde{\mathbf{s}}}\right)$
\end_inset

, seeking a parameter value that minimizes an objective function.
\end_layout

\begin_layout Standard
The linesearch optimizes a single parameter, 
\begin_inset Formula $\rho$
\end_inset

, along a linear dimension between 
\begin_inset Formula $\mathbf{\hat{s}}$
\end_inset

 and 
\begin_inset Formula $\mathbf{\widetilde{\mathbf{s}}}$
\end_inset

 as 
\begin_inset Formula 
\[
\mathbf{s}_{opt}=\mathbf{\mathbf{\hat{s}}}\rho+\mathbf{\widetilde{\mathbf{s}}}\left(1-\rho\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0 in where 
\begin_inset Formula $\mathbf{s}_{opt}$
\end_inset

 minimizes the objective function, 
\begin_inset Formula $\Phi,$
\end_inset

 using a Nelder-Mead simplex 
\begin_inset CommandInset citation
LatexCommand citep
before "see, e.g., "
key "Press1992"

\end_inset

, which guarantees monotonic decrease in 
\begin_inset Formula $\Phi$
\end_inset

 over successive iterations.
 It is recommended to limit the number of linesearch iterations to a relatively
 low number, 
\change_deleted -1837876828 1342444828
as
\change_inserted -1837876828 1342444724
 because
\change_unchanged
 the goal of handling weak linearity is balanced against the computations
 required to perform the line search.
 The greatest advantage is likely achieved in the first few (less than five)
 iterations.
 The role of the line search is not to find a minimum value of 
\begin_inset Formula $\Phi$
\end_inset


\change_inserted -1837876828 1342444762
,
\change_unchanged
 because the nonlinearity of the overall problem prevents it.
 Rather, the line search is meant to be a correction of search direction
 for stability.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0.25 in
\end_layout

\begin_layout Subsection
Parameter Field Anisotropy
\begin_inset CommandInset label
LatexCommand label
name "sub:anisotropy"

\end_inset


\end_layout

\begin_layout Standard
In distributed parameter fields, such as hydraulic conductivity in groundwater
 models, it is common to encounter anisotropy along an axis that may or
 not be aligned with the coordinate (x, y, z) axes.
 bgaPEST allows the definition of anisotropy in a horizontal plane at any
 angle from the x-axis and also in the vertical direction.
 The general layout of horizontal anisotropy is illustrated in 
\change_deleted -1837876828 1342444871
F
\change_inserted -1837876828 1342444871
f
\change_unchanged
igure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:anisotropy"

\end_inset

.
 The angle from the x-axis (specified in degrees) is defined by 
\family typewriter
horiz_angle
\change_inserted -1837876828 1342445229
,
\change_unchanged

\family default
 and the amount of anisotropy is defined by 
\family typewriter
horiz_ratio
\family default
.
 
\change_inserted -1837876828 1342445001

\family typewriter

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342614591

\family typewriter
Note 17
\change_unchanged

\end_layout

\end_inset


\change_unchanged
p_max
\family default
 refers to the direction with maximum parameter values
\change_inserted -1837876828 1342445189
,
\change_unchanged
 and 
\family typewriter
p_min
\family default
 refers to the direction of minimum parameter values.
 The ratio is used to adjust the effective distance (and thereby the covariance
 values) along that principal direction.
 The user supplies values for 
\family typewriter
horiz_angle
\family default
 and 
\family typewriter
horiz_ratio
\family default
 for each beta association.
 If some beta associations are not meant to exhibit anisotropy, the user
 may simply set 
\family typewriter
horiz_ratio=1.0
\family default
.
 If none of the beta associations exhibit anisotropy, the entire 
\family typewriter
parameter_anisotropy
\family default
 block can be eliminated by setting the algorithmic control variable 
\family typewriter
par_anisotropy=0
\change_inserted -1837876828 1342445219
,
\change_unchanged

\family default
 which means the block
\change_deleted -1837876828 1342445249
,
\change_unchanged
 
\change_inserted -1837876828 1342445251
(
\change_unchanged
if present
\change_inserted -1837876828 1342445255
)
\change_deleted -1837876828 1342445254
,
\change_unchanged
 is ignored.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/anisotropy.pdf

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:anisotropy"

\end_inset

Schematic diagram of 
\change_inserted -1837876828 1342445822
conventions defining 
\change_unchanged
horizontal anisotropy 
\change_deleted -1837876828 1342445831
defining conventions for
\change_inserted -1837876828 1342445831
in
\change_unchanged
 bgaPEST
\change_inserted -1837876828 1342445843

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342445848
Is this what you mean?
\change_unchanged

\end_layout

\end_inset


\change_deleted -1837876828 1342698960
.
 
\change_unchanged

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Anisotropy is introduced in the calculation of distances that are
\change_deleted -1837876828 1342445271
,
\change_unchanged
 then
\change_deleted -1837876828 1342445273
,
\change_unchanged
 used in the calculation of the prior covariance matrix 
\begin_inset Formula $\mathbf{Q_{ss}}$
\end_inset

 discussed below.
 
\change_deleted -1837876828 1342445307
For e
\change_inserted -1837876828 1342445307
E
\change_unchanged
very pair of points
\change_deleted -1837876828 1342445314
, they
\change_unchanged
 must first be rotated into the principal direction orientation.
 This is accomplished 
\change_deleted -1837876828 1342700043
using
\change_inserted -1837876828 1342700045
by means of
\change_unchanged
 a rotation matrix: 
\begin_inset Formula 
\[
\left[\begin{array}{c}
x_{rot,i}\\
y_{rot,i}
\end{array}\right]=\left[\begin{array}{cc}
\cos\theta & -\sin\theta\\
\sin\theta & \cos\theta
\end{array}\right]\left[\begin{array}{c}
x_{i}\\
y_{i}
\end{array}\right]
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0 in where 
\begin_inset Formula $i$
\end_inset

 indicates the 
\begin_inset Formula $i^{th}$
\end_inset

 
\change_inserted -1837876828 1342618958

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342618971
Refer back to note 12.
\change_unchanged

\end_layout

\end_inset


\change_unchanged
point of the pair 
\begin_inset Formula $\left(i=1,2\right)$
\end_inset

, 
\begin_inset Formula $\theta$
\end_inset

 is the angle (in degrees) specified by 
\family typewriter
horiz_angle
\family default
, 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

 are the point coordinates in the original coordinate system, and 
\begin_inset Formula $x_{rot}$
\end_inset

 and 
\begin_inset Formula $y_{rot}$
\end_inset

 
\change_deleted -1837876828 1342700058
are
\change_inserted -1837876828 1342700060
constitute
\change_unchanged
 the location projected into the coordinate system corresponding to the
 orientation of horizontal anisotropy.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0.25 in Once this projection is made, the horizontal distance is calculated
 as 
\begin_inset Formula 
\[
distance=\sqrt{\left(x_{rot,1}-x_{rot,2}\right)^{2}+\texttt{{horiz\_ratio}\ensuremath{\times}}\left(y_{rot,1}-y_{rot,2}\right)^{2}}
\]

\end_inset


\end_layout

\begin_layout Standard
For three-dimensional parameter fields, a second anisotropy ratio may be
 specified as 
\family typewriter
vertical_ratio
\family default
.
 In the vertical direction, no angle is specified, so the rotation step
 is not required and distance is calculated as 
\begin_inset Formula 
\[
distance=\sqrt{\begin{array}{c}
\left(x_{rot,1}-x_{rot,2}\right)^{2}\\
+\texttt{{horiz\_ratio}\ensuremath{\times}}\left(y_{rot,1}-y_{rot,2}\right)^{2}\\
+\texttt{{vertical\_ratio}\ensuremath{\times}}\left(z_{rot,1}-z_{rot,2}\right)^{2}
\end{array}}
\]

\end_inset


\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Prior-Probability-Density"

\end_inset

Prior Probability Density Function
\end_layout

\begin_layout Standard
The prior pdf of 
\series bold
s
\series default
 can be characterized as multi-Gaussian through its mean and covariance.
 The 
\begin_inset Formula $(m\times1)$
\end_inset

 unknown parameter vector, 
\begin_inset Formula $\mathbf{s}$
\end_inset

, is modeled as a random process with mean 
\begin_inset Formula 
\begin{equation}
E[\mathbf{s}]=\mathbf{X}\mathbf{\beta}\label{eq:Es}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0 in where 
\begin_inset Formula $E[\cdot]$
\end_inset

 indicates expected value, 
\begin_inset Formula $m$
\end_inset

 is the number of parameters, 
\begin_inset Formula $\mathbf{\beta}$
\end_inset

 is a 
\begin_inset Formula $(p\times1)$
\end_inset

 vector of drift coefficients, and 
\begin_inset Formula $\mathbf{X}$
\end_inset

 is an 
\begin_inset Formula $(m\times p)$
\end_inset

 matrix of base functions.
 In the absence of prior drift, the 
\begin_inset Formula $\mathbf{\beta}$
\end_inset

 
\change_deleted -1837876828 1342700076
are
\change_inserted -1837876828 1342700078
constitutes
\change_unchanged
 the beta association mean values
\change_inserted -1837876828 1342445957
,
\change_unchanged
 and 
\begin_inset Formula $\mathbf{X}$
\end_inset

 is a selection matrix mapping each value in 
\begin_inset Formula $\mathbf{s}$
\end_inset

 and 
\begin_inset Formula $\mathbf{\beta}$
\end_inset

 into 
\change_deleted -1837876828 1342445967
their
\change_inserted -1837876828 1342445967
its
\change_unchanged
 appropriate beta association.
 
\begin_inset Formula $\mathbf{X}$
\end_inset

 contains all zeros except for 
\series bold

\begin_inset Formula $\mathbf{X}_{ij}^{th}$
\end_inset


\series default
 element, which maps the 
\begin_inset Formula $i^{th}$
\end_inset

 parameter to the 
\begin_inset Formula $j^{th}$
\end_inset

 
\change_inserted -1837876828 1342619187

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342619194
Refer back to note 12.
\change_unchanged

\end_layout

\end_inset


\change_unchanged
beta association, 
\change_deleted -1837876828 1342446023
that
\change_inserted -1837876828 1342446024
which
\change_unchanged
 contains the value of 
\change_deleted -1837876828 1342445987
one
\change_inserted -1837876828 1342445987
1
\change_unchanged
.
 Subdivision into beta associations within distributed parameter domains
 
\change_deleted -1837876828 1342700086
have
\change_inserted -1837876828 1342700087
has
\change_unchanged
 been critical to success in hydrogeologic settings 
\change_deleted -1837876828 1342446045
which
\change_inserted -1837876828 1342446045
that
\change_unchanged
 include strong contrasts in parameter values indicative of geologic contacts
 
\change_deleted -1837876828 1342619412
[
\change_inserted -1837876828 1342619413
(
\change_unchanged
see
\change_inserted -1837876828 1342619424
,
\change_unchanged
 
\change_deleted -1837876828 1342619426
e.g.
\change_inserted -1837876828 1342619429
for example,
\change_unchanged
 
\begin_inset CommandInset citation
LatexCommand citealp
key "fienenEtal2004"

\end_inset


\change_inserted -1837876828 1342619441
,
\change_unchanged
 and 
\begin_inset CommandInset citation
LatexCommand citealp
key "FienenWRR2008"

\end_inset


\change_inserted -1837876828 1342619420
)
\change_deleted -1837876828 1342619420
]
\change_unchanged
.
 Prior drift is accounted for in 
\begin_inset Formula $\mathbf{X}$
\end_inset

 through trends expressed in the nonzero terms, although this is not currently
 implemented in bgaPEST.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0.25 in The prior covariance 
\begin_inset Formula $(\mathbf{Q_{ss}})$
\end_inset

 of 
\begin_inset Formula $\mathbf{s}$
\end_inset

 for a known 
\begin_inset Formula $\mathbf{\beta}$
\end_inset

 is 
\begin_inset Formula 
\[
\mathbf{Q_{ss}(}\mathbf{\theta})=E[(\mathbf{s}\mathbf{-}\mathbf{X\beta})(\mathbf{s}\mathbf{-}\mathbf{X\beta})^{T}]
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0 in where 
\begin_inset Formula $\mathbf{Q_{ss}}$
\end_inset

 is a covariance function with structural parameters 
\begin_inset Formula $\mathbf{\theta}.$
\end_inset

 In bgaPEST, allowable covariance functions 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0.25 in include
\change_deleted -1837876828 1342446076
:
\change_unchanged
 
\end_layout

\begin_layout Enumerate
the nugget 
\begin_inset Formula 
\[
\mathbf{R}\left(\mathbf{d}\right)=\sigma^{2}
\]

\end_inset


\end_layout

\begin_layout Enumerate
and the exponential covariance function 
\begin_inset Formula 
\begin{equation}
\mathbf{R}(\mathbf{d})=\sigma^{2}\mathrm{exp}(\mathbf{-}\frac{\left|\mathbf{d}\right|}{\ell})\label{eq:exp_GCF}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $\left|\mathbf{d}\right|$
\end_inset

 is separation distance, 
\begin_inset Formula $\sigma^{2}$
\end_inset

 is variance, and 
\begin_inset Formula $\ell$
\end_inset

 is integral scale.
 If the integral scale is set such that 
\begin_inset Formula $\ell$
\end_inset

>
\begin_inset Formula $\mathrm{max}(\left|\mathbf{d}\right|)$
\end_inset


\change_inserted -1837876828 1342446162
,
\change_unchanged
 we can substitute 
\begin_inset Formula $\sigma^{2}=\theta\ell$
\end_inset

 and restate 
\change_deleted -1837876828 1342446169
E
\change_inserted -1837876828 1342446169
e
\change_unchanged
quation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:exp_GCF"

\end_inset

 as 
\begin_inset Formula 
\begin{equation}
\mathbf{Q_{ss}}(\mathbf{h},\theta)=\theta\ell\mathrm{exp}(-\frac{\mathbf{\left|\mathbf{d}\right|}}{\ell}).\label{eq:Qss}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
We can also set 
\begin_inset Formula $\ell=10\times\mathrm{max(\mathbf{\left|d\right|})}$
\end_inset

 so 
\change_inserted -1837876828 1342446181
that 
\change_unchanged
the behavior of the covariance function will be as a linear variogram 
\begin_inset CommandInset citation
LatexCommand citep
key "FienenWRR2008"

\end_inset


\change_inserted -1837876828 1342446188
,
\change_unchanged
 which enforces continuity at a scale determined by the single free structural
 parameter 
\begin_inset Formula $\theta.$
\end_inset

 The motivation for this covariance function choice is to impart minimal
 assumptions about parameter structure onto the solution.
 The appropriate value of 
\begin_inset Formula $\mathbf{\theta}$
\end_inset

 is calculated through restricted maximum likelihood.
 For the remainder of this derivation, 
\begin_inset Formula $\mathbf{\theta}$
\end_inset

 is assumed 
\change_inserted -1837876828 1342446210
to be 
\change_unchanged
known.
 In bgaPEST, as discussed below in the input instructions, either the exponentia
l or linear variogram models may be used.
\end_layout

\begin_layout Standard
Assembling the mean and covariance, the prior pdf is 
\begin_inset Formula 
\begin{equation}
p(\mathbf{s}|\beta)\propto\mathrm{exp\left[\mathbf{-}\frac{1}{2}(\mathbf{s-X\beta})^{T}\mathbf{Q_{ss}^{-1}}(\mathbf{s-X\beta})\right]}.\label{eq:prior}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
In the case of no knowledge about the prior mean, the prior pdf of 
\begin_inset Formula $\mathbf{\beta}$
\end_inset

 can be modeled as uniform over all space as 
\begin_inset Formula $p(\mathbf{\beta)\propto1}$
\end_inset

 
\change_deleted -1837876828 1342446247
and
\change_inserted -1837876828 1342446248
with
\change_unchanged
 both 
\series bold
s
\series default
 and 
\begin_inset Formula $\mathbf{\beta}$
\end_inset

 
\change_deleted -1837876828 1342446251
are
\change_inserted -1837876828 1342446252
being
\change_unchanged
 estimated together, so that the conditional distribution in 
\change_deleted -1837876828 1342446262
E
\change_inserted -1837876828 1342446262
e
\change_unchanged
quation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:prior"

\end_inset

 is replaced by a joint distribution
\change_inserted -1837876828 1342700106
:
\change_unchanged
 
\begin_inset Formula 
\[
p(\mathbf{s},\beta)\propto\mathrm{exp\left[\mathbf{-}\frac{1}{2}(\mathbf{s-X\beta})^{T}\mathbf{Q_{ss}^{-1}}(\mathbf{s-X\beta})\right]}.
\]

\end_inset

Frequently, at least diffuse knowledge about the prior mean is available
 and can be modeled as multi-Gaussian with mean 
\begin_inset Formula $\mathbf{\beta^{*}}$
\end_inset

 and covariance 
\begin_inset Formula $\mathbf{Q_{\beta\beta}}$
\end_inset

.
 Typically, 
\begin_inset Formula $\mathbf{Q_{\beta\beta}}$
\end_inset

 is modeled as a diagonal matrix with variance values on the diagonal indicating
 independence among the 
\begin_inset Formula $\beta^{*}$
\end_inset

.
 Incorporating the prior information yields a prior pdf for 
\begin_inset Formula $\mathbf{s}$
\end_inset


\change_inserted -1837876828 1342700109
:
\change_unchanged
 
\begin_inset Formula 
\begin{equation}
p(\mathbf{s})\propto\mathrm{exp\left[\mathbf{-}\frac{1}{2}(\mathbf{s-X\beta}^{*})^{T}\mathbf{G_{\mathbf{ss}}^{-1}}(\mathbf{s-X\beta^{*}})\right]}\label{eq:final_prior}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0 in where 
\begin_inset Formula $\mathbf{X\beta^{*}}$
\end_inset

 is the prior mean
\change_deleted -1837876828 1342446282
,
\change_unchanged
 and 
\begin_inset Formula $\mathbf{G_{ss}=Q_{ss}+XQ_{\beta\beta}X^{\mathbf{T}}}$
\end_inset

 is the prior covariance 
\begin_inset CommandInset citation
LatexCommand citep
key "NowakCirpka2004"

\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0.25 in The incorporation of prior mean information, even assuming very
 high variance values in 
\begin_inset Formula $\mathbf{Q_{\beta\beta},}$
\end_inset

 can provide numerical stability without overly biasing the results.
 In the original formulations of 
\begin_inset CommandInset citation
LatexCommand citet
key "KitanidisVomvoris1983,HoeksemaKitanidis1984a,Kitanidis1995"

\end_inset

, 
\begin_inset Formula $\mathbf{G_{ss}}=\mathbf{Q_{ss}}$
\end_inset


\change_inserted -1837876828 1342446302
,
\change_unchanged
 and no prior covariance is supplied on the values for 
\begin_inset Formula $\beta.$
\end_inset

 This behavior can be duplicated in bgaPEST by specifying prior_betas=0
\change_inserted -1837876828 1342446341

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342446362
Should the preceding term be in a different font?
\change_unchanged

\end_layout

\end_inset


\change_unchanged
 in the input block for Prior Mean Control Variables.
\end_layout

\begin_layout Subsection
Prior Covariance Matrix Storage Issues
\end_layout

\begin_layout Standard
In underdetermined problems suitable for bgaPEST, the number of parameters
 can be very large.
 The prior covariance matrix discussed above can, therefore, grow to such
 large dimensions that it cannot be practically stored in computer memory.
 However, two techniques are provided to alleviate some of this storage
 stress: compression and Toeplitz transformation.
\end_layout

\begin_layout Standard
Compression takes advantage of the fact that values in the 
\begin_inset Formula $\mathbf{G_{ss}}$
\end_inset

 matrix relating parameters in different beta associations, by definition,
 have the value of zero.
 As a result, a general 
\begin_inset Formula $\mathbf{G_{ss}}$
\end_inset

 matrix can be viewed as a partitioned matrix of nonzero blocks 
\begin_inset Formula $\left(\mathbf{G}_{\mathbf{ss},\beta i}\right)$
\end_inset

 and zero blocks
\change_inserted -1837876828 1342700128
:
\change_unchanged
 
\begin_inset Formula 
\[
\mathbf{G}_{\mathbf{ss}}=\left[\begin{array}{cccc}
\mathbf{G}_{\mathbf{ss},\beta1} & \mathbf{0} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{G}_{\mathbf{ss},\beta2} & \mathbf{0} & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \ddots & \mathbf{0}\\
\mathbf{0} & \mathbf{0} & \mathbf{0} & \mathbf{G}_{\mathbf{ss},\beta p}
\end{array}\right].
\]

\end_inset


\end_layout

\begin_layout Standard
There is no need to store the zero elements provided that accommodations
 are made to avoid multiplications that involve the zeros.
 These accommodations have been made in bgaPEST and compression is
\change_deleted -1837876828 1342446678
,
\change_unchanged
 therefore
\change_deleted -1837876828 1342446679
,
\change_unchanged
 allowed.
\end_layout

\begin_layout Standard
In cases where spa
\change_deleted -1837876828 1342446715
c
\change_inserted -1837876828 1342446715
t
\change_unchanged
ial spacing 
\change_inserted -1837876828 1342446879

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342614598
Note 18
\change_unchanged

\end_layout

\end_inset


\change_unchanged
is constant in respective directions, 
\begin_inset Formula $\mathbf{G}_{\mathbf{ss},\beta i}$
\end_inset

 is a block Toeplitz matrix 
\begin_inset CommandInset citation
LatexCommand citep
key "toeplitz"

\end_inset

.
 A square, symmetric 
\begin_inset Formula $j\times j$
\end_inset

 matrix is Toeplitz in form if it has diagonals that all have the same value
 as in this example
\change_inserted -1837876828 1342700137
:
\change_unchanged
 
\begin_inset Formula 
\[
\mathbf{T}=\text{\ensuremath{\left[\begin{array}{ccccc}
t_{0} & t_{1} & \dots\  & t_{j-2} & t_{j-1}\\
t_{1} & t_{0} & t_{1} & \ddots\  & t_{j-2}\\
\vdots\  & t_{1} & t_{0} & \ddots\  & \vdots\\
t_{j-2} & \ddots\  & \ddots\  & \ddots\  & t_{1}\\
t_{j-1} & t_{j-2} & \dots\  & t_{1} & t_{0}
\end{array}\right]}}.
\]

\end_inset


\end_layout

\begin_layout Standard
This matrix has the properties that there are only 
\begin_inset Formula $j$
\end_inset

 unique values, and these values occur in a regular order such that only
 a vector of length 
\begin_inset Formula $j$
\end_inset

 needs to be stored from which individual rows can be constructed to perform
 matrix multiplication operations.
 The spacing, as indicated above, must be constant.
 For example, in a spatial model such as properties in a groundwater model,
 
\begin_inset Formula $\Delta x,$
\end_inset

 
\begin_inset Formula $\Delta y,$
\end_inset

 and 
\begin_inset Formula $\Delta z$
\end_inset

 must be constant, but these values do not need to be equal to each other.
 
\change_deleted -1837876828 1342447023
While t
\change_inserted -1837876828 1342447023
T
\change_unchanged
his 
\change_inserted -1837876828 1342447030
condition 
\change_unchanged
is restrictive in the sense that it implies a regular grid that may not
 correspond to geometry in the field
\change_deleted -1837876828 1342447039
.
 H
\change_inserted -1837876828 1342447040
; h
\change_unchanged
owever, the regular grid required to take advantage of Toeplitz storage
 and operations can be assigned to one beta association with a surrounding,
 irregular grid put in another beta association with fewer parameter values.
\end_layout

\begin_layout Standard
In order to use Toeplitz structure in three dimensions, there must be a
 three-level embedding of Toeplitz matrices 
\begin_inset CommandInset citation
LatexCommand citep
key "MarcoDiss"

\end_inset

.
 The first level corresponds to the model layers, the second level corresponds
 to model rows, and the third level corresponds to model columns.
 Inspection of the schematic example in 
\change_deleted -1837876828 1342447075
F
\change_inserted -1837876828 1342447075
f
\change_unchanged
ig
\change_inserted -1837876828 1342447078
ure
\change_deleted -1837876828 1342447078
.

\change_unchanged
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:toep"

\end_inset

 shows that every distinct value represented in the entire matrix is found
 in the first (leftmost) column.
 Cycling of rows or columns, relative to the single stored vector, can be
 used to reconstruct any row or column of the main matrix to be used in
 multiplication operations.
 In bgaPEST, a combination of Toeplitz and complete blocks can make up the
 
\begin_inset Formula $\mathbf{G_{ss}}$
\end_inset

 matrix in Compressed form, as discussed above.
\end_layout

\begin_layout Standard
For even larger problems (more parameters)
\change_inserted -1837876828 1342447122
,
\change_unchanged
 specialized Fourier
\change_inserted -1837876828 1342447128
-
\change_deleted -1837876828 1342447128
 
\change_unchanged
tranform-based functions may be useful to speed up the computations made
 with compressed matrices 
\begin_inset CommandInset citation
LatexCommand citep
key "Nowak2003,NowakCirpka2004"

\end_inset

.
 The restriction of regular grid spacing can also be relaxed 
\change_inserted -1837876828 1342447142
by 
\change_unchanged
using a Karhunen-Loeve transform 
\begin_inset CommandInset citation
LatexCommand citep
key "LiCirpka2006"

\end_inset

.
 Both of these advances may be considered as future improvements to bgaPEST
 but are not currently implemented.
\end_layout

\begin_layout Standard
Detailed input instructions for bgaPEST are presented in 
\change_deleted -1837876828 1342195809
Appendix
\change_inserted -1837876828 1342195809
appendix
\change_unchanged
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Input-Instructions"

\end_inset

.
 It is important to note, however, that if Toeplitz compression is invoked,
 parameters must be listed in the 
\family typewriter
.bgp
\family default
 input file in order, sorted first by layer, then by column, and finally
 by row.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/toeplitz_3_level.pdf
	scale 55

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:toep"

\end_inset

Schematic graphical visualization of a three-level embedded set of Toeplitz
 blocks in a covariance matrix (modified from 
\begin_inset CommandInset citation
LatexCommand citet
key "MarcoDiss"

\end_inset

).
 The smallest squares represent individual matrix entries (values)
\change_inserted -1837876828 1342447170
,
\change_unchanged
 and the colors correspond to distinct values.
 In this synthetic example, it is assumed that there are three rows, three
 columns, and three layers in the underlying model
\change_deleted -1837876828 1342698974
.
\change_unchanged

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Likelihood Function
\end_layout

\begin_layout Standard
The parameters 
\begin_inset Formula $\mathbf{s}$
\end_inset

 are related to observations 
\begin_inset Formula $\mathbf{y}$
\end_inset

 through a measurement equation 
\begin_inset Formula 
\[
\mathbf{y=h(s)+v}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0 in where 
\begin_inset Formula $\mathbf{y}$
\end_inset

 is an 
\begin_inset Formula $(n\times1)$
\end_inset

 vector of observations, such as hydraulic heads or solute concentrations,
 
\begin_inset Formula $\mathbf{h(s)}$
\end_inset

 is a transfer function or numerical model that calculates predictions which
 are co
\change_deleted -1837876828 1342447636
l
\change_unchanged
located spatially and temporally with the observation values, and 
\begin_inset Formula $\mathbf{v}$
\end_inset

 is an 
\begin_inset Formula $(n\times1)$
\end_inset

 vector of epistemic uncertainty terms, modeled as a random process with
 zero mean and covariance matrix 
\begin_inset Formula $\mathbf{R.}$
\end_inset

 Epistemic uncertainty is the result of imperfect or sparse measurements
 and an incomplete or inappropriate conceptual model 
\begin_inset CommandInset citation
LatexCommand citep
after "p. 4"
key "Rubin2003"

\end_inset

.
 The epistemic uncertainty terms are assumed 
\change_inserted -1837876828 1342447707
to be 
\change_unchanged
independent and uncorrelated
\change_inserted -1837876828 1342447711
,
\change_unchanged
 so 
\begin_inset Formula 
\begin{equation}
\mathbf{R=\sigma_{R}^{2}W}\label{eq:R}
\end{equation}

\end_inset

where 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 is the epistemic uncertainty parameter and 
\series bold

\begin_inset Formula $\mathbf{W}$
\end_inset


\series default
 is an 
\begin_inset Formula $(n\times n)$
\end_inset

 diagonal weight matrix in which each element is 
\begin_inset Formula $\mathbf{W}_{ii}=\frac{1}{\omega_{i}^{2}}$
\end_inset


\change_inserted -1837876828 1342447729
,
\change_unchanged
 where 
\begin_inset Formula $\omega_{i}$
\end_inset

 is the 
\begin_inset Formula $i^{th}$
\end_inset

 weight, specified by the user.
 The purpose of the values of 
\begin_inset Formula $\omega$
\end_inset

 is to allow for different confidence in different individual observations
 or groups of observations.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0.25 in In reality, the component of epistemic uncertainty due to measurement
 error is likely uncorrelated, but the component due to modeling and conceptual
 uncertainty is likely systematic and correlated 
\begin_inset CommandInset citation
LatexCommand citep
key "GaganisSmith2001"

\end_inset

.
 A significant portion of this uncertainty may be reduced by not lumping
 parameters into homogeneous zones 
\begin_inset CommandInset citation
LatexCommand citep
key "GallagherDoherty2007"

\end_inset

, and the means to characterize the structure of 
\begin_inset Formula $\mathbf{R}$
\end_inset

 are rarely available.
 If information about 
\begin_inset Formula $\mathbf{R}$
\end_inset

 is available, however, it could be included and 
\change_deleted -1837876828 1342447777
E
\change_inserted -1837876828 1342447777
e
\change_unchanged
quation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:R"

\end_inset

 
\change_deleted -1837876828 1342447792
could be
\change_unchanged
 replaced by a more complicated matrix.
 This option is currently not available in bgaPEST, however.
 Proceeding with 
\change_deleted -1837876828 1342447800
E
\change_inserted -1837876828 1342447800
e
\change_unchanged
quation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:R"

\end_inset


\change_inserted -1837876828 1342447805
,
\change_deleted -1837876828 1342447805
 
\change_inserted -1837876828 1342700357
 
\change_unchanged
the likelihood function, assumed 
\change_inserted -1837876828 1342447809
to be 
\change_unchanged
multi-Gaussian, is 
\begin_inset Formula 
\begin{equation}
L(\mathbf{y|s})\propto\mathrm{exp\left[-\frac{1}{2}\left(\mathbf{y-h}(\mathbf{s})\right)^{T}\mathbf{R^{-1}\left(\mathbf{y-h}(\mathbf{s})\right)}\right].}\label{eq:likelihood}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The structural parameter for the likelihood function is 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 and is calculated along with 
\begin_inset Formula $\theta$
\end_inset

 
\change_inserted -1837876828 1342447820
by 
\change_unchanged
using restricted maximum likelihood.
\end_layout

\begin_layout Subsection
Posterior Probability Density Function
\end_layout

\begin_layout Standard
Applying Bayes' theorem with the product of 
\change_deleted -1837876828 1342448019
E
\change_inserted -1837876828 1342448019
e
\change_unchanged
quations 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:final_prior"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:likelihood"

\end_inset

 yields the posterior pdf 
\begin_inset Formula 
\begin{equation}
p(\mathbf{s|y})\propto\mathrm{exp\left[\mathbf{-}\frac{1}{2}(\mathbf{s-X\beta}^{*})^{T}\mathbf{G_{\mathbf{ss}}^{-1}}(\mathbf{s-X\beta^{*}})\mathbf{-}\frac{1}{2}\left(\mathbf{y-h}(\mathbf{s})\right)^{T}\mathbf{R^{-1}\left(\mathbf{y-h}(\mathbf{s})\right)}\right]}\label{eq:posterior}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The best estimate of 
\begin_inset Formula $\mathbf{s}$
\end_inset

 maximizes the posterior pdf.
 A computationally efficient method to find the best estimates of 
\begin_inset Formula $\mathbf{s}$
\end_inset

 and 
\begin_inset Formula $\mathbf{\beta}$
\end_inset

 
\begin_inset Formula $\left(\hat{\mathbf{s}}\mbox{ and }\mathbf{\hat{\beta}}\mbox{, respectively}\right)$
\end_inset

 is through 
\begin_inset Formula 
\begin{equation}
\hat{\mathbf{s}}=\mathbf{X\hat{\beta}+Q_{ss}H^{\mathbf{T}}\xi}\label{eq:shat}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0 in which is the superposition of the prior mean (first term) and an innovatio
n term 
\change_deleted -1837876828 1342448048
which
\change_inserted -1837876828 1342448049
that
\change_unchanged
 
\change_deleted -1837876828 1342448052
considers
\change_inserted -1837876828 1342448053
accounts for
\change_unchanged
 deviations of the model outputs from the observations (second term).
 
\begin_inset Formula $\mathbf{H}$
\end_inset

 in the second term (often referred to as the Jacobian, sensitivity, or
 susceptibility matrix) is the sensitivity of observation values to parameter
 values 
\begin_inset Formula $\mbox{where }H_{ij}=\frac{\partial\mathbf{h}\left(\mathbf{s}\right)_{i}}{\partial\mathbf{s}_{j}}$
\end_inset

 is calculated 
\change_inserted -1837876828 1342448327
by 
\change_unchanged
using either finite-difference or adjoint-state methods.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0.25 in The values for 
\begin_inset Formula $\mathbf{\hat{\beta}}$
\end_inset

 and 
\begin_inset Formula $\mathbf{\xi}$
\end_inset

 are found by solving the 
\begin_inset Formula $(n+p)\times(n+p)$
\end_inset

 linear system of cokriging equations 
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{cc}
\mathbf{Q_{yy}} & \mathbf{HX}\\
\mathbf{X}^{T}\mathbf{H}^{T} & \mathbf{-}\mathbf{Q_{\beta\beta}^{-1}}
\end{array}\right]\left[\begin{array}{c}
\mathbf{\xi}\\
\mathbf{\hat{\beta}}
\end{array}\right]=\left[\begin{array}{c}
\mathbf{y}\\
\mathbf{-}\mathbf{Q_{\beta\beta}^{-1}}\beta^{*}
\end{array}\right]\label{eq:cokriging}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0 in where 
\begin_inset Formula $\mathbf{Q_{yy}}$
\end_inset

 is the auto-covariance matrix of the observations, defined as 
\begin_inset Formula $\mathbf{HQ_{ss}H^{\mathbf{T}}+R}$
\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0.25 in
\end_layout

\begin_layout Subsection
Quasi-Linear Extension
\end_layout

\begin_layout Standard
As discussed by 
\begin_inset CommandInset citation
LatexCommand citet
key "Kitanidis1995"

\end_inset

, we must adjust calculations of the posterior pdf to account for nonlinearity.
 To do this, we expand the solution in a first-order Taylor expansion, resulting
 in an updated set of cokriging equations from 
\change_deleted -1837876828 1342448526
E
\change_inserted -1837876828 1342448526
e
\change_unchanged
quation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:cokriging"

\end_inset


\change_inserted -1837876828 1342700373
:
\change_unchanged
 
\begin_inset Formula 
\begin{equation}
\left[\begin{array}{cc}
\mathbf{Q_{yy}} & \mathbf{HX}\\
\mathbf{X}^{T}\mathbf{H}^{T} & \mathbf{-}\mathbf{Q_{\beta\beta}^{-1}}
\end{array}\right]\left[\begin{array}{c}
\mathbf{\xi}\\
\mathbf{\hat{\beta}}
\end{array}\right]=\left[\begin{array}{c}
\mathbf{y}-\mathbf{h}\left(\mathbf{\tilde{s}}\right)+\mathbf{H}\tilde{\mathbf{s}}\\
\mathbf{-}\mathbf{Q_{\beta\beta}^{-1}}\beta^{*}
\end{array}\right]\label{eq:cokriging_nonlinear}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
At each iteration (later referred to as inner iterations), the system in
 
\change_deleted -1837876828 1342448532
E
\change_inserted -1837876828 1342448532
e
\change_unchanged
quation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:cokriging_nonlinear"

\end_inset

 is solved, resulting in an updated estimate of 
\begin_inset Formula $\hat{\mathbf{s}}$
\end_inset

 calculated through 
\change_deleted -1837876828 1342448537
E
\change_inserted -1837876828 1342448537
e
\change_unchanged
quation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:shat"

\end_inset

.
 At each iteration, the objective function
\change_deleted -1837876828 1342448580
,
\change_unchanged
 based on minimizing the negative logarithm of the posterior pdf (
\change_deleted -1837876828 1342448586
E
\change_inserted -1837876828 1342448586
e
\change_unchanged
q
\change_deleted -1837876828 1342700397
uation
\change_inserted -1837876828 1342700397
.

\change_unchanged
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:posterior"

\end_inset

) is evaluated 
\change_inserted -1837876828 1342448590
by 
\change_unchanged
using the current value of 
\begin_inset Formula $\mathbf{\hat{s}}$
\end_inset

: this is equivalent to finding the values of 
\begin_inset Formula $\mathbf{s}$
\end_inset

 that 
\emph on
maximize 
\emph default
the posterior probability.
 Switching to a minimization problem and taking the logarithm has computational
 advantages.
\end_layout

\begin_layout Standard
The objective function, then, is 
\begin_inset Formula 
\begin{equation}
\Phi_{T}=\Phi_{M}+\Phi_{R}\label{eq:phiT}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0 in where 
\begin_inset Formula $\Phi_{T}$
\end_inset

 is the total objective function, 
\begin_inset Formula $\Phi_{M}$
\end_inset

 is the misfit objective function (also corresponding to the likelihood
 function)
\change_inserted -1837876828 1342448613
,
\change_unchanged
 and 
\begin_inset Formula $\Phi_{R}$
\end_inset

 is the regularization objective function (also corresponding to the prior
 pdf).
 The components of 
\change_deleted -1837876828 1342448616
E
\change_inserted -1837876828 1342448616
e
\change_unchanged
quation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:phiT"

\end_inset

 are 
\begin_inset Formula 
\[
\Phi_{M}=\frac{1}{2}\left(\mathbf{y-h}(\mathbf{\hat{s}})\right)^{T}\mathbf{R^{-1}\left(\mathbf{y-h}(\mathbf{\hat{s}})\right)}
\]

\end_inset


\end_layout

\begin_layout Standard
and 
\begin_inset Formula 
\[
\Phi_{R}=\frac{1}{2}(\mathbf{\hat{s}-X\beta}^{*})^{T}\mathbf{G_{\mathbf{ss}}^{-1}}(\mathbf{\hat{s}-X\beta^{*}})
\]

\end_inset


\end_layout

\begin_layout Standard
where both the negative signs and exponentiation are obviated by taking
 the negative logarithm of 
\begin_inset Formula $p\left(\mathbf{s}|\mathbf{y}\right)$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0.25 in 
\end_layout

\begin_layout Subsection
Implementation of Partitions into Beta Associations
\end_layout

\begin_layout Standard
The concept of beta associations is discussed above
\change_inserted -1837876828 1342448806
,
\change_unchanged
 and details of their implementation are 
\change_deleted -1837876828 1342448811
explained
\change_inserted -1837876828 1342448811
given
\change_unchanged
 here.
 First, the prior covariance matrix 
\begin_inset Formula $\mathbf{Q_{ss}}$
\end_inset

 is censored by assigning a value of zero to each element 
\change_deleted -1837876828 1342448819
which
\change_inserted -1837876828 1342448820
that
\change_unchanged
 characterizes covariance between cells of different regions or parameter
 types, as defined by beta associations.
 It is not required that the covariance model be the same for each beta
 association.
 If different covariance models are used for different zones, this is reflected
 in the appropriate parts of 
\begin_inset Formula $\mathbf{Q_{ss}}.$
\end_inset

 Furthermore, in some applications, a single structural parameter, 
\begin_inset Formula $\theta,$
\end_inset

 may be estimated and applied to all of 
\begin_inset Formula $\mathbf{Q_{ss}.}$
\end_inset

 In other cases, and necessarily if the covariance model differs in various
 beta association, multiple elements of 
\begin_inset Formula $\mathbf{\theta}$
\end_inset

 are estimated.
\end_layout

\begin_layout Standard
A distinct prior mean parameter 
\begin_inset Formula $\mathbf{\beta^{*}}$
\end_inset

 is assigned for each beta association, and the matrix 
\begin_inset Formula $\mathbf{X}$
\end_inset

 (
\change_deleted -1837876828 1342448849
E
\change_inserted -1837876828 1342448849
e
\change_unchanged
q
\change_deleted -1837876828 1342700418
uation
\change_inserted -1837876828 1342700418
.

\change_unchanged
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Es"

\end_inset

) is determined as explained 
\change_deleted -1837876828 1342448855
in
\change_unchanged
 above.
 In cases where the mean of each zone is completely unknown, no values for
 
\begin_inset Formula $\mathbf{\beta^{*}}$
\end_inset

 are provided, but the 
\begin_inset Formula $\mathbf{X}$
\end_inset

 matrix is constructed nonetheless
\change_inserted -1837876828 1342700425
,
\change_unchanged
 and in both cases a value of 
\begin_inset Formula $\mathbf{\hat{\beta}}$
\end_inset

 is calculated for each beta association.
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Structural-Parameters"

\end_inset

Structural Parameters and Restricted Maximum Likelihood
\end_layout

\begin_layout Standard
A vital element to the method outlined above is proper selection of the
 structural parameters.
 Structural parameters--also called hyperparameters
\change_deleted -1837876828 1342450504
--
\change_inserted -1837876828 1342700437
 
\change_unchanged
or nuisance parameters
\change_deleted -1837876828 1342450508
, 
\change_inserted -1837876828 1342450509
--
\change_unchanged
are the parameters that characterize the covariance structure of both the
 epistemic uncertainty related to the observations
\change_deleted -1837876828 1342450534
,
\change_unchanged
 and the inherent variability of the parameters.
 In this work
\change_inserted -1837876828 1342450573

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342614605
Note 19
\change_unchanged

\end_layout

\end_inset


\change_unchanged
, structural parameters may include the epistemic uncertainty term in 
\change_deleted -1837876828 1342450685
E
\change_inserted -1837876828 1342450686
e
\change_unchanged
quation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:R"

\end_inset

 
\begin_inset Formula $\left(\sigma_{R}^{2}\right)$
\end_inset

 and the prior pdf variogram parameters in 
\change_deleted -1837876828 1342450689
E
\change_inserted -1837876828 1342450689
e
\change_unchanged
quation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Qss"

\end_inset

 
\begin_inset Formula $\left(\theta\right).$
\end_inset

 These parameters are estimated 
\change_inserted -1837876828 1342450693
by 
\change_unchanged
using 
\change_deleted -1837876828 1342450743
R
\change_inserted -1837876828 1342450743
r
\change_unchanged
estricted 
\change_deleted -1837876828 1342450746
M
\change_inserted -1837876828 1342450746
m
\change_unchanged
aximum 
\change_deleted -1837876828 1342450751
L
\change_inserted -1837876828 1342450751
l
\change_unchanged
ikelihood consistent with the approaches of 
\begin_inset CommandInset citation
LatexCommand citet
key "KitanidisVomvoris1983"

\end_inset

, 
\begin_inset CommandInset citation
LatexCommand citet
key "Kitanidis1995"

\end_inset


\change_inserted -1837876828 1342700447
,
\change_unchanged
 and 
\begin_inset CommandInset citation
LatexCommand citet
key "LiCirpka2007"

\end_inset

.
\end_layout

\begin_layout Standard
Applying Bayes' theorem to the structural parameters, given the measurements,
 we calculate 
\begin_inset Formula 
\[
p\left(\mathbf{\theta|\mathbf{y}_{k}^{'}}\right)\propto L\left(\mathbf{y}_{k}^{'}|\theta\right)p\left(\mathbf{\theta}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
The likelihood function evaluates how closely the observations and predictions
 match, given the current linearization and the current set of structural
 parameters
\change_inserted -1837876828 1342700458
:
\change_unchanged
 
\begin_inset Formula 
\begin{equation}
L\left(\mathbf{y}_{k}^{'}|\theta\right)\propto\mathrm{det}\left(\mathbf{G_{yy}}\right)^{-\frac{1}{2}}\exp\left[-\frac{1}{2}\left(\mathbf{y}_{k}^{'}-\mathbf{HX\beta^{*}}\right)^{T}\mathbf{G_{yy}^{-1}}\left(\mathbf{y}_{k}^{'}-\mathbf{HX\beta^{*}}\right)\right]\label{eq:theta_like}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0 in where 
\begin_inset Formula $\mathbf{G_{yy}}$
\end_inset

 is the measurement autocovariance defined as 
\begin_inset Formula 
\[
\mathbf{G_{yy}}=\mathbf{Q_{yy}}+\mathbf{HXQ_{\beta\beta}X}^{T}\mathbf{H}^{T}.
\]

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
parindent
\end_layout

\end_inset

 0.25 in
\end_layout

\begin_layout Standard
Note that 
\begin_inset Formula $\mathbf{Q_{yy}}$
\end_inset

 is intrinsically dependent upon the values of 
\begin_inset Formula $\theta.$
\end_inset


\end_layout

\begin_layout Standard
Prior information about the structural parameters may also be included,
 with prior mean 
\begin_inset Formula $\mathbf{\theta^{*}}$
\end_inset

 and covariance matrix 
\begin_inset Formula $\mathbf{Q_{\theta\theta}}$
\end_inset


\change_deleted -1837876828 1342700537
.
\change_inserted -1837876828 1342700537
:
\change_unchanged
 
\begin_inset Formula 
\begin{equation}
p\left(\mathbf{\theta}\right)\propto\mathrm{det}\left(\mathbf{Q_{\theta\theta}}\right)^{-\frac{1}{2}}\exp\left[-\frac{1}{2}\left(\mathbf{\theta-\theta^{*}}\right)^{T}\mathbf{Q}_{\mathbf{\theta\theta}}^{-1}\left(\mathbf{\theta-\theta^{*}}\right)\right]\label{eq:theta_prior}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The posterior pdf is the product of 
\change_deleted -1837876828 1342450810
E
\change_inserted -1837876828 1342450810
e
\change_unchanged
quations 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:theta_prior"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:theta_like"

\end_inset


\change_inserted -1837876828 1342700543
:
\change_unchanged
 
\begin_inset Formula 
\[
p\left(\mathbf{\theta|\mathbf{y}_{k}^{'}}\right)\propto\mathrm{\mathrm{det}\left(\mathbf{Q_{\theta\theta}}\right)^{-\frac{1}{2}}det}\left(\mathbf{G_{yy}}\right)^{-\frac{1}{2}}\exp\left[\begin{array}{c}
-\frac{1}{2}\left(\mathbf{\theta-\theta^{*}}\right)^{T}\mathbf{Q}_{\mathbf{\theta\theta}}^{-1}\left(\mathbf{\theta-\theta^{*}}\right)\\
-\frac{1}{2}\left(\mathbf{y}_{k}^{'}-\mathbf{HX\beta^{*}}\right)^{T}\mathbf{G_{yy}^{-1}}\left(\mathbf{y}_{k}^{'}-\mathbf{HX\beta^{*}}\right)
\end{array}\right].
\]

\end_inset


\end_layout

\begin_layout Standard
To find the most likely values for 
\begin_inset Formula $\mathbf{\theta}$
\end_inset


\change_inserted -1837876828 1342450818
,
\change_unchanged
 we minimize 
\begin_inset Formula $-\ln\left(p\left(\mathbf{\theta|\mathbf{y}_{k}^{'}}\right)\right)$
\end_inset


\change_inserted -1837876828 1342450827
,
\change_unchanged
 resulting in the objective function 
\begin_inset Formula 
\[
\Phi_{S}=\mathrm{\frac{1}{2}\ln\left(\mathbf{\det\left(G_{yy}\right)}\right)}+\frac{1}{2}\left[\left(\mathbf{\theta-\theta^{*}}\right)^{T}\mathbf{Q}_{\mathbf{\theta\theta}}^{-1}\left(\mathbf{\theta-\theta^{*}}\right)+\left(\mathbf{y}_{k}^{'}-\mathbf{HX\beta^{*}}\right)^{T}\mathbf{G_{yy}^{-1}}\left(\mathbf{y}_{k}^{'}-\mathbf{HX\beta^{*}}\right)\right]
\]

\end_inset


\end_layout

\begin_layout Standard
\noindent
where unchanging quantities are absorbed into the constant of proportionality
 including 
\begin_inset Formula $\det\left(\mathbf{Q}_{\mathbf{\theta\theta}}\right)^{-\frac{1}{2}}$
\end_inset

 .
 The optimal values for 
\begin_inset Formula $\mathbf{\theta}$
\end_inset

 are found 
\change_inserted -1837876828 1342450837
by 
\change_unchanged
using the Nelder-Mead simplex algorithm 
\begin_inset CommandInset citation
LatexCommand citep
after "p. 408-410"
before "e.g. "
key "Press1992"

\end_inset

.
 Non-negativity in the 
\begin_inset Formula $\mathbf{\theta}$
\end_inset

 parameters is enforced 
\change_inserted -1837876828 1342450842
by 
\change_unchanged
using a power transformation 
\begin_inset CommandInset citation
LatexCommand citep
key "BoxCox1964"

\end_inset

.
 As indicated by 
\begin_inset CommandInset citation
LatexCommand citet
key "Kitanidis1995"

\end_inset

, nonlinearity requires 
\change_deleted -1837876828 1342450884
that
\change_unchanged
 structural parameters 
\change_deleted -1837876828 1342450868
are
\change_inserted -1837876828 1342450880
to be
\change_unchanged
 estimated iteratively with the estimation of hydraulic parameters.
 This is accomplished through a sequence of coupled inversion
\change_inserted -1837876828 1342700556
,
\change_unchanged
 as follows.
 
\end_layout

\begin_layout Enumerate
Initialize hydraulic parameters as 
\begin_inset Formula $\left(\mathbf{s_{0}}\right)$
\end_inset

 and structural parameters 
\begin_inset Formula $\left(\mathbf{\theta_{0}}\right)$
\end_inset

.
 
\end_layout

\begin_layout Enumerate
Solve for a new estimate of hydraulic parameters 
\begin_inset Formula $\left(\hat{\mathbf{s}}\right)$
\end_inset


\change_inserted -1837876828 1342700565
,
\change_unchanged
 holding 
\begin_inset Formula $\mathbf{\theta}$
\end_inset

 constant.
 
\end_layout

\begin_layout Enumerate
Solve for a new estimate of structural parameters 
\begin_inset Formula $\left(\mathbf{\hat{\theta}}\right)$
\end_inset


\change_inserted -1837876828 1342700568
,
\change_unchanged
 holding 
\begin_inset Formula $\mathbf{s}$
\end_inset

 constant.
 
\end_layout

\begin_layout Enumerate
Repeat steps 2 and 3 until the change in 
\begin_inset Formula $\mathbf{\theta}$
\end_inset

 in two consecutive outer iterations of steps 2 and 3 decreases below a
 specified tolerance.
 
\end_layout

\begin_layout Subsection
Posterior Covariance
\end_layout

\begin_layout Standard

\change_deleted -1837876828 1342451558
T
\change_inserted -1837876828 1342451561
Calculation of t
\change_unchanged
he posterior covariance can be 
\change_deleted -1837876828 1342451565
calculated
\change_unchanged
 based on the inverse of the Hessian of the objective function 
\begin_inset CommandInset citation
LatexCommand citep
before "for example, "
key "NowakCirpka2004"

\end_inset

.
 In closed form, the equation for the full posterior covariance matrix is
\change_deleted -1837876828 1342451571
:
\change_unchanged
 
\begin_inset Formula 
\[
\mathbf{V}=\mathbf{\mathbf{G}_{ss}}-\mathbf{G_{sy}G}_{\mathbf{yy}}^{-1}\mathbf{G}_{\mathbf{sy}}^{T}
\]

\end_inset

where 
\begin_inset Formula $\mathbf{G_{sy}}=\mathbf{G_{ss}H}^{T}$
\end_inset

 and 
\begin_inset Formula $\mathbf{G_{yy}}=\mathbf{HG_{ss}H}^{T}+\mathbf{R}$
\end_inset

.
 In the case where compression of 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 is not used, the full matrix 
\begin_inset Formula $\mathbf{V}$
\end_inset

 is calculated and reported.
 Where compression of 
\begin_inset Formula $\mathbf{Q}$
\end_inset

 is used, however, the diagonal of 
\begin_inset Formula $\mathbf{V}$
\end_inset

 is returned as a vector of variances on parameters.
 This information is reported in a separate file
\change_deleted -1837876828 1342451594
,
\change_unchanged
 but 
\change_inserted -1837876828 1342451597
is 
\change_unchanged
also used to calculate
\change_deleted -1837876828 1342451602
d
\change_unchanged
 posterior 95
\change_deleted -1837876828 1342457853
%
\change_inserted -1837876828 1342457853
-percent
\change_unchanged
 confidence intervals.
 The full matrix, when reported, can be used to calculate conditional realizatio
ns 
\begin_inset CommandInset citation
LatexCommand citep
key "Kitanidis1995,Kitanidis1996ana"

\end_inset

.
 
\end_layout

\begin_layout Subsection
References Cited
\end_layout

\begin_layout Section
Appendix 
\begin_inset CommandInset label
LatexCommand label
name "sec:example1"

\end_inset

Single
\change_inserted -1837876828 1342453570
-
\change_deleted -1837876828 1342453569
 
\change_unchanged
Layer Example Application
\end_layout

\begin_layout Standard
The first example application presented is a single-layer groundwater model.
 The forward model is a steady-state
\change_deleted -1837876828 1342453285
,
\change_unchanged
 MODFLOW-2005 model with 21 rows and 21 columns 
\change_inserted -1837876828 1342453488
and 
\change_unchanged
with constant row and column spacing of 1 m
\change_inserted -1837876828 1342455857
eter (m)
\change_unchanged
.
 The hydraulic conductivity field is heterogeneous, varying from 
\begin_inset Formula $6.068\times10^{-05}$
\end_inset

 to 
\begin_inset Formula $0.048$
\end_inset

 meters
\change_deleted -1837876828 1342453514
/
\change_inserted -1837876828 1342453515
 per 
\change_unchanged
day.
 The true hydraulic conductivity field is depicted in 
\change_deleted -1837876828 1342453520
F
\change_inserted -1837876828 1342453520
f
\change_unchanged
igure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:trueK1L"

\end_inset

.
 Observations of head at the locations shown in 
\change_deleted -1837876828 1342453528
F
\change_inserted -1837876828 1342453528
f
\change_unchanged
igure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:residL1-sigfixed"

\end_inset

 were used for parameter estimation.
 To generate observations representing what would be field measurements
 in a non-synthetic case, the model was run forward using the true synthetic
 hydraulic conductivity values
\change_inserted -1837876828 1342453554
,
\change_unchanged
 and the resulting head values were perturbed with normally distributed
 noise with mean of zero and standard deviation of 0.01 m.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/TrueK.pdf
	scale 40

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
True hydraulic conductivity field for the single
\change_inserted -1837876828 1342453573
-
\change_deleted -1837876828 1342453572
 
\change_unchanged
layer example application
\change_deleted -1837876828 1342698996
.
\change_unchanged

\begin_inset CommandInset label
LatexCommand label
name "fig:trueK1L"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The boundary conditions are constant head, highest at the northwest corner
 and linearly decreasing to the southeast, as depicted in 
\change_deleted -1837876828 1342700592
F
\change_inserted -1837876828 1342700592
f
\change_unchanged
igure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:stheads1L"

\end_inset

.
 There is a well at row 13, column 6, extracting water at a constant rate
 of 0.231 liter
\change_deleted -1837876828 1342453587
s/
\change_inserted -1837876828 1342453585
 per 
\change_unchanged
minute.
 No recharge is simulated in this case.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/starting_heads.pdf
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:stheads1L"

\end_inset

Boundary condition (constant head) for the single
\change_inserted -1837876828 1342700681
-
\change_deleted -1837876828 1342700681
 
\change_unchanged
layer example application
\change_deleted -1837876828 1342699003
.
\change_unchanged

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Two options exist to calculate sensitivity (Jacobian) matrices: 
\change_inserted -1837876828 1342700617
(1) 
\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342700663
I don't endorse heavy use of parenthetical numbering of a series, but it
 helps here.
\change_unchanged

\end_layout

\end_inset


\change_unchanged
an experimental adjoint-state version of MODFLOW
\change_deleted -1837876828 1342700609
,
\change_unchanged
 or 
\change_inserted -1837876828 1342700613
(2) 
\change_unchanged
finite
\change_inserted -1837876828 1342455690
-
\change_deleted -1837876828 1342455690
 
\change_unchanged
difference calculations using the 
\change_deleted -1837876828 1342455673
p
\change_inserted -1837876828 1342455673
P
\change_unchanged
ython linkage and PEST, as capable in the released version of bgaPEST.
 Two scenarios were tested as well: 
\change_inserted -1837876828 1342700702
(1) 
\change_unchanged
a case in which the epistemic error term 
\begin_inset Formula $\left(\sigma_{R}^{2}\right)$
\end_inset

 is estimated
\change_deleted -1837876828 1342700707
,
\change_unchanged
 and 
\change_inserted -1837876828 1342700710
(2) 
\change_unchanged
one where 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 is fixed at a value approximately 
\change_deleted -1837876828 1342455708
two
\change_inserted -1837876828 1342455708
2
\change_unchanged
 orders of magnitude higher than
\change_inserted -1837876828 1342455705
 
\change_unchanged
the artificial noise used to corrupt the synthetic 
\begin_inset Quotes eld
\end_inset

true
\begin_inset Quotes erd
\end_inset

 values previously generated by the model--
\begin_inset Formula $1.0m$
\end_inset

.
\change_inserted -1837876828 1342700741

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342700752
Add a space before the m and de-italicize it.
\change_unchanged

\end_layout

\end_inset


\change_deleted -1837876828 1342455729
 
\change_inserted -1837876828 1342455739

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342455825
add a space between 1.0 and m (here and in the figure captions below)
\change_unchanged

\end_layout

\end_inset


\change_unchanged
This level of epistemic uncertainty is intended to be unrealistically high,
 but 
\change_deleted -1837876828 1342455763
also
\change_inserted -1837876828 1342455764
it
\change_unchanged
 encompasses both measurement and modeling error and was 
\change_inserted -1837876828 1342455771
thus 
\change_unchanged
used to demonstrate a case where overfitting would be avoided at all costs.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/1_lay_best_pars_sigma_fixed.pdf
	scale 70

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:KL1-sigfixed"

\end_inset

Parameters (hydraulic conductivity field) estimated for the 
\change_deleted -1837876828 1342455795
1 
\change_inserted -1837876828 1342455797
single-
\change_unchanged
layer example application using bgaPEST with 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 fixed at 
\begin_inset Formula $1.0m$
\end_inset


\change_deleted -1837876828 1342699065
.
\change_unchanged

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/1_layer_fixed_sigma_residuals.pdf
	scale 40

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:residL1-sigfixed"

\end_inset

Squared residuals, plotted at their locations in the model, for the 
\change_deleted -1837876828 1342455879
1 
\change_inserted -1837876828 1342455880
single-
\change_unchanged
layer example application using bgaPEST with 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 fixed at 
\begin_inset Formula $1.0m$
\end_inset


\change_deleted -1837876828 1342699132
.
\change_unchanged

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figures 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:KL1-sigfixed"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:residL1-sigfixed"

\end_inset

 show the estimated parameter field and the corresponding squared residuals,
 respectively, for the case in which 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 is fixed at 
\begin_inset Formula $1.0m$
\end_inset

.
\change_inserted -1837876828 1342700762

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342700768
See comment above.
\change_unchanged

\end_layout

\end_inset


\change_unchanged
 In this case, the relatively high value ascribed to epistemic uncertainty
 certainly prevents overfitting.
 The solution, in fact, is 
\change_deleted -1837876828 1342455973
quite
\change_unchanged
 smooth, and the linear variogram slope parameter 
\begin_inset Formula $\theta$
\end_inset

 was estimated to be 
\begin_inset Formula $3.66\times10^{-01}$
\end_inset

.
 Appropriately, the most structure expressed in the parameter field
\change_deleted -1837876828 1342700809
,
\change_unchanged
 and the correspondingly lowest residuals
\change_deleted -1837876828 1342700811
,
\change_unchanged
 are found 
\change_deleted -1837876828 1342700819
in the vicinity of
\change_inserted -1837876828 1342700820
near
\change_unchanged
 the pumping well
\change_inserted -1837876828 1342700825
,
\change_unchanged
 where 
\change_inserted -1837876828 1342700840
stress is 
\change_unchanged
the greatest stress (and therefore the 
\change_inserted -1837876828 1342700853
amount of information is the 
\change_unchanged
greatest 
\change_deleted -1837876828 1342700848
amount of information
\change_unchanged
)
\change_deleted -1837876828 1342700858
 is found
\change_unchanged
.
 This phenomenon is discussed in further detail by 
\begin_inset CommandInset citation
LatexCommand citet
key "FienenWRR2008"

\end_inset

.
\end_layout

\begin_layout Standard
The smoothness of the parameter field is as expected 
\change_deleted -1837876828 1342700881
by
\change_inserted -1837876828 1342700881
from
\change_unchanged
 the bgaPEST algorithm and consistent with the maximum entropy property
 of the algorithm.
 In other words, the true hydraulic conductivity field is 
\change_deleted -1837876828 1342455980
quite
\change_unchanged
 rough
\change_inserted -1837876828 1342455955
,
\change_unchanged
 but the algorithm estimates parameters that smooth over the
\change_deleted -1837876828 1342455987
se
\change_unchanged
 rough areas.
 The 
\begin_inset Quotes eld
\end_inset

smearing
\begin_inset Quotes erd
\end_inset

 of higher values across a larger area than in reality is also consistent
 with 
\change_inserted -1837876828 1342700901
both 
\change_unchanged
maximum entropy and 
\change_deleted -1837876828 1342700904
also
\change_unchanged
 information content--an anomalous region of high hydraulic conductivity
 emanates from the area of the well 
\change_deleted -1837876828 1342456010
due
\change_inserted -1837876828 1342456012
in response
\change_unchanged
 to the focus of stress (and therefore information) 
\change_inserted -1837876828 1342456025
being 
\change_unchanged
near the pumping well.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/1_lay_best_pars_sigma_estimated.pdf
	scale 70

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:KL1-sigEstimated"

\end_inset

Parameters (hydraulic conductivity field) estimated for the 
\change_deleted -1837876828 1342456031
1 
\change_inserted -1837876828 1342456032
single-
\change_unchanged
layer example application using bgaPEST with 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 estimated by the bgaPEST algorithm
\change_deleted -1837876828 1342699140
.
\change_unchanged

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/1_layer_estimated_sigma_residuals.pdf
	scale 40

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:residL1-sigEstimated"

\end_inset

Squared residuals, plotted at their locations in the model, for the 
\change_deleted -1837876828 1342456042
1 
\change_inserted -1837876828 1342456043
single-
\change_unchanged
layer example application using bgaPEST with 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 estimated
\change_deleted -1837876828 1342699143
.
\change_unchanged

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figures 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:KL1-sigEstimated"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:residL1-sigEstimated"

\end_inset

 show the estimated parameter field and the corresponding squared residuals,
 respectively, for the case in which 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 is estimated by the bgaPEST algorithm.
 The estimated value for epistemic uncertainty was 
\begin_inset Formula $1.007\times10^{-01}$
\end_inset


\change_inserted -1837876828 1342700932
,
\change_unchanged
 and the variogram slope 
\begin_inset Formula $\left(\theta\right)$
\end_inset

 was 
\begin_inset Formula $2.836\times10^{-01}.$
\end_inset

 These results are similar to the case in which 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 was held constant.
 The parameter field shows a similar shape and smoothness level, although
 
\change_deleted -1837876828 1342456079
F
\change_inserted -1837876828 1342456079
f
\change_unchanged
igure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:KL1-sigEstimated"

\end_inset

 shows a bit more structure (roughness).
 Correspondingly, the residuals are generally lower.
 A key point here, however, is that the pattern of the residuals is similar
 and, again, reflects the general information content of the stress induced
 on the system.
 
\end_layout

\begin_layout Subsection
References Cited
\end_layout

\begin_layout Section
Appendix 
\begin_inset CommandInset label
LatexCommand label
name "sec:example2"

\end_inset

Three
\change_inserted -1837876828 1342456933
-
\change_deleted -1837876828 1342456933
 
\change_unchanged
Layer Example Application
\change_inserted -1837876828 1342701374

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342701401
Remember to deal with renumbering the cases in this section (to account
 for the missing #4).
\change_unchanged

\end_layout

\end_inset


\change_unchanged

\end_layout

\begin_layout Standard
A three
\change_inserted -1837876828 1342456936
-
\change_deleted -1837876828 1342456936
 
\change_unchanged
layer groundwater model is presented to explore the use of multiple beta
 associations, anisotropy, and a larger number of parameters.
 In this case, the model is 40 rows by 35 columns across 
\change_deleted -1837876828 1342456944
three
\change_inserted -1837876828 1342456944
3
\change_unchanged
 layers.
 The row spacing is 2.0 m
\change_inserted -1837876828 1342456956
eters (m),
\change_unchanged
 
\change_deleted -1837876828 1342456962
while
\change_inserted -1837876828 1342456962
and
\change_unchanged
 the column spacing is 1.5 m.
 The layers, from shallowest to deepest, are 1.8 m, 1.4 m, and 1.8 m in thickness,
 respectively.
 The disparate row, column, and layer spacing was used to test the Toeplitz
 compression option.
 The model has constant head boundaries on all sides (set at the same elevation-
-60 m
\change_deleted -1837876828 1342456976
eters
\change_unchanged
) and a single well at row 18, column 17, extracting at 0.01 liter
\change_deleted -1837876828 1342456989
s/
\change_inserted -1837876828 1342456991
 per 
\change_unchanged
minute from each layer.
 This low flow rate is not meant to represent typical field conditions
\change_deleted -1837876828 1342456997
,
\change_unchanged
 but rather highlights what can be learned with even a very small stress
 on the system.
\end_layout

\begin_layout Standard
The true parameter field, shown in 
\change_deleted -1837876828 1342457002
F
\change_inserted -1837876828 1342457002
f
\change_unchanged
igure 
\begin_inset CommandInset ref
LatexCommand ref
reference "3Ltruek"

\end_inset

, varies from 0.01 to 0.075 meter
\change_deleted -1837876828 1342457007
s/
\change_inserted -1837876828 1342457008
 per 
\change_unchanged
day.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/3_layer_TRUE_K_field.pdf

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "3Ltruek"

\end_inset

True synthetic hydraulic conductivity field for each layer in the three
\change_inserted -1837876828 1342457017
-
\change_deleted -1837876828 1342457016
 
\change_unchanged
layer example application.
 Values are shown in natural logarithm space to make the differences more
 visible.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Five cases are illustrated here, as summarized in 
\change_deleted -1837876828 1342457025
T
\change_inserted -1837876828 1342457025
t
\change_unchanged
able 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:3lay"

\end_inset

.
 In all cases, each layer is treated as a separate beta association.
 In each of these layers, the initial value for the prior structural parameter
 (the linear variogram slope, 
\begin_inset Formula $\theta$
\end_inset

) is 
\begin_inset Formula $1.0\times10^{-5}$
\end_inset

.
 
\change_inserted -1837876828 1342701296

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342701302
Paragraph break here.
\change_unchanged

\end_layout

\end_inset


\change_unchanged
Cases 1 and 2 illustrate how the level of fit (and, therefore, the degree
 of roughness of the solution) can be influenced by adjusting the epistemic
 uncertainty term 
\begin_inset Formula $\left(\sigma_{R}^{2}\right)$
\end_inset


\change_deleted -1837876828 1342701324
,
\change_inserted -1837876828 1342701324
;
\change_unchanged
 so in these cases, 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 is set at a fixed value.
 
\change_inserted -1837876828 1342701336

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342701340
Paragraph break here.
\change_unchanged

\end_layout

\end_inset


\change_unchanged
In 
\change_deleted -1837876828 1342457043
C
\change_inserted -1837876828 1342457043
c
\change_unchanged
ase 3, 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 is set low 
\begin_inset Formula $\left(1.0\times10^{-5}\right)$
\end_inset


\change_inserted -1837876828 1342457050
,
\change_unchanged
 and the restricted maximum likelihood algorithm is given the freedom to
 estimate it.
 This 
\change_inserted -1837876828 1342457064
setup 
\change_deleted -1837876828 1342701427
is to
\change_unchanged
 illustrate
\change_inserted -1837876828 1342701430
s
\change_unchanged
 the best achievable fit that one might achieve given the specific observation
 set provided without regard for overfitting.
 
\change_inserted -1837876828 1342701347

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342701356
Paragraph break here.
 
\change_unchanged

\end_layout

\end_inset


\change_unchanged
In 
\change_deleted -1837876828 1342457077
C
\change_inserted -1837876828 1342457077
c
\change_unchanged
ases 5 and 6, estimates are made with specification of anisotropy in the
 prior covariance.
 Inspection of the true parameter field in 
\change_deleted -1837876828 1342457083
F
\change_inserted -1837876828 1342457083
f
\change_unchanged
igure 
\begin_inset CommandInset ref
LatexCommand ref
reference "3Ltruek"

\end_inset

 suggests a possible correlation along the horizontal axis, indicative of
 a channel feature.
 In 
\change_deleted -1837876828 1342457088
C
\change_inserted -1837876828 1342457088
c
\change_unchanged
ases 5 and 6, therefore, an arbitrarily chosen ratio of 100 is applied with
 a rotation angle of zero.
 In 
\change_deleted -1837876828 1342457095
C
\change_inserted -1837876828 1342457095
c
\change_unchanged
ase 5, like in 
\change_deleted -1837876828 1342457098
C
\change_inserted -1837876828 1342457098
c
\change_unchanged
ase 3, 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 is estimated to achieve the best possible fit, 
\change_deleted -1837876828 1342457102
while
\change_inserted -1837876828 1342457103
whereas
\change_unchanged
 in 
\change_deleted -1837876828 1342457105
C
\change_inserted -1837876828 1342457109
c
\change_unchanged
ase 6, 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 is held constant at 
\begin_inset Formula $1.0\times10^{-1}.$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
placement !t
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../tables/3_layer_tables_for_structural_parameters.pdf
	scale 90

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:3lay"

\end_inset

Summary of the five cases investigated.
 The table shows which structural parameters were estimated and fixed
\change_deleted -1837876828 1342457121
,
\change_unchanged
 and also indicates anisotropy when used.
 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figures 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:3LK_case1"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:3Lresid_case1"

\end_inset

 show the estimated hydraulic conductivity field and squared differences
 between measured and observed head values, respectively, for 
\change_deleted -1837876828 1342457131
C
\change_inserted -1837876828 1342457131
c
\change_unchanged
ase 1.
 In this case, meant to be conservative with respect to overfitting, the
 squared differences are smaller in magnitude than the specified value of
 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 
\begin_inset Formula $\left(1.0\times10^{-1}\right)$
\end_inset


\change_inserted -1837876828 1342457142
,
\change_unchanged
 and very little roughness in the solution is required to achieve the level
 of fit desired.
\end_layout

\begin_layout Standard
\begin_inset Newpage clearpage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/3KL_case1.pdf

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:3LK_case1"

\end_inset

Case 1: Hydraulic conductivity fields estimated 
\change_inserted -1837876828 1342457153
by 
\change_unchanged
using bgaPEST compared to the true, synthetic hydraulic conductivity field.
 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 is held constant at 
\begin_inset Formula $1.00\times10^{-01}$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/3L_resid_case1.pdf
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:3Lresid_case1"

\end_inset

Case 1: Squared differences between modeled and 
\begin_inset Quotes eld
\end_inset

true
\begin_inset Quotes erd
\end_inset

 head values.
 Symbol size qualitatively indicates magnitude
\change_inserted -1837876828 1342457166
,
\change_unchanged
 
\change_deleted -1837876828 1342457170
while
\change_inserted -1837876828 1342457171
and
\change_unchanged
 color scale quantifies magnitude.
 Locations of the circles indicate observation location in the model domain
 in plan view.
 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 is held constant at 
\begin_inset Formula $1.00\times10^{-01}$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figures 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:3LK_case2"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:3Lresid_case2"

\end_inset

 show the estimated hydraulic conductivity field and squared differences
 between measured and observed head values, respectively, for 
\change_deleted -1837876828 1342457185
C
\change_inserted -1837876828 1342457185
c
\change_unchanged
ase 2.
 In this case, the specified value of 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 
\begin_inset Formula $\left(1.0\times10^{-2}\right)$
\end_inset

 is lower 
\change_inserted -1837876828 1342701513
than in case 1 
\change_unchanged
and
\change_deleted -1837876828 1342457189
 
\change_unchanged
, accordingly, the squared head differences are lower, and more structure
 (roughness) is observed in the parameters, as expected.
 Note that
\change_deleted -1837876828 1342457221
,
\change_unchanged
 in this case, even with very low residuals, the parameter fields estimated
 are a smoothed representation of the 
\begin_inset Quotes eld
\end_inset

truth.
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/3KL_case2.pdf

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:3LK_case2"

\end_inset

Case 2: Hydraulic conductivity fields estimated 
\change_inserted -1837876828 1342457229
by 
\change_unchanged
using bgaPEST compared to the true, synthetic hydraulic conductivity field.
 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 is held constant at 
\begin_inset Formula $1.00\times10^{-02}$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/3L_resid_case2.pdf
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:3Lresid_case2"

\end_inset

Case 2: Squared differences between modeled and 
\begin_inset Quotes eld
\end_inset

true
\begin_inset Quotes erd
\end_inset

 head values.
 Symbol size qualitatively indicates magnitude
\change_inserted -1837876828 1342457242
,
\change_unchanged
 
\change_deleted -1837876828 1342457244
while
\change_inserted -1837876828 1342457244
and
\change_unchanged
 color scale quantifies magnitude.
 Locations of the circles indicate observation location in the model domain
 in plan view.
 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 is held constant at 
\begin_inset Formula $1.00\times10^{-02}$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figures 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:3LK_case3"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:3Lresid_case3"

\end_inset

 show the estimated hydraulic conductivity field and squared differences
 between measured and observed head values, respectively, for 
\change_deleted -1837876828 1342457256
C
\change_inserted -1837876828 1342457256
c
\change_unchanged
ase 3.
 In this case, the value of 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 is estimated by the restricted maximum likelihood value algorithm.
 The head values match perfectly to machine precision, and the roughness
 of the field is the greatest of 
\change_deleted -1837876828 1342457265
C
\change_inserted -1837876828 1342457265
c
\change_unchanged
ases 1 through 3, as expected.
 The major features of the 
\begin_inset Quotes eld
\end_inset

true
\begin_inset Quotes erd
\end_inset

 hydraulic conductivity field are reproduced by this solution although they
 are smoothed, somewhat, as expected.
 Importantly, 
\change_deleted -1837876828 1342457275
while
\change_inserted -1837876828 1342457276
although
\change_unchanged
 the highest hydraulic conductivity values in layer 2 are slightly offset
 to the west, no artifacts are introduced that would be considered spurious
 in this solution.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/3KL_case3.pdf

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:3LK_case3"

\end_inset

Case 3: Hydraulic conductivity fields estimated 
\change_inserted -1837876828 1342457284
by 
\change_unchanged
using bgaPEST compared to the true, synthetic hydraulic conductivity field.
 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 is initially 
\begin_inset Formula $1.00\times10^{-05}$
\end_inset

 and estimated by bgaPEST at an optimal value of 
\begin_inset Formula $7.79\times10^{-08}$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/3L_resid_case3.pdf
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:3Lresid_case3"

\end_inset

Case 3: Squared differences between modeled and 
\begin_inset Quotes eld
\end_inset

true
\begin_inset Quotes erd
\end_inset

 head values.
 Symbol size qualitatively indicates magnitude
\change_inserted -1837876828 1342457295
,
\change_unchanged
 
\change_deleted -1837876828 1342457297
while
\change_inserted -1837876828 1342457297
and
\change_unchanged
 color scale quantifies magnitude.
 Locations of the circles indicate observation location in the model domain
 in plan view.
 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 is initially 
\begin_inset Formula $1.00\times10^{-05}$
\end_inset

 and estimated by bgaPEST at an optimal value of 
\begin_inset Formula $7.79\times10^{-08}$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figures 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:3LK_case5"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:3Lresid_case5"

\end_inset

 show the estimated hydraulic conductivity field and squared differences
 between measured and observed head values, respectively, for 
\change_deleted -1837876828 1342457318
C
\change_inserted -1837876828 1342457318
c
\change_unchanged
ase 5.
 In this case, the value of 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 is set 
\change_deleted -1837876828 1342701544
at a 
\change_unchanged
very low 
\change_deleted -1837876828 1342701546
value
\change_unchanged
 
\begin_inset Formula $\left(1.0\times10^{-4}\right)$
\end_inset

 to attempt to achieve excellent fit while introducing anisotropy with the
 principal direction aligned with the horizontal axis.
 In layer 1, a somewhat spurious artifact is 
\change_deleted -1837876828 1342701676
found
\change_inserted -1837876828 1342701676
visible
\change_unchanged
 in the form of a high hydraulic conductivity zone near the middle of the
 field.
 The head targets almost match within machine precision, however, and all
 other features are reasonable.
 This highlights the fact that, within a single beta association, if anisotropy
 is used, 
\emph on
all 
\emph default
features estimated will roughly correspond to that framework
\change_inserted -1837876828 1342457341
;
\change_unchanged
 so, in a Bayesian sense, the answer is 
\emph on
conditional 
\emph default
on the prior assumption that the anisotropy is an appropriate general characteri
stic shape of the parameter field.
 Such assumptions must be made cautiously.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/3KL_case5.pdf

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:3LK_case5"

\end_inset

Case 5: Hydraulic conductivity fields estimated 
\change_inserted -1837876828 1342457355
by 
\change_unchanged
using bgaPEST compared to the true, synthetic hydraulic conductivity field.
 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 is initially 
\begin_inset Formula $1.00\times10^{-04}$
\end_inset

 and estimated by bgaPEST at an optimal value of 
\begin_inset Formula $1.18\times10^{-05}$
\end_inset

.
 Parameter anisotropy also invoked as described in 
\change_deleted -1837876828 1342457367
T
\change_inserted -1837876828 1342457367
t
\change_unchanged
able 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:3lay"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/3L_resid_case5.pdf
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:3Lresid_case5"

\end_inset

Case 5: Squared differences between modeled and 
\begin_inset Quotes eld
\end_inset

true
\begin_inset Quotes erd
\end_inset

 head values.
 Symbol size qualitatively indicates magnitude
\change_inserted -1837876828 1342457375
,
\change_unchanged
 
\change_deleted -1837876828 1342457377
while
\change_inserted -1837876828 1342457377
and
\change_unchanged
 color scale quantifies magnitude.
 Locations of the circles indicate observation location in the model domain
 in plan view.
 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 is initially 
\begin_inset Formula $1.00\times10^{-04}$
\end_inset

 and estimated by bgaPEST at an optimal value of 
\begin_inset Formula $1.18\times10^{-05}$
\end_inset

.
 Parameter anisotropy also invoked as described in 
\change_deleted -1837876828 1342457390
T
\change_inserted -1837876828 1342457390
t
\change_unchanged
able 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:3lay"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figures 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:3LK_case6"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:3Lresid_case6"

\end_inset

 show the estimated hydraulic conductivity field and squared differences
 between measured and observed head values, respectively, for 
\change_deleted -1837876828 1342457397
C
\change_inserted -1837876828 1342457397
c
\change_unchanged
ase 6.
 In this case, the value of 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 is set at a the same value as 
\change_inserted -1837876828 1342701706
in 
\change_deleted -1837876828 1342457401
C
\change_inserted -1837876828 1342457401
c
\change_unchanged
ase 1 
\begin_inset Formula $\left(1.0\times10^{-1}\right)$
\end_inset

 to compare a solution with and without anisotropy assumed.
 
\change_deleted -1837876828 1342457409
Since
\change_inserted -1837876828 1342457410
Because
\change_unchanged
 anisotropy is a reasonable characteristic of the 
\begin_inset Quotes eld
\end_inset

true
\begin_inset Quotes erd
\end_inset

 field in this case, better fits are achieved (nearly an order of magnitude
 lower residuals)
\change_inserted -1837876828 1342701714
,
\change_unchanged
 and the general pattern of the parameter field is better in 
\change_deleted -1837876828 1342457426
C
\change_inserted -1837876828 1342457426
c
\change_unchanged
ase 6 
\change_deleted -1837876828 1342457437
using
\change_inserted -1837876828 1342457437
with
\change_unchanged
 anisotropy than in 
\change_deleted -1837876828 1342457429
C
\change_inserted -1837876828 1342457429
c
\change_unchanged
ase 1 without anisotropy.
 This highlights the power that anisotropy can bring to a parameter estimation
 problem when it is appropriate
\change_inserted -1837876828 1342457445
,
\change_unchanged
 even when 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 is set conservatively to avoid overfitting.
 As discussed above, however, 
\change_deleted -1837876828 1342701726
this
\change_inserted -1837876828 1342701728
anisotropy
\change_unchanged
 will, in a sense, force the solution to conform to such a shape, so it
\change_deleted -1837876828 1342457459
'
\change_unchanged
s use should be approached with caution.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/3KL_case6.pdf

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:3LK_case6"

\end_inset

Case 6: Hydraulic conductivity fields estimated 
\change_inserted -1837876828 1342457490
by 
\change_unchanged
using bgaPEST compared to the true, synthetic hydraulic conductivity field.
 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 is held constant at 
\begin_inset Formula $1.00\times10^{-01}$
\end_inset

.
 Parameter anisotropy also invoked as described in 
\change_deleted -1837876828 1342457497
T
\change_inserted -1837876828 1342457497
t
\change_unchanged
able 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:3lay"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ../../figures/3L_resid_case6.pdf
	scale 50

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:3Lresid_case6"

\end_inset

Case 6: Squared differences between modeled and 
\begin_inset Quotes eld
\end_inset

true
\begin_inset Quotes erd
\end_inset

 head values.
 Symbol size qualitatively indicates magnitude
\change_inserted -1837876828 1342457503
,
\change_unchanged
 
\change_deleted -1837876828 1342457505
while
\change_inserted -1837876828 1342457505
and
\change_unchanged
 color scale quantifies magnitude.
 Locations of the circles indicate observation location in the model domain
 in plan view.
 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 is held constant at 
\begin_inset Formula $1.00\times10^{-01}$
\end_inset

.
 Parameter anisotropy also invoked as described in 
\change_deleted -1837876828 1342457511
T
\change_inserted -1837876828 1342457511
t
\change_unchanged
able 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:3lay"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
subsection{References Cited}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Section
Appendix 
\begin_inset CommandInset label
LatexCommand label
name "sec:example3"

\end_inset

Reverse Flood Routing Example Application
\end_layout

\begin_layout Standard
An example application of reverse flood routing in open channels is presented
 in this section 
\begin_inset CommandInset citation
LatexCommand citep
key "doriareverserouting"

\end_inset

.
 Reverse flood routing is useful to obtain hydrographs 
\change_deleted -1837876828 1342204907
in
\change_inserted -1837876828 1342204907
at
\change_unchanged
 upstream unga
\change_deleted -1837876828 1342204913
u
\change_unchanged
ged stations by means of information available at downstream 
\change_deleted -1837876828 1342701773
monitored
\change_inserted -1837876828 1342701774
gaged
\change_unchanged
 sites.
 The considered channel was prismatic and 20
\begin_inset space ~
\end_inset

k
\change_inserted -1837876828 1342701848
ilo
\change_unchanged
m
\change_inserted -1837876828 1342701852
eters
\change_unchanged
 long; the cross sections (spaced by 100
\begin_inset space ~
\end_inset

m
\change_inserted -1837876828 1342701870
eters (m)
\change_unchanged
) were trapezoidal in shape with bottom width of 10
\begin_inset space ~
\end_inset

m and side slope of 2/1.
 A longitudinal channel slope of 0.001 and a Manning coefficient of 0.033
\begin_inset space ~
\end_inset

m
\begin_inset script superscript

\begin_layout Plain Layout
-1/3
\end_layout

\end_inset

s 
\change_inserted -1837876828 1342701995

\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342701998
Note 20
\change_unchanged

\end_layout

\end_inset


\change_unchanged
were adopted.
 The upstream and downstream boundary conditions were a 
\change_deleted -1837876828 1342204991
discharge
\change_inserted -1837876828 1342205015
streamflow
\begin_inset Note Note
status open

\begin_layout Plain Layout

\change_inserted -1837876828 1342702002
Note 21
\change_unchanged

\end_layout

\end_inset


\change_unchanged
 time series and the uniform flow condition, respectively.
 The initial condition was set consistent with the steady
\change_deleted -1837876828 1342205093
-
\change_inserted -1837876828 1342205093
 
\change_unchanged
state of a constant flow rate equal to the first value of the upstream hydrograp
h.
 The BASEChain module of BASEMENT 
\begin_inset CommandInset citation
LatexCommand citep
key "Basement"

\end_inset

 that solves the De Saint Venant equations for unsteady one
\change_inserted -1837876828 1342205113
-
\change_deleted -1837876828 1342205112
 
\change_unchanged
dimensional flow was adopted as forward model.
 A flood wave with time to peak of 2.5 hours, peak 
\change_deleted -1837876828 1342205119
discharge
\change_inserted -1837876828 1342205120
flow
\change_unchanged
 of 164
\begin_inset space ~
\end_inset


\change_inserted -1837876828 1342702178
cubic meters per second (
\change_unchanged
m
\begin_inset script superscript

\begin_layout Plain Layout
3
\end_layout

\end_inset

/s
\change_inserted -1837876828 1342702182
),
\change_unchanged
 and base flow of 25
\begin_inset space ~
\end_inset

m
\begin_inset script superscript

\begin_layout Plain Layout
3
\end_layout

\end_inset

/s was considered to obtain the corresponding downstream outflow subsequently
 corrupted with multiplicative random errors and used in the inverse procedure.
 The simulation time was equal to 15 hours; the input and output hydrograph
 time discretization was constant and equal to 5 minutes
\change_inserted -1837876828 1342205140
,
\change_unchanged
 resulting in 181 values.
 The initial flow condition and the downstream discharge time series (181
 observations) were then used to estimate the inflow hydrograph (181 parameters).
 The initial parameter values were set to the mean value of the observations.
 The sensitivity (Jacobian) matrix was evaluated by means of a finite
\change_inserted -1837876828 1342702240
-
\change_deleted -1837876828 1342702239
 
\change_unchanged
difference calculations using the 
\change_deleted -1837876828 1342205154
p
\change_inserted -1837876828 1342205154
P
\change_unchanged
ython linkage and PEST, as capable in the released version of bgaPEST.
 The epistemic error term 
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 and the linear variogram slope parameter 
\begin_inset Formula $\theta$
\end_inset

 were estimated by the restricted maximum likelihood value algorithm.
\end_layout

\begin_layout Standard
In 
\change_deleted -1837876828 1342205167
F
\change_inserted -1837876828 1342205167
f
\change_unchanged
igure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Reverse-routing"

\end_inset

 the actual input hydrograph, the actual downstream hydrograph, assessed
 by applying the forward model, and the error corrupted one used for the
 inversion are reported along with the reproduced inflow and the corresponding
 outflow.
 Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Reverse-routing"

\end_inset

 summarizes the estimated structural parameters.
 In the first case
\change_inserted -1837876828 1342205212
,
\change_unchanged
 the downstream hydrograph was corrupted with a 1
\change_deleted -1837876828 1342457870
%
\change_inserted -1837876828 1342457870
-percent
\change_unchanged
 multiplicative random error (
\change_deleted -1837876828 1342205219
F
\change_inserted -1837876828 1342205219
f
\change_unchanged
ig
\change_deleted -1837876828 1342205231
ure
\change_inserted -1837876828 1342205232
.

\change_unchanged
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Reverse-routing"

\end_inset

a), in the second case a 10
\change_deleted -1837876828 1342457871
%
\change_inserted -1837876828 1342457871
-percent
\change_unchanged
 multiplicative random error was used (
\change_deleted -1837876828 1342205226
F
\change_inserted -1837876828 1342205226
f
\change_unchanged
ig
\change_deleted -1837876828 1342205235
ure
\change_inserted -1837876828 1342205235
.

\change_unchanged
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Reverse-routing"

\end_inset

b).
 In both the inversions, there is a 
\change_deleted -1837876828 1342205243
good
\change_inserted -1837876828 1342205244
close
\change_unchanged
 match between the estimated input hydrograph and the actual one; the peak
 
\change_deleted -1837876828 1342205250
discharge
\change_inserted -1837876828 1342205251
flow
\change_unchanged
 and time are properly reproduced.
 The estimated epistemic error variance increases in the second case
\change_inserted -1837876828 1342205257
,
\change_unchanged
 taking account of the higher erroneous observations (
\change_deleted -1837876828 1342205262
T
\change_inserted -1837876828 1342205262
t
\change_unchanged
able 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Reverse-routing"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement !t
wide true
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename ../../figures/Reverse_Routing.pdf
	scale 90

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Reverse-routing"

\end_inset

Reverse routing: inflow and outflow hydrographs for the prismatic channel
\change_inserted -1837876828 1342457724
:
\change_deleted -1837876828 1342457723
.

\change_unchanged
 (a) the observations were corrupted with a 1
\change_deleted -1837876828 1342457883
%
\change_inserted -1837876828 1342457883
-percent
\change_unchanged
 random error; (b) a 10
\change_deleted -1837876828 1342457884
%
\change_inserted -1837876828 1342457884
-percent
\change_unchanged
 random error was used
\change_deleted -1837876828 1342699224
.
 
\change_unchanged

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
placement !t
wide false
sideways false
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Random errors 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1% 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10%
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\theta$
\end_inset

 [m
\begin_inset script superscript

\begin_layout Plain Layout
6
\end_layout

\end_inset

s
\begin_inset script superscript

\begin_layout Plain Layout
-3
\end_layout

\end_inset

] 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2.0\times10^{-2}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.0\times10^{-2}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\sigma_{R}^{2}$
\end_inset

 [m
\begin_inset script superscript

\begin_layout Plain Layout
6
\end_layout

\end_inset

s
\begin_inset script superscript

\begin_layout Plain Layout
-2
\end_layout

\end_inset

] 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.7\times10^{-1}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $9.3$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:Reverse-routing"

\end_inset

Reverse routing: estimated structural parameters 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
References Cited
\end_layout

\end_body
\end_document
